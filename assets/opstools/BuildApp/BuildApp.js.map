{"version":3,"sources":["webpack:///webpack/bootstrap 3ca9b3e6291f49084164","webpack:///./assets/opstools/AppBuilder/OP/OP.js","webpack:///./assets/opstools/AppBuilder/classes/ABApplication.js","webpack:///./assets/opstools/AppBuilder/classes/dataFields/ABField.js","webpack:///./assets/opstools/AppBuilder/classes/dataFields/ABFieldComponent.js","webpack:///./assets/opstools/AppBuilder/OP/comm/comm.js","webpack:///./assets/opstools/AppBuilder/OP/config/config.js","webpack:///./assets/opstools/AppBuilder/OP/model.js","webpack:///./assets/opstools/AppBuilder/OP/multilingual.js","webpack:///./assets/opstools/AppBuilder/OP/util.js","webpack:///./assets/opstools/AppBuilder/OP/validation.js","webpack:///./assets/opstools/AppBuilder/OP/comm/comm_service.js","webpack:///./assets/opstools/AppBuilder/OP/config/configDesktop.js","webpack:///./assets/opstools/AppBuilder/OP/config/configMobile.js","webpack:///./assets/opstools/AppBuilder/classes/ABFieldManager.js","webpack:///./assets/opstools/AppBuilder/components/ab.js","webpack:///./assets/opstools/AppBuilder/AppBuilder.js","webpack:///./assets/opstools/AppBuilder/classes/ABModel.js","webpack:///./assets/opstools/AppBuilder/classes/ABObject.js","webpack:///./assets/opstools/AppBuilder/classes/dataFields/ABFieldBoolean.js","webpack:///./assets/opstools/AppBuilder/classes/dataFields/ABFieldDate.js","webpack:///./assets/opstools/AppBuilder/classes/dataFields/ABFieldImage.js","webpack:///./assets/opstools/AppBuilder/classes/dataFields/ABFieldNumber.js","webpack:///./assets/opstools/AppBuilder/classes/dataFields/ABFieldString.js","webpack:///./assets/opstools/AppBuilder/components/ab_choose.js","webpack:///./assets/opstools/AppBuilder/components/ab_choose_form.js","webpack:///./assets/opstools/AppBuilder/components/ab_choose_list.js","webpack:///./assets/opstools/AppBuilder/components/ab_choose_list_menu.js","webpack:///./assets/opstools/AppBuilder/components/ab_work.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_interface.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_list.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_list_newObject.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_list_newObject_blank.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_list_popupEditMenu.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_workspace.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_workspace_datatable.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupDefineLabel.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupFrozenColumns.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupHeaderEditMenu.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupHideFields.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupNewDataField.js","webpack:///./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupSortFields.js","webpack:///./assets/opstools/AppBuilder/data/ABApplication.js","webpack:///./assets/opstools/AppBuilder/webix_custom_components/editlist.js","webpack:///./assets/opstools/AppBuilder/webix_custom_components/edittree.js","webpack:///./~/css-loader/lib/css-base.js","webpack:///./~/style-loader/fixUrls.js","webpack:///./assets/opstools/AppBuilder/AppBuilder.css","webpack:///./~/style-loader/addStyles.js","webpack:///./assets/opstools/AppBuilder/AppBuilder.css?8d71"],"names":["window","OP","Comm","Component","CustomComponent","extend","key","fn","App","_newApp","component","actions","a","uuid","webix","uid","config","custom","labels","unique","Dialog","AD","op","Error","error","Multilingual","Model","Util","Validation","_AllApplications","L","altText","lang","label","getLabel","toDC","data","DataCollection","toArray","DC","ary","id","getFirstId","element","getItem","push","getNextId","ABApplication","attributes","json","name","role","translate","fieldsMultilingual","newObjects","objects","forEach","obj","_objects","get","Models","destroy","then","remove","values","toObj","update","updateItem","create","add","unTranslate","currObjects","permItems","Promise","resolve","reject","comm","service","put","url","roles","fail","done","post","delete","filter","object","remaininObjects","o","save","isIncluded","length","ModelApplication","findAll","catch","newApp","app","validator","arrayApplications","nameMatch","trim","replace","toLowerCase","matchingApps","addError","ABField","fieldDefaults","defaults","fromValues","icon","menuName","description","isNameUnique","fields","f","isDifferent","columnName","migrateDrop","fieldRemove","isAdd","fieldSave","migrateCreate","err","settings","translations","fieldKey","fieldIcon","showIcon","parseInt","application","Service","isObjectWorkspace","header","row","node","console","ids","defaultValues","$$","setValue","field","_logic","Field","onChange","newVal","oldVal","getValue","labelOnChange","_ui","rows","view","dataFieldHeaderLabel","placeholder","dataFieldHeaderLabelPlaceholder","labelWidth","labelWidthMedium","css","on","dataFieldColumnName","dataFieldColumnNamePlaceholder","fieldDescription","align","labelRight","dataFieldShowIcon","labelWidthCheckbox","value","ABFieldComponent","options","elements","rules","logic","init","idBase","eachDeep","e","i","autoheight","borderless","isNotEmpty","_init","clear","clearEditor","warn","clearValidation","hide","isValid","validate","populate","editorPopulate","show","b","getValues","editorValues","l","commonUI","definitionEditor","concat","r","_component","ui","list","cols","innerWidth","_restURLs","findOne","_Models","OPModel","staticData","instanceData","cond","verb","params","Array","isArray","newList","dc","onAfterDelete","nURI","k","oURI","util","string","replaceAll","item","attr","parts","split","uri","pop","instance","restURL","u","curr","nameSpace","modelName","objectName","findObject","baseObj","nameList","whoops","objName","controlName","currLanguage","currentLanguage","t","language_code","foundOne","trans","OPValidator","errors","message","invalidAttributes","form","vObj","toValidationObject","isFormValidationError","rowID","grid","isGridValidationError","hasFocused","raw","code","attrs","wasForm","msg","markInvalid","join","focus","Grid","wasGrid","addCellCss","Alert","text","refresh","services","cb","appListRowHeight","buttonWidthLarge","buttonWidthMedium","buttonWidthSmall","buttonWidthExtraSmall","tabWidthLarge","tabWidthMedium","tabWidthSmall","tabWidthExtraSmall","smallSpacer","mediumSpacer","largeSpacer","xLargeSpacer","xxLargeSpacer","xxxLargeSpacer","appListSpacerRowHeight","appListSpacerColMinWidth","appListSpacerColMaxWidth","objectWorkspaceColWidth","labelWidthSmall","labelWidthLarge","labelWidthXLarge","hideMobile","Fields","allFields","newField","edit","formName","rename","ok","cancel","yes","no","createErrorMessage","createSuccessMessage","updateErrorMessage","updateSucessMessage","deleteErrorMessage","deleteSuccessMessage","renameErrorMessage","renameSuccessMessage","AppChooser","AppWorkspace","animate","transitionApplicationChooser","adjust","_actions","Control","OpsTool","self","templateDOM","resize_notification","tool","_super","webixUiId","loadingScreen","syncButton","initDOM","initWebixUI","_this","can","fragment","html","AppBuilder","container","resize","height","appListDom","$","width","parent","computedHeight","log","mh","ABModel","_where","_skip","_limit","newCond","where","modelURL","mlFields","multilingualFields","d","DT","define","attachEvent","start","count","limit","skip","parse","modelURLUpdate","ABObject","labelFormat","isImported","urlPath","importFromObject","objectWorkspace","sortFields","frozenColumnID","hiddenFields","newFields","fieldNew","_fields","fieldDrops","all","objectDestroy","objectSave","currFields","found","isMultilingual","headers","columnNameLookup","columnHeader","h","workspaceHiddenFields","hfID","hidden","DataTable","indexOf","getItemNode","column","customDisplay","p","isValidData","ABFieldBooleanDefaults","default","ABFieldBooleanComponent","labelPosition","ABFieldBoolean","dv","editor","template","ABFieldDateDefaults","includeTime","defaultCurrentDate","defaultDate","dayFormat","dayOrder","dayDelimiter","monthFormat","monthOrder","monthDelimiter","yearFormat","yearOrder","yearDelimiter","validateCondition","validateRangeUnit","validateRangeBefore","validateRangeAfter","validateStartDate","validateEndDate","currentToDefault","dateDisplay","validateRange","validateRangeBeforeLabel","validateRangeAfterLabel","validateLeft","validateRight","delimiterList","sign","getDelimiterSign","delimiterItem","getDateFormat","setting","momentFormat","moment","Date","format","refreshDateDisplay","dateFormat","ABFieldDateComponent","idsUnique","timepicker","disabled","disable","enable","multi","collapsed","body","newValue","oldValue","vertical","beforeLabel","afterLabel","ABFieldDate","sort","dateToStr","editFormat","Object","prototype","toString","call","isFinite","toISOString","ABFieldImageDefaults","ABFieldImageComponent","imageWidth","imageHeight","click","ABFieldImage","useWidth","useHeight","removeExistingData","Confirm","title","callback","result","imgDiv","imageTemplate","idCustomContainer","uploader","image","parentContainer","querySelector","innerHTML","imgHeight","imgWidth","webixContainer","ProgressBar","actionKey","apiOnly","upload","inputName","multiple","onBeforeFileAdd","classList","acceptableTypes","type","showProgress","delay","onFileUpload","response","hideProgress","showImage","model","onFileUploadError","addDropZone","$view","iconDisplay","imageDisplay","imageURL","document","getElementById","style","display","backgroundImage","ABFieldNumberDefaults","formatList","position","ABFieldNumberComponent","typeDecimalPlaces","typeRounding","validateMinimum","validateMaximum","RegExp","test","validation","ABFieldNumber","allowRequired","isNumeric","n","Number","isNaN","parseFloat","typeDecimals","places","toFixed","editors","number","ABFieldStringDefaults","ABFieldStringComponent","ABFieldString","textDefault","supportMultilingual","AppList","AppForm","cells","formHeader","placeholderName","placeholderDescription","formDescription","sectionPermission","permissionHeader","createNewRole","invalidName","duplicateName","common","appFormPermissionList","appFormCreateRoleButton","saveButton","responsive","maxWidth","minWidth","responsiveCell","maxHeight","fillspace","margin","required","permissionRenameRole","labelAlign","autowidth","offIcon","onIcon","onItemClick","createRoleButtonClick","markCheckbox","permissionClick","buttonSaveClick","FormFields","applicationCreate","async","waterfall","createdApp","permissionSave","formReady","buttonSaveEnable","transitionApplicationList","applicationUpdate","Application","formValues","next","app_role","buttonSaveDisable","formBusy","updateApp","getSelectedApplication","formValidate","formReset","appName","permissionAddNew","permissionRemoveNew","formPopulate","Form","updateForm","permissionName","isApplicationRole","selectedIds","getSelectedId","select","List","isSelected","unselect","permissionPopulate","PermForm","parsedRoles","map","available_roles","getPermissions","selected_role_ids","clearAll","markCreateButton","appRoles","find","perm","editRole","editItem","saveRoleTasks","appRole","selectedPerms","getSelectedItem","createPermission","deletePermission","appRoleItem","assignPermissions","series","results","transitionApplicationForm","unselectApplication","createNew","noApplication","toolBar","buttonCreateNewApplication","MenuComponent","PopupMenu","import","autosend","onAfterFileAdd","details","templateListItem","iconGear","onClick","ev","trg","onClickListItem","onClickListEdit","_data","busy","loadData","allApplications","ready","index","refreshOverlay","listApplications","refreshList","selectedApp","transitionWorkspace","errorMessage","appList","showOverlay","hideOverlay","reset","unselectAll","unsync","sync","_templateListItem","OverlayBox","deleteApplication","menu","confirmDeleteTitle","confirmDeleteMessage","head","command","export","datatype","timestamp","textContent","ConfirmDelete","location","assign","backToApplication","synchronize","objectTitle","interfaceTitle","buttonSync","labelAppName","tabbar","tab_object","tab_interface","workspace","AppObjectWorkspace","AppInterfaceWorkspace","alrign","multiview","idNew","idOld","tabSwitch","applicationInit","idTab","applicationLoad","ObjectList","ObjectWorkspace","clearObjectWorkspace","addNew","buttonNew","editlist","editaction","editable","editValue","onAfterRender","onAfterSelect","selectObject","onBeforeEditStop","state","onAfterEditStop","ignoreUpdate","clickEditMenu","clickNewObject","PopupNewObjectComponent","onDone","callbackNewObject","PopupEditObjectComponent","callbackObjectEditorMenu","listBusy","CurrentApplication","objectList","listReady","showGear","old","selectedObject","populateObjectWorkspace","gearIcon","visibility","objectId","isOK","action","getSelectedObject","BlankTab","modal","selectNewObject","c","callbacks","ourCBs","onCancel","onSave","currentApplication","newObject","objectNew","addNewObject","buttonSave","buttonCancel","formClear","itemNode","addNewRow","hideFields","filterFields","frozenColumns","defineLabel","permission","addFields","buttonAddField","buttonExport","buttonFieldsVisible","buttonFilter","buttonFrozen","buttonLabel","buttonRowNew","buttonSort","datatable","toolbar","noSelection","PopupDefineLabelComponent","PopupDefineLabel","PopupFrozenColumnsComponent","PopupFrozenColumns","PopupHideFieldComponent","PopupHideField","PopupNewDataFieldComponent","PopupSortFieldComponent","PopupSortField","badge","toolbarFieldsVisible","toolbarFilter","toolbarSort","toolbarFrozen","toolbarDefineLabel","toolbarPermission","toolbarAddFields","toolbarButtonExport","rowAdd","onEditorMenu","callbackHeaderEditorMenu","callbackDefineLabel","callbackFrozenColumns","callbackFieldsVisible","callbackAddFields","fieldList","getFieldList","callbackSortFields","CurrentObject","frozenID","workspaceFrozenColumnID","badgeNumber","getColumnIndex","workspaceSortFields","sortTable","populateObjectPopupAddDataField","objectLoad","resizeColumn","resizeRow","prerender","fixedRowHeight","dragColumn","onBeforeSelect","preserve","prevent","onCheck","col","val","onAfterLoad","onColumnResize","newWidth","oldWidth","user_action","onBeforeColumnDrag","sourceId","event","onBeforeColumnDrop","targetId","onAfterColumnDrop","onAfterColumnShow","onAfterColumnHide","onHeaderClick","throttleOnAfterRender","clearTimeout","setTimeout","customDisplays","EditField","EditNode","callbackHeaderEdit","PopupHeaderEdit","removeCellCss","pass","patch","clearSelection","updateGrid","editCell","PopupHeaderEditComponent","columnHeaders","refreshColumns","loadInto","dir","aValue","bValue","sortNext","sorts","by","columnOrders","selectFieldToGenerate","labelFields","onShow","_currentObject","ButtonSave","each","listFields","selectedItem","Format","clickClearAll","clickListItem","iconsReset","recordClicked","iconDefault","iconFreeze","isFrozen","record","$css","hideField","filterField","sortField","editField","deleteField","menuItems","listItems","showAll","hideAll","errorFrozen","clickShowAll","clickHideAll","newHidden","isHidden","fID","iconShow","iconHide","iconFreezeOff","iconFreezeOn","fieldType","addNewField","types","editDefinitions","onBeforeShow","resetState","onHide","_objectHash","_componentHash","_componentsByType","_currentEditor","defaultEditorComponent","defaultEditorID","submenus","_editField","newEditorList","F","editorComponent","propertiesComponent","oldData","modeAdd","modeEdit","blur","typeClick","subMenuId","submenu","getSubMenu","addNewSort","selectField","textAsc","textDesc","dateAsc","dateDesc","numberAsc","numberDesc","booleanAsc","booleanDesc","clickAddNewSort","as","sort_popup","sort_form","viewIndex","getChildViews","addView","columnId","columnConfig","sortDir","getParentView","sortAs","defaultAs","refreshFieldList","saveSorts","newv","oldv","removeView","fieldsCombo","segmentButton","asField","excludeSelected","childViews","cView","selectedValue","removeIndex","removeItem","grep","splice","s","ignoreRemoveViews","selectedFields","removeChildViews","fieldId","fieldObj","selectedFieldsExcludeCurField","not","enableFields","useSockets","ComponentKey","componentKey","protoUI","EditAbility","tree","module","exports","useSourceMap","content","cssWithMappingToString","modules","mediaQuery","alreadyImportedModules","cssMapping","btoa","sourceMapping","toComment","sourceURLs","sources","source","sourceRoot","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","baseUrl","protocol","host","currentDir","pathname","fixedCss","fullMatch","origUrl","unquotedOrigUrl","$1","newUrl"],"mappings":"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,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA,gCAAgC,sBAAsB;AACtD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD;;AAEA,6BAA6B,mBAAmB;;AAEhD;;AAEA;;AAEA;AACA;AACA;;;;;;;ACjSA;;AAEA;AACA;AACA;AACA;AACA,gDAAoF;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,gCAAgC,UAAU,EAAE;AAC5C,C","file":"BuildApp.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3ca9b3e6291f49084164","\n/**\n * @class AD_Client\n * @parent index 4\n *\n * ###Client side global OpsPortal (OP) namespace.\n *\n * This file defines standard functions and calls for OpsPortal\n * objects on the client side.\n */\n\n// Create our OP  Namespace only if it hasn't been created already\n\n//// TODO: how to disable 'use strict'?  or perform this check without an error\n//// in 'use strict' ?\n\n// if (!window.OP) {\nimport Comm from \"./comm/comm\"\n// import Form from \"./form\"\n// import Grid from \"./grid\"\nimport Multilingual from \"./multilingual\"\nimport Model from \"./model\"\nimport Util  from \"./util\"\nimport Validation from \"./validation\"\n\nimport Config from \"./config/config\"\n\n    window.OP = OP;\n\n\n    // OP.xxxx      These properties hold the defined Class/Controller/Model definitions\n    //              for our loaded projects.\n    // OP.UI = {};    \t\t// webix UI definitions\n    // OP.Logic = {}; \t\t// logic references for webix application\n\n    OP.Comm = Comm;\n\n    OP.Component = {};  // our defined components\n\n    OP.CustomComponent = {};  // separate holder for Webix Custom Components\n\n\n\n\t// OP.UI.extend = function(key, definition) {\n\t// \tOP.UI[key] = definition;\n\t// }\n\n\tOP.Component.extend = function(key, fn) {\n\t\tOP.Component[key] = function(App){\n\n//// TODO: verify App has proper structure:\n\t\t\tif (!App) {\n\t\t\t\tApp = OP.Component._newApp();\n\t\t\t}\n\n\t\t\t// make an instance of the component.\n\t\t\tvar component = fn(App);\n\n\t\t\t// transfer to App, any actions in the component:\n\t\t\tif (component.actions){\n\t\t\t\tfor(var a in component.actions) {\n\t\t\t\t\tApp.actions[a] = component.actions[a];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn component;\n\t\t};\n\t}\n\n\tOP.Component._newApp = function () {\n\t\treturn {\n\n\t\t\tuuid: webix.uid(),\n\n\t\t\t/*\n\t\t\t * actions:\n\t\t\t * a hash of exposed application methods that are shared among our\n\t\t\t * components, so one component can invoke an action that updates\n\t\t\t * another component.\n\t\t\t */\n\t\t\tactions:{\n\n\t\t\t},\n\n\n\t\t\t/*\n\t\t\t * config\n\t\t\t * webix configuration settings for our current browser\n\t\t\t */\n\t\t\tconfig:Config.config(),\n\n\t\t\t/*\n\t\t\t * custom\n\t\t\t * a collection of custom components for this App Instance.\n\t\t\t */\n\t\t\tcustom:{\n\n\t\t\t},\n\n\t\t\t/*\n\t\t\t * labels\n\t\t\t * a collection of labels that are common for the Application.\n\t\t\t */\n\t\t\tlabels:{\n\n\t\t\t},\n\n\t\t\t/*\n\t\t\t * unique()\n\t\t\t * A function that returns a globally unique Key.\n\t\t\t * @param {string} key   The key to modify and return.\n\t\t\t * @return {string}\n\t\t\t */\n\t\t\tunique: function(key) { return key+this.uuid; },\n\n\t\t}\n\t}\n\n\n\tOP.CustomComponent.extend = function(key, fn) {\n\t\tOP.CustomComponent[key] = function(App, key){\n\n\t\t\tif (!App) {\n\t\t\t\tApp = OP.Component._newApp();\n\t\t\t}\n\n\t\t\t// make an instance of the component.\n\t\t\treturn fn(App, key);\n\t\t};\n\t}\n\n\n\tOP.Dialog = AD.op.Dialog;\n\n\tOP.Error = AD.error;\n\n\t// OP.Form = Form;\n\n\t// OP.Grid = Grid;\n\n\tOP.Multilingual = Multilingual;\n\tOP.Model = Model;\n\n\n\tOP.Util = Util;\n\n\tOP.Validation = Validation;\n\t\n\n\texport default OP;\n// }\n\n\n// import \"./model.js\"\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/OP.js","\n// import OP from \"OP\"\nimport \"../data/ABApplication\"\n\nimport ABObject from \"./ABObject\"\n\n\nvar _AllApplications = [];\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\nfunction toDC( data ) {\n\treturn new webix.DataCollection({\n\t\tdata: data,\n\n\t\t// on: {\n\t\t// \tonAfterDelete: function(id) {\n\n\t\t// \t}\n\t\t// }\n\t});\n}\n\nfunction toArray(DC) {\n\tvar ary = [];\n\n\tvar id = DC.getFirstId();\n\twhile(id) {\n\t\tvar element = DC.getItem(id);\n\t\tary.push(element);\n\t\tid = DC.getNextId(id);\n\t}\n\n\treturn ary;\n}\n\nexport default class ABApplication {\n\n    constructor(attributes) {\n\n    \t// ABApplication Attributes\n    \tthis.id    = attributes.id;\n    \tthis.json  = attributes.json;\n    \tthis.name  = attributes.name || this.json.name || \"\";\n    \tthis.role  = attributes.role;\n\n    \t// multilingual fields: label, description\n    \tOP.Multilingual.translate(this, this.json, ABApplication.fieldsMultilingual());\n\n\n\t  \t// import all our ABObjects\n\t  \tvar newObjects = [];\n\t  \t(attributes.json.objects || []).forEach((obj) => {\n\t  \t\tnewObjects.push( new ABObject(obj, this) );\n\t  \t})\n\t  \tthis._objects = newObjects;\n\n\n\t  \t// import all our ABViews\n\n\n\n\t  \t// instance keeps a link to our Model for .save() and .destroy();\n\t  \tthis.Model = OP.Model.get('opstools.BuildApp.ABApplication');\n\t  \tthis.Model.Models(ABApplication);\n  \t}\n\n\n\n  \t///\n  \t/// Static Methods\n  \t///\n  \t/// Available to the Class level object.  These methods are not dependent\n  \t/// on the instance values of the Application.\n  \t///\n\n\n  \t/**\n  \t * @function allApplications\n  \t *\n  \t * return a DataCollection that contains all the ABApplications this user\n  \t * can see (based upon server side permissions);\n  \t *\n  \t * NOTE: this manages the results in the _AllApplications dataCollection\n  \t * store.  Any future .create(), .destroy(), .updates() modify values in\n  \t * that collection.\n  \t *\n  \t * Any webix ui components synced to that collection will be automatically\n  \t * updated.\n  \t *\n  \t * @return {Promise}\n  \t */\n\tstatic allApplications() {\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\tvar ModelApplication = OP.Model.get('opstools.BuildApp.ABApplication');\n\t\t\t\tModelApplication.Models(ABApplication); // set the Models  setting.\n\n\t\t\t\tModelApplication.findAll()\n\t\t\t\t\t.then(function(data){\n\n\t\t\t\t\t\t// NOTE: data is already a DataCollection from .findAll()\n\t\t\t\t\t\t_AllApplications = data;\n\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\n\t\t\t}\n\t\t)\n\t}\n\n\n  \t/**\n  \t * @function create\n  \t *\n  \t * take the initial values and create an instance of ABApplication.\n  \t *\n  \t * @return {Promise}\n  \t */\n\tstatic create(values) {\n\t\treturn new Promise(\n\t\t\tfunction(resolve, reject) {\n\n\t\t\t\tvar newApp = {}\n\t\t\t\tOP.Multilingual.unTranslate(values, newApp, ABApplication.fieldsMultilingual());\n\t\t\t\tvalues.json = newApp;\n\t\t\t\tnewApp.name = values.name;\n\n\t\t\t\tvar ModelApplication = OP.Model.get('opstools.BuildApp.ABApplication');\n\t\t\t\tModelApplication.create(values)\n\t\t\t\t.then(function(app){\n\n\t\t\t\t\t// return an instance of ABApplication\n\t\t\t\t\tvar App = new ABApplication(app);\n\n\t\t\t\t\t_AllApplications.add(App,0);\n\t\t\t\t\tresolve(App);\n\t\t\t\t})\n\t\t\t\t.catch(reject)\n\t\t\t}\n\t\t)\n\t}\n\n\n\t/**\n\t * @method fieldsMultilingual()\n\t *\n\t * return an array of fields that are considered Multilingual labels for\n\t * an ABApplication\n\t *\n\t * @return {array}\n\t */\n\tstatic fieldsMultilingual() {\n\t\treturn ['label', 'description'];\n\t}\n\n\n\n//// TODO: Refactor isValid() to ignore op and not error if duplicateName is own .id\n\n\tstatic isValid(op, values) {\n\n\t\t\tvar validator = OP.Validation.validator();\n\n\t\t\t// during an ADD operation\n\t\t\tif (op == 'add') {\n\n\t\t\t\t// label/name must be unique:\n\t\t\t\tvar arrayApplications = toArray(_AllApplications);\n\n\t\t\t\tvar nameMatch = values.label.trim().replace(/ /g, '_').toLowerCase();\n\t\t\t\tvar matchingApps = arrayApplications.filter(function (app) {\n\t\t\t\t\treturn app.name.trim().toLowerCase() == nameMatch;\n\t\t\t\t})\n\t\t\t\tif (matchingApps && matchingApps.length > 0) {\n\n\t\t\t\t\tvalidator.addError('label', L('ab_form_application_duplicate_name', \"*Name (#name#) is already in use\").replace('#name#', nameMatch) )\n\t\t\t\t\t// var errors = OP.Form.validationError({\n\t\t\t\t\t// \tname:'label',\n\t\t\t\t\t// \tmessage:L('ab_form_application_duplicate_name', \"*Name (#name#) is already in use\").replace('#name#', nameMatch),\n\t\t\t\t\t// }, errors);\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// Check the common validations:\n// TODO:\n// if (!inputValidator.validate(values.label)) {\n// \t_logic.buttonSaveEnable();\n// \treturn false;\n// }\n\n\n\t\t\treturn validator;\n\t}\n\n\n\n\t///\n\t/// Instance Methods\n\t///\n\n\n\t/// ABApplication data methods\n\n\n\t/**\n\t * @method destroy()\n\t *\n\t * destroy the current instance of ABApplication\n\t *\n\t * also remove it from our _AllApplications\n\t *\n\t * @return {Promise}\n\t */\n\tdestroy () {\n\t\tif (this.id) {\n\t\t\treturn this.Model.destroy(this.id)\n\t\t\t\t.then(()=>{\n\t\t\t\t\t_AllApplications.remove(this.id);\n\t\t\t\t});\n\t\t}\n\t}\n\n\n\t/**\n\t * @method save()\n\t *\n\t * persist the current instance of ABApplication to the DB\n\t *\n\t * Also, keep the values in _AllApplications up to date.\n\t *\n\t * @return {Promise}\n\t */\n\tsave () {\n\n\t\tvar values = this.toObj();\n\n\t\t// we already have an .id, so this must be an UPDATE\n\t\tif (values.id) {\n\n\t\t\treturn this.Model.update(values.id, values)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t_AllApplications.updateItem(values.id, this);\n\t\t\t\t\t});\n\n\t\t} else {\n\n\t\t\t// must be a CREATE:\n\t\t\treturn this.Model.create(values)\n\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\tthis.id = data.id;\n\t\t\t\t\t\t_AllApplications.add(this, 0);\n\t\t\t\t\t});\n\t\t}\n\n\t}\n\n\n\t/**\n\t * @method toObj()\n\t *\n\t * properly compile the current state of this ABApplication instance\n\t * into the values needed for saving to the DB.\n\t *\n\t * Most of the instance data is stored in .json field, so be sure to\n\t * update that from all the current values of our child fields.\n\t *\n\t * @return {json}\n\t */\n\ttoObj () {\n\n\t\tOP.Multilingual.unTranslate(this, this.json, ABApplication.fieldsMultilingual());\n\t\tthis.json.name = this.name;\n\n\t\t// for each Object: compile to json\n\t\tvar currObjects = [];\n\t\tthis._objects.forEach((obj) => {\n\t\t\tcurrObjects.push(obj.toObj())\n\t\t})\n\t\tthis.json.objects = currObjects;\n\n\t\treturn {\n\t\t\tid:this.id,\n\t\t\tname:this.name,\n\t\t\tjson:this.json,\n\t\t\trole:this.role\n\t\t}\n\t}\n\n\n\n\t/// ABApplication Permission methods\n\n\n\t/**\n\t * @method assignPermissions()\n\t *\n\t * Make sure the current ABApplication permissions match the given\n\t * array of permissions.\n\t *\n\t * @param {array} permItems\tan array of role assignments that this\n\t * \t\t\t\t\t\t\tABApplication should match.\n\t * @return {Promise}\n\t */\n\tassignPermissions (permItems) {\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tAD.comm.service.put({\n\t\t\t\t\turl: '/app_builder/' + this.id + '/role/assign',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\troles: permItems\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(reject)\n\t\t\t\t.done(resolve);\n\t\t\t}\n\t\t)\n\t}\n\n\n\t/**\n\t * @method getPermissions()\n\t *\n\t * Return an array of role assignments that are currently assigned to this\n\t * ABApplication.\n\t *\n\t * @return {Promise} \tresolve(list) : list {array} Role assignments\n\t */\n\tgetPermissions () {\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\tAD.comm.service.get({ url: '/app_builder/' + this.id + '/role' })\n\t\t\t\t.fail(reject)\n\t\t\t\t.done(resolve)\n\t\t\t}\n\t\t);\n\t}\n\n\n\t/**\n\t * @method createPermission()\n\t *\n\t * Create a Role in the system after the name of the current ABApplication.\n\t *\n\t * @return {Promise}\n\t */\n\tcreatePermission () {\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n// TODO: need to take created role and store as : .json.applicationRole = role.id\n\n\t\t\t\tAD.comm.service.post({ url: '/app_builder/' + this.id + '/role' })\n\t\t\t\t.fail(reject)\n\t\t\t\t.done(resolve)\n\n\t\t\t}\n\t\t);\n\t}\n\n\n\t/**\n\t * @method deletePermission()\n\t *\n\t * Remove the Role in the system of the current ABApplication.\n\t * (the one created by  .createPermission() )\n\t *\n\t * @return {Promise}\n\t */\n\tdeletePermission () {\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n// TODO: need to remove created role from : .json.applicationRole\n\t\t\t\tAD.comm.service.delete({ url: '/app_builder/' + this.id + '/role' })\n\t\t\t\t.fail(reject)\n\t\t\t\t.done(resolve)\n\n\t\t\t}\n\t\t);\n\t}\n\n\n\n\n\t///\n\t/// Objects\n\t///\n\n\n\n\n\t/**\n\t * @method objects()\n\t *\n\t * return an array of all the ABObjects for this ABApplication.\n\t *\n\t * @param {fn} filter  \ta filter fn to return a set of ABObjects that this fn\n\t *\t\t\t\t\t\treturns true for.\n\t * @return {array} \tarray of ABObject\n\t */\n\tobjects (filter) {\n\n\t\tfilter = filter || function() {return true; };\n\n\t\treturn this._objects.filter(filter);\n\n\t}\n\n\n\n\t/**\n\t * @method objectNew()\n\t *\n\t * return an instance of a new (unsaved) ABObject that is tied to this\n\t * ABApplication.\n\t *\n\t * NOTE: this new object is not included in our this.objects until a .save()\n\t * is performed on the object.\n\t *\n\t * @return {ABObject}\n\t */\n\tobjectNew( values ) {\n\t\treturn new ABObject(values, this);\n\t}\n\n\n\n\t/**\n\t * @method objectDestroy()\n\t *\n\t * remove the current ABObject from our list of ._objects.\n\t *\n\t * @param {ABObject} object\n\t * @return {Promise}\n\t */\n\tobjectDestroy( object ) {\n\n\t\tvar remaininObjects = this.objects(function(o) { return o.id != object.id;})\n\t\tthis._objects = remaininObjects;\n\t\treturn this.save();\n\t\t\n\t\t// var isIncluded = (this.objects(function(o){ return o.id == object.id }).length > 0);\n\t\t// if (!isIncluded) {\n\t\t// \tthis._objects.push(object);\n\t\t// }\n\n\t\t// return this.save();\n\t}\n\n\n\n\t/**\n\t * @method objectSave()\n\t *\n\t * persist the current ABObject in our list of ._objects.\n\t *\n\t * @param {ABObject} object\n\t * @return {Promise}\n\t */\n\tobjectSave( object ) {\n\t\tvar isIncluded = (this.objects(function(o){ return o.id == object.id }).length > 0);\n\t\tif (!isIncluded) {\n\t\t\tthis._objects.push(object);\n\t\t}\n\n\t\treturn this.save();\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/ABApplication.js","/*\n * ABField\n *\n * An ABField defines a single unique Field/Column in a ABObject.\n *\n */\n\n// import OP from \"../../OP/OP\"\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\nexport default class ABField {\n\n    constructor(values, object, fieldDefaults) {\n\n    \t// NOTE: setup this first so later we can use .fieldType(), .fieldIcon()\n    \tthis.defaults = fieldDefaults;\n\n\n    \t/*\n  \t\t{\n  \t\t\tid:'uuid',\t\t\t\t\t// uuid value for this obj\n  \t\t\tkey:'fieldKey',\t\t\t\t// unique key for this Field\n  \t\t\ticon:'font',\t\t\t\t// fa-[icon] reference for an icon for this Field Type\n  \t\t\tlabel:'',\t\t\t\t\t// pulled from translation\n\t\t\tcolumnName:'column_name',\t// a valid mysql table.column name\n\t\t\tsettings: {\t\t\t\t\t// unique settings for the type of field\n\t\t\t\tshowIcon:true/false,\t// only useful in Object Workspace DataTable\n\n\t\t\t\t// specific for dataField\n\t\t\t},\n\t\t\ttranslations:[]\n  \t\t}\n  \t\t*/\n  \t\tthis.fromValues(values);\n\n\n\n    \t// label is a multilingual value:\n    \tOP.Multilingual.translate(this, this, ['label']);\n\n\n    \tthis.object = object;\n  \t}\n\n\n\n  \t///\n  \t/// Static Methods\n  \t///\n  \t/// Available to the Class level object.  These methods are not dependent\n  \t/// on the instance values of the Application.\n  \t///\n\n  \tstatic clearEditor( ids) {\n\n  \t\tvar defaultValues = {\n  \t\t\tlabel: '',\n  \t\t\tcolumnName:'',\n  \t\t\tshowIcon:1\n  \t\t}\n\n  \t\tfor(var f in defaultValues) {\n\t\t\tvar component = $$(ids[f]);\n\t\t\tcomponent.setValue(defaultValues[f]);\n\t\t}\n  \t}\n\n\n  \tstatic editorPopulate( ids, field ) {\n\n  \t\t$$(ids.label).setValue(field.label);\n  \t\t$$(ids.columnName).setValue(field.columnName);\n  \t\t$$(ids.showIcon).setValue(field.settings.showIcon);\n\n  \t}\n\n\n\t/**\n\t * @function definitionEditor\n\t *\n\t * Many DataFields share some base information for their usage\n\t * in the AppBuilder.  The UI Editors have a common header\n\t * and footer format, and this function allows child DataFields\n\t * to not have to define those over and over.\n\t *\n\t * The common layout header contains:\n\t *\t\t[Menu Label]\n\t *\t\t[textBox: labelName]\n\t *\t\t[text:    description]\n\t *\n\t * The defined DataField UI will be added at the end of this.\n\t *\n\t * This routine actually updated the live DataField definition\n\t * with the common header info.\n\t *\n\t * @param {DataField} field  The DataField object to work with.\n\t */\n  \tstatic definitionEditor( App, ids, _logic, Field ) {\n\n/// TODO: maybe just pass in onChange instead of _logic\n/// if not onChange, then use our default:\n\n  \t\t// setup our default labelOnChange functionality:\n  \t\tvar onChange = function (newVal, oldVal) {\n\n  \t\t\toldVal = oldVal || '';\n\n\t\t\tif (newVal != oldVal &&\n\t\t\t\toldVal == $$(ids.columnName).getValue()) {\n\t\t\t\t$$(ids.columnName).setValue(newVal);\n\t\t\t}\n\t\t}\n\n\t\t// if they provided a labelOnChange() override, use that:\n\t\tif (_logic.labelOnChange) {\n\t\t\tonChange = _logic.labelOnChange;\n\t\t}\n\n\n  \t\tvar _ui = {\n\t\t\t// id: ids.component,\n\t\t\trows: [\n\t\t\t\t// {\n\t\t\t\t// \tview: \"label\",\n\t\t\t\t// \tlabel: \"<span class='webix_icon fa-{0}'></span>{1}\".replace('{0}', Field.icon).replace('{1}', Field.menuName)\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tid: ids.label,\n\t\t\t\t\tname:'label',\n\t\t\t\t\tlabel: App.labels.dataFieldHeaderLabel,\n\t\t\t\t\tplaceholder: App.labels.dataFieldHeaderLabelPlaceholder,\n\t\t\t\t\tlabelWidth: App.config.labelWidthMedium,\n\t\t\t\t\tcss: 'ab-new-label-name',\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: function (newVal, oldVal) {\n\t\t\t\t\t\t\tonChange(newVal, oldVal);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"text\",\n\t\t\t\t\tid: ids.columnName,\n\t\t\t\t\tname:'columnName',\n\t\t\t\t\tlabel: App.labels.dataFieldColumnName, // 'Name',\n\t\t\t\t\tlabelWidth: App.config.labelWidthMedium,\n\t\t\t\t\tplaceholder: App.labels.dataFieldColumnNamePlaceholder, // 'Column name',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tid: ids.fieldDescription,\n\t\t\t\t\tlabel: Field.description,\n\t\t\t\t\talign: \"right\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: 'checkbox',\n\t\t\t\t\tid: ids.showIcon,\n\t\t\t\t\tname:'showIcon',\n\t\t\t\t\tlabelRight: App.labels.dataFieldShowIcon, // 'Show icon',\n\t\t\t\t\tlabelWidth: App.config.labelWidthCheckbox,\n\t\t\t\t\tvalue:true\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\n  \t\treturn _ui;\n  \t}\n\n\n  \tstatic editorValues (settings) {\n\n  \t\tvar obj = {\n  \t\t\tlabel: settings.label,\n  \t\t\tcolumnName: settings.columnName,\n  \t\t\tsettings:settings\n  \t\t}\n\n  \t\tdelete settings.label;\n  \t\tdelete settings.columnName;\n\n  \t\treturn obj;\n  \t}\n\n\n  \t// unique key to reference this specific DataField\n  \tfieldKey() {\n  \t\treturn this.defaults.key;\n  \t}\n\n  \t// font-awesome icon reference.  (without the 'fa-').  so 'user'  to reference 'fa-user'\n  \tfieldIcon() {\n  \t\treturn this.defaults.icon;\n  \t}\n\n  \t// the multilingual text for the name of this data field.\n  \tfieldMenuName() {\n  \t\treturn this.defaults.menuName;\n  \t}\n\n  \t// the multilingual text for the name of this data field.\n  \tfieldDescription() {\n  \t\treturn this.defaults.description;\n  \t}\n\n\n\n  \t/*\n  \t * @method isValid\n  \t * check the current values to make sure they are valid.\n  \t * Here we check the default values provided by ABField.\n  \t *\n  \t * @return null or [{OP.Validation.validator()}] objects.\n  \t */\n\tisValid() {\n\n\t\tvar validator = OP.Validation.validator();\n\n\t\t// .columnName must be unique among fileds on the same object\n\t\tvar isNameUnique = (this.object.fields((f)=>{\n\t\t\tvar isDifferent = (f.id != this.id);\n\t\t\treturn (f.id != this.id)\n\t\t\t\t\t&& (f.columnName.toLowerCase() == this.columnName.toLowerCase() );\n\t\t}).length == 0);\n\t\tif (!isNameUnique) {\n\t\t\tvalidator.addError('columnName', L('ab.validation.object.name.unique', 'Field columnName must be unique (#name# already used in this Application)').replace('#name#', this.columnName) );\n\t\t}\n\n\t\treturn validator;\n\t}\n\n\n\n\t///\n\t/// Instance Methods\n\t///\n\n\n\t/// ABApplication data methods\n\n\n\t/**\n\t * @method destroy()\n\t *\n\t * destroy the current instance of ABApplication\n\t *\n\t * also remove it from our _AllApplications\n\t *\n\t * @return {Promise}\n\t */\n\tdestroy () {\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\t// verify we have been .save()d before:\n\t\t\t\tif (this.id) {\n\n\t\t\t\t\t// NOTE: our .migrateXXX() routines expect the object to currently exist\n\t\t\t\t\t// in the DB before we perform the DB operations.  So we need to\n\t\t\t\t\t// .migrateDrop()  before we actually .objectDestroy() this.\n\t\t\t\t\tthis.migrateDrop()\n\t\t\t\t\t.then(()=>{\n\t\t\t\t\t\treturn this.object.fieldRemove(this);\n\t\t\t\t\t})\n\t\t\t\t\t.then(resolve)\n\t\t\t\t\t.catch(reject)\n\n\t\t\t\t} else {\n\n\t\t\t\t\tresolve();  // nothing to do really\n\t\t\t\t}\n\n\t\t\t}\n\t\t)\n\n\t}\n\n\n\t/**\n\t * @method save()\n\t *\n\t * persist this instance of ABField with it's parent ABObject\n\t *\n\t *\n\t * @return {Promise}\n\t *\t\t\t\t\t\t.resolve( {this} )\n\t */\n\tsave () {\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\tvar isAdd = false;\n\t\t\t\t// if this is our initial save()\n\t\t\t\tif (!this.id) {\n\t\t\t\t\tisAdd = true;\n\t\t\t\t\tthis.id = OP.Util.uuid();\t// setup default .id\n\t\t\t\t}\n\n\n\t\t\t\tthis.object.fieldSave(this)\n\t\t\t\t.then(() => {\n\n\t\t\t\t\tif (isAdd) {\n\n\t\t\t\t\t\tthis.migrateCreate()\n\t\t\t\t\t\t.then(()=>{\n\t\t\t\t\t\t\tresolve(this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(reject);\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(this);\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t\t.catch(function(err){\n\t\t\t\t\treject(err);\n\t\t\t\t})\n\t\t\t}\n\t\t)\n\t}\n\n\n\t/**\n\t * @method toObj()\n\t *\n\t * properly compile the current state of this ABField instance\n\t * into the values needed for saving to the DB.\n\t *\n\t * @return {json}\n\t */\n\ttoObj () {\n\n\t\t// store \"label\" in our translations\n\t\tOP.Multilingual.unTranslate(this, this, [\"label\"]);\n\n\t\treturn {\n\t\t\tid : this.id,\n\t\t\tkey : this.key,\n\t\t\ticon : this.icon,\n\t\t\tcolumnName: this.columnName,\n\t\t\tsettings: this.settings,\n\t\t\ttranslations:this.translations\n\t\t}\n\t}\n\n\n\t/**\n\t * @method fromValues()\n\t *\n\t * initialze this object with the given set of values.\n\t * @param {obj} values\n\t */\n\tfromValues (values) {\n\n \t\tthis.id = values.id;\t\t\t// NOTE: only exists after .save()\n    \tthis.key = values.key || this.fieldKey();\n    \tthis.icon = values.icon || this.fieldIcon();\n\n    \t// if this is being instantiated on a read from the Property UI,\n    \t// .label is coming in under .settings.label\n    \tthis.label = values.label || values.settings.label || '?label?';\n\n    \tthis.columnName = values.columnName || '';\n    \tthis.translations = values.translations || [];\n\n    \tthis.settings = values.settings || {};\n    \tthis.settings.showIcon = values.settings.showIcon+\"\" || \"1\";\n\n\n    \t// convert from \"0\" => 0\n    \tthis.settings.showIcon = parseInt(this.settings.showIcon);\n\t}\n\n\n\n\t///\n\t/// DB Migrations\n\t///\n\n\tmigrateCreate() {\n\t\tvar url = '/app_builder/migrate/application/#appID#/object/#objID#/field/#fieldID#'\n\t\t\t.replace('#appID#', this.object.application.id)\n\t\t\t.replace('#objID#', this.object.id)\n\t\t\t.replace('#fieldID#', this.id)\n\n\t\treturn OP.Comm.Service.post({\n\t\t\turl: url\n\t\t})\n\t}\n\n\n\tmigrateDrop() {\n\t\tvar url = '/app_builder/migrate/application/#appID#/object/#objID#/field/#fieldID#'\n\t\t\t.replace('#appID#', this.object.application.id)\n\t\t\t.replace('#objID#', this.object.id)\n\t\t\t.replace('#fieldID#', this.id)\n\n\t\treturn OP.Comm.Service['delete']({\n\t\t\turl: url\n\t\t})\n\t}\n\n\n\n\t///\n\t/// Working with Actual Object Values:\n\t///\n\n\t/*\n\t * @function columnHeader\n\t * Return the column header for a webix grid component for this specific\n\t * data field.\n\t * @param {bool} isObjectWorkspace is this being used in the Object\n\t *\t\t\t\t\t\t\t\t   workspace.\n\t * @return {obj}  configuration obj\n\t */\n\tcolumnHeader (isObjectWorkspace) {\n\n\t\tvar config = {\n\t\t\tid: this.columnName, // this.id,\n\t\t\theader: this.label,\n\t\t}\n\n\t\tif (isObjectWorkspace) {\n\t\t\tif (this.settings.showIcon) {\n\t\t\t\tconfig.header = '<span class=\"webix_icon fa-{icon}\"></span>'.replace('{icon}', this.fieldIcon() ) + config.header;\n\t\t\t}\n\t\t}\n\n\t\treturn config;\n\t}\n\n\n\t/*\n\t * @function customDisplay\n\t * perform any custom display modifications for this field.  If this isn't \n\t * a standard value display (think image, Map, graph, etc...) then use this\n\t * method to create the display in the table/grid cell.\n\t * @param {object} row is the {name=>value} hash of the current row of data.\n\t * @param {App} App the shared ui App object useful more making globally\n\t *\t\t\t\t\tunique id references.\n\t * @param {HtmlDOM} node  the HTML Dom object for this field's display.\n\t */\n\tcustomDisplay(row, App, node) {\n\t\t\n\t}\n\n\n\n\t/**\n\t * @method isValidData\n\t * Parse through the given data and return an error if this field's\n\t * data seems invalid.\n\t * @param {obj} data  a key=>value hash of the inputs to parse.\n\t */\n\tisValidData(data, validator) {\n\n\t\tconsole.error('!!! Field ['+this.fieldKey()+'] has not implemented .isValidData()!!!');\n\n\t}\n\n\n\n\t/*\n\t * @function isMultilingual\n\t * does this field represent multilingual data?\n\t * @return {bool}\n\t */\n\tisMultilingual() {\n\t\treturn false;\n\t}\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/dataFields/ABField.js","/* \n * ABFieldComponent\n * \n * An ABFieldComponent defines the UI component used by an ABField to display it's properties.\n *\n */\n\nimport ABField from \"./ABField\"\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\nexport default class ABFieldComponent {\n\n\n    constructor(options) {\n\n    \tthis.options = options;\n\n    \tthis.fieldDefaults = options.fieldDefaults || {};\n\n    \tthis.elements = options.elements || function (App) { return []; } ;\n\n    \tthis.defaultValues = options.defaultValues || {};\n\n    \tthis.rules = options.rules || {};\n\n    \tthis.logic = options.logic || {};\n\n    \tthis.init = options.init || function() {};\n\n\n\n    \tthis.idBase = this.fieldDefaults.key || '??fieldKey??';\n\n    \t// this.ids = options.ids || {};\n    \tthis.ids = {};\n\n    \t\n  \t}\n\n\n\n  \t///\n  \t/// Static Methods\n  \t///\n  \t/// Available to the Class level object.  These methods are not dependent\n  \t/// on the instance values of the Application.\n  \t///\n\n\n\n\n\t///\n\t/// Instance Methods\n\t///\n\n\tcomponent (App) {\n\n\t\t// for each provided element: create an this.ids for it:\n    \tvar elements = this.elements(App, this);\n\n\n    \t////\n    \t//// prepare our ids\n    \t////\n\n\t\tvar ids = {\n\n\t\t\tcomponent: App.unique(this.idBase+'_component'),\n\n\t\t\t// the common property fields\n\t\t\tlabel: App.unique(this.idBase+'_label'),\n\t\t\tcolumnName: App.unique(this.idBase+'_columnName'),\n\t\t\tfieldDescription: App.unique(this.idBase+'_fieldDescription'),\n\t\t\tshowIcon: App.unique(this.idBase+'_showIcon'),\n\t\t}\n\n    \tthis.eachDeep(elements, (e) => {\n    \t\tif (e.name) {\n    \t\t\t// if element has an .id, then use it in our list as is\n    \t\t\tif (e.id) {\n    \t\t\t\tids[e.name] = e.id;\n    \t\t\t}\n\n    \t\t\t// otherwise create a new entry in our base list\n    \t\t\tthis.ids[e.name] = e.name;\n    \t\t}\n    \t})\n\n\n\t\t// convert the entries in our base list into a globally acceptable id\n\t\t// and use that in our ids list if it doesn't already exist\n\t\tfor (var i in this.ids) {\n\t\t\tif (!ids[i]) {\n\t\t\t\tids[i] = App.unique(this.idBase+'_'+i);\n\t\t\t}\n\t\t}\n\n\t\t// update our elements to include our ids as we have them now.\n\t\tthis.eachDeep(elements, (e) => {\n    \t\tif (e.name) {\n    \t\t\te.id = ids[e.name];\n    \t\t}\n    \t})\n\n\n\t\t////\n\t\t//// our UI definition:\n\t\t////\n\n\t\t// our base form:\n\t\tvar _ui = {\n\t\t\tview:'form',\n\t\t\tid: ids.component,\n\t\t\tautoheight:true,\n\t\t\tborderless:true,\n\t\t\telements: [\n\t\t\t\t// {\n\t\t\t\t// \tview: \"text\",\n\t\t\t\t// \tid: ids.textDefault,\n\t\t\t\t// \tname:'textDefault',\n\t\t\t\t// \tplaceholder: labels.component.defaultText\n\t\t\t\t// },\n\t\t\t\t// {\n\t\t\t\t// \tview: \"checkbox\",\n\t\t\t\t// \tid: ids.supportMultilingual,\n\t\t\t\t// \tname:'supportMultilingual',\n\t\t\t\t// \tlabelRight: labels.component.supportMultilingual,\n\t\t\t\t// \tlabelWidth: 0,\n\t\t\t\t// \tvalue: true\n\t\t\t\t// }\n\t\t\t],\n\n\t\t\trules:{\n\t\t\t\t'label':webix.rules.isNotEmpty,\n\t\t\t\t'columnName':webix.rules.isNotEmpty\n\t\t\t}\n\t\t}\n\n\n\n\t\tvar _init = function() {\n\n\t\t\t// call our provided .init() routine\n\t\t\tthis.init(ids);\n\t\t}\n\n\n\n\t\tvar _logic = {\n\n\t\t\t/*\n\t\t\t * @function clear\n\t\t\t *\n\t\t\t * clear the form.\n\t\t\t */\n\t\t\tclear: () => {\n\n\t\t\t\tABField.clearEditor( ids );\n\n\t\t\t\tfor(var f in this.defaultValues) { \n\t\t\t\t\tvar component = $$(ids[f]);\n\t\t\t\t\tif(component) {\n\t\t\t\t\t\tcomponent.setValue(this.defaultValues[f]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn('!! could not find component for default value: name:'+f+' id:'+ids[f]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$$(ids.component).clearValidation();\n\n\n\t\t\t\t// perform provided .clear()\n\t\t\t\tif (this.logic.clear) {\n\t\t\t\t\tthis.logic.clear(ids);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/*\n\t\t\t * @function hide\n\t\t\t *\n\t\t\t * hide this component.\n\t\t\t */\n\t\t\thide: () => {\n\t\t\t\t$$(ids.component).clearValidation();\n\t\t\t\t$$(ids.component).hide( false, false);\n\n\t\t\t\t// perform provided .hide()\n\t\t\t\tif (this.logic.hide) {\n\t\t\t\t\tthis.logic.hide(ids)\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/*\n\t\t\t * @function isValid\n\t\t\t *\n\t\t\t * checks the current values on the componet to see if they are Valid\n\t\t\t */\n\t\t\tisValid: () => {\n\n\t\t\t\tvar isValid = $$(ids.component).validate();\n\n\t\t\t\t// perform provided .isValid()\n\t\t\t\tif (this.logic.isValid) {\n\t\t\t\t\tisValid = this.logic.isValid(ids, isValid);\n\t\t\t\t}\n\n\t\t\t\treturn isValid;\n\t\t\t},\n\n\n\t\t\t/*\n\t\t\t * @function labelOnChange\n\t\t\t *\n\t\t\t * The ABField.definitionEditor implements a default operation\n\t\t\t * to update the value of the .columnName with the current value of \n\t\t\t * label.\n\t\t\t * \n\t\t\t * if you want to override that functionality, implement this fn()\n\t\t\t *\n\t\t\t * @param {string} newVal\tThe new value of label\n\t\t\t * @param {string} oldVal\tThe previous value\n\t\t\t */\n\t\t\t// labelOnChange: function (newVal, oldVal) {\n\n\t\t\t// \t// When the Label value changes, update our Column Name value \n\t\t\t// \t// to match.\n\n\t\t\t// \toldVal = oldVal || '';\n\t\t\t// \tif (newVal != oldVal &&\n\t\t\t// \t\toldVal == $$(ids.columnName).getValue()) {\n\t\t\t// \t\t$$(ids.columnName).setValue(newVal);\n\t\t\t// \t}\n\t\t\t// },\n\n\n\t\t\t/*\n\t\t\t * @function populate\n\t\t\t *\n\t\t\t * populate the form with the given ABField instance provided.\n\t\t\t *\n\t\t\t * @param {ABField} field\n\t\t\t */\n\t\t\tpopulate: (field) => {\n\n\t\t\t\t// populate the base ABField values:\n\t\t\t\tABField.editorPopulate(ids, field);\n\n\t\t\t\tthis.eachDeep(elements, function(e){\n\t\t\t\t\tif (e.name != null) {\n\t\t\t\t\t\t$$(ids[e.name]).setValue(field.settings[e.name]);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\t// perform provided .populate()\n\t\t\t\tif (this.logic.populate) {\n\t\t\t\t\tthis.logic.populate(ids, field);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/*\n\t\t\t * @function show\n\t\t\t *\n\t\t\t * show this component.\n\t\t\t */\n\t\t\tshow: (a, b) => {\n\t\t\t\t$$(ids.component).clearValidation();\n\t\t\t\t$$(ids.component).show(a, b);\n\n\t\t\t\t// perform provided .show()\n\t\t\t\tif (this.logic.show) {\n\t\t\t\t\tthis.logic.show(ids)\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/*\n\t\t\t * @function values\n\t\t\t *\n\t\t\t * return the values for this form.\n\t\t\t * @return {obj}  \n\t\t\t */\n\t\t\tvalues: () => {\n\n\t\t\t\tvar settings = $$(ids.component).getValues();\n\t\t\t\tvar values = ABField.editorValues(settings);\n\n\t\t\t\tvalues.key = this.fieldDefaults.key;\n\t\t\n\t\t\t\t// perform provided .values()\n\t\t\t\tif (this.logic.values) {\n\t\t\t\t\tvalues = this.logic.values(ids, values)\n\t\t\t\t}\n\n\t\t\t\treturn values;\n\t\t\t}\n\n\t\t}\n\n\t\t// apply additional logic functions:\n\t\tfor (var l in this.logic) {\n\t\t\tif (!_logic[l]) _logic[l] = this.logic[l];\n\t\t}\n\n\n\t\t// make sure our given elements, have an id set:\n\n\n\t\t// get the common UI headers entries, and insert them above ours here:\n\t\t// NOTE: put this here so that _logic is defined.\n\t\tvar commonUI = ABField.definitionEditor(App, ids, _logic, this.fieldDefaults);\n\t\t_ui.elements = commonUI.rows.concat(elements);\n\n\t\tfor (var r in this.rules) {\n\t\t\t_ui.rules[r] = this.rules[r];\n\t\t}\n\n\n\t\t// return the current instance of this component:\n\t\treturn this._component = {\n\t\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component  \n\t\t\t// actions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\n\t\t\t// DataField exposed actions:\n\t\t\tclear: _logic.clear,\n\t\t\thide: _logic.hide,\n\t\t\tisValid:_logic.isValid,\n\t\t\tpopulate: _logic.populate,\n\t\t\tshow: _logic.show,\n\t\t\tvalues: _logic.values,\n\n\n\t\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t\t}\n\t}\n\n\n\n\t/**\n\t * @function eachDeep\n\t * a depth first fn to apply fn() to each element of our list.\n\t * @param {array} list  array of webix elements to scan\n\t * @param {fn} fn function to apply to each element.\n\t */\n\teachDeep(list, fn) {\n\t\tlist.forEach((e) => {\n\n\t\t\t// process sub columns\n\t\t\tif (e.cols) {\n\t\t\t\tthis.eachDeep(e.cols, fn);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// or rows\n\t\t\tif (e.rows) {\n\t\t\t\tthis.eachDeep(e.rows, fn);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// or just process this element:\n\t\t\tfn(e)\n\t\t})\n\t}\n\n\n\tidsUnique(ids, App) {\n\n\t\tfor (var i in ids) {\n\t\t\tif (ids[i] == '') {\n\t\t\t\tids[i] = App.unique(this.idBase+'_'+i)\n\t\t\t} else {\n\t\t\t\tids[i] = App.unique(this.idBase+'_'+ids[i])\n\t\t\t}\n\t\t}\n\t\treturn ids;\n\t}\n\n\t// populate(field) {\n\t// \tthis._component.populate(field);\n\t// }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/dataFields/ABFieldComponent.js","import Service from \"./comm_service\"\n\nexport default {\n\n\t// OP.Comm.Service.*\n\tService: Service\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/comm/comm.js","\n/**\n * @class config\n *\n * Manage our configuration settings.\n */\n\nimport ConfigDesktop from \"./configDesktop\"\nimport ConfigMobile from \"./configMobile\"\n\n\nexport default {\n\tconfig:function(){\n\n\t\t// TODO: decide which config file to return here:\n\t\tif (window.innerWidth < 768) {\n\t\t\treturn ConfigMobile;\n\t\t}\n\t\treturn ConfigDesktop;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/config/config.js","\n\nvar _restURLs = {\n\tfindAll: 'GET #url#',\n\tfindOne: 'GET #url#/{id}',\n\tcreate:  'POST #url#',\n\tupdate:  'PUT #url#/{id}',\n\tdestroy: 'DELETE #url#/{id}',\n}\n\n\nvar _Models = {};\n\n\nclass OPModel {\n\n\tconstructor(key, staticData, instanceData) {\n\n\t\tthis.key = key;\n\t\tthis.staticData = staticData;\n\t\tthis.instanceData = instanceData;\n\t\tthis.Model = staticData.Model;\n\n\t\tthis.url = {};\n\t\tfor(var r in _restURLs) {\n\t\t\tthis.url[r] = staticData[r]\n\t\t}\n\n\t}\n\n\tModels(Model) {\n\t\tthis.Model = Model;\n\t}\n\n\tfindAll(cond ) {\n\t\treturn new Promise( \n\t\t\t(resolve, reject) => {\n\n// NOTE: currently reusing AD.Model\n\n\t\t\t\t// var Model = AD.Model.get(this.key);\n\t\t\t\t// Model.findAll(cond)\n\n\t\t\t\tvar service = this.service('findAll');\n\n\t\t\t\tAD.comm.service[service.verb]({ url:service.url, params: cond })\n\t\t\t\t.fail(reject)\n\t\t\t\t.done((data) => {\n\n\t\t\t\t\tdata = data.data || data;\n\n\t\t\t\t\t// our findAll() should return an array of items.\n\t\t\t\t\tif (!Array.isArray(data)) {\n\t\t\t\t\t\tdata = [data];\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// return instances of this.Model if provided:\n\t\t\t\t\tif (this.Model) {\n\t\t\t\t\t\tvar newList = []; // Model.List();\n\t\t\t\t\t\tdata.forEach((l) => {\n\t\t\t\t\t\t\tif (l) {\n\t\t\t\t\t\t\t\tnewList.push( new this.Model(l) );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tdata = newList;\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// convert to a WebixDataCollection:\n\t\t\t\t\tvar dc = new webix.DataCollection({\n\t\t\t\t\t\tdata: data,\n\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonAfterDelete: function(id) {\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// dc._toArray = function() {\n\t\t\t\t\t// \tvar data = [];\n\t\t\t\t\t// \tvar id = this.getFirstId();\n\t\t\t\t\t// \twhile(id) {\n\t\t\t\t\t// \t\tdata.push(this.getItem(id));\n\t\t\t\t\t// \t\tid = this.getNextId(id);\n\t\t\t\t\t// \t}\n\t\t\t\t\t// \treturn data;\n\t\t\t\t\t// }\n\n\n\n\t\t\t\t\tresolve(dc);\n\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\tfindOne(cond) {\n\t\treturn new Promise( \n\t\t\t(resolve, reject) => {\n\n\t\t\t\tvar service = this.service('findOne');\n\n\t\t\t\tvar nURI = service.url;\n                for (var k in cond) {\n                    var oURI = nURI;\n                    nURI = AD.util.string.replaceAll(nURI, \"{\" + k + \"}\", cond[k]);\n\n                    // if there was a change, remove k from cond:\n                    if (oURI != nURI) {\n                        delete cond[k];\n                    }\n                }\n                service.url = nURI;\n\n\t\t\t\tAD.comm.service[service.verb]({ url:service.url, params: cond })\n\t\t\t\t.fail(reject)\n\t\t\t\t.done(function(item){\n\t\t\t\t\tif (item.translate) item.translate();\n\n\t\t\t\t\tresolve(item.attr?item.attr():item);\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\tcreate(attr) {\n\t\treturn new Promise( \n\t\t\t(resolve, reject) => {\n\n\t\t\t\tvar service = this.service('create');\n\n\t\t\t\tAD.comm.service[service.verb]({ url:service.url, params: attr })\n\t\t\t\t.fail(reject)\n\t\t\t\t.done(function(item){\n\t\t\t\t\tif (item.translate) item.translate();\n\n\t\t\t\t\tresolve(item.attr?item.attr():item);\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\tupdate(id, attr) {\n\t\treturn new Promise( \n\t\t\t(resolve, reject) => {\n\n\t\t\t\tvar service = this.service('update', id);\n\n\t\t\t\tAD.comm.service[service.verb]({ url:service.url, params: attr })\n\t\t\t\t.fail(reject)\n\t\t\t\t.done(resolve);\n\t\t\t}\n\t\t);\n\t}\n\n\tdestroy(id) {\n\t\treturn new Promise( \n\t\t\t(resolve, reject) => {\n\n\t\t\t\tvar service = this.service('destroy', id);\n\n\t\t\t\tAD.comm.service[service.verb]({ url:service.url, params: {} })\n\t\t\t\t.fail(reject)\n\t\t\t\t.done(resolve);\n\t\t\t}\n\t\t);\n\t}\n\n\n\tservice(key, id) {\n\t\tvar parts = this.url[key].split(' ');\n\t\tvar verb = parts[0].toLowerCase();\n\t\tvar uri = parts.pop(); \n\n\t\tif (id) {\n\t\t\tvar key = '{id}';\n\t        uri = AD.util.string.replaceAll(uri, key, id);\n\t    }\n\n        return {\n        \tverb:verb,\n        \turl:uri\n        }\n\t}\n}\n\n\nexport default {\n\n\textend:function(key, staticData, instance) {\n\n\n\t\t//\n\t\t// Create the AD.Model from this definition\n\t\t//\n\n\t\tif (staticData.restURL) {\n\t\t\tfor (var u in _restURLs) {\n\t\t\t\tstaticData[u] = _restURLs[u].replace('#url#', staticData.restURL);\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\t// var alreadyThere = AD.Model.get(key);\n\t\t// if (!alreadyThere) {\n\n\t\t// \tAD.Model.Base.extend(key, staticData, instance);\n\t\t// \tAD.Model.extend(key, staticData, instance);\n\t\t// }\n\t\t\n\t\t//\n\t\t// Now create our OP.Model:\n\t\t//\n\t\tvar curr = nameSpace(_Models, key);\n\t\tvar modelName = objectName(key);\n\n\t\tcurr[modelName] = new OPModel(key, staticData, instance);\n\n\t},\n\n\tget: function(key) {\n\t\treturn findObject(_Models, key);\n\t}\n}\n\n\n\n\n\n\n\n\n            /*\n             * @function findObject\n             *\n             * Return the object specified by the given name space:\n             *\n             * @param {object} baseObj  The base object to search on\n             *                          usually AD.models or AD.models_base\n             *\n             * @param {string} name   The provided namespace to parse and search for\n             *                        The name can be spaced using '.' \n             *                        eg.  'coolTool.Resource1' => AD.models.coolTool.Resource1\n             *                             'coolerApp.tool1.Resource1' => AD.models.coolerApp.tool1.Resource1\n             *\n             * @returns {object}  the object resolved by the namespaced base \n             *                    eg:  findObject(AD.models, 'Resource') => return AD.models.Resource\n             *                         findObject(AD.models, 'coolTool.Resource1') => AD.models.coolTool.Resource1\n             *\n             *                    if an object is not found, null is returned.\n             */\n            var findObject = function (baseObj, name) {\n\n                // first lets figure out our namespacing:\n                var nameList = name.split('.');\n\n                // for each remaining name segments, make sure we have a \n                // namespace container for it:\n                var curr = baseObj;\n                nameList.forEach(function (name) {\n\n                    if (curr == null) {\n                        var whoops = true;\n                        console.error('! current name segment is null.  Check your given name to make sure it is properly given: ', name);\n                    }\n                    if (curr) {\n                        if (typeof curr[name] == 'undefined') {\n                            curr = null;\n                        }\n                        if (curr) curr = curr[name];\n                    }\n                })\n\n                return curr;\n            }\n\n\n\n            /*\n             * @function objectName\n             *\n             * parse the name and return the name of the object we will create.\n             *\n             * @param {string} name   The provided namespace to parse \n             *                        The name can be spaced using '.' \n             *\n             * @returns {string}  the name of the model object \n             *                    eg:  objectName('Resource') => return 'Resource'\n             *                         objectName('coolTool.Resource1') => 'Resource1'\n             */\n            var objectName = function (name) {\n\n                // first lets figure out our namespacing:\n                var nameList = name.split('.');\n                var objName = nameList.pop(); // remove the last one.\n\n                return objName;\n            }\n\n\n\n            /*\n             * @function nameSpace\n             *\n             * Make sure the proper name space is created on the given base.\n             *\n             * @param {object} baseObj  The base object to create the namespace on\n             *                          usually AD.models or AD.models_base\n             *\n             * @param {string} name   The provided namespace to parse and create\n             *                        The name can be spaced using '.' \n             *                        eg.  'coolTool.Resource1' => AD.models.coolTool.Resource1\n             *                             'coolerApp.tool1.Resource1' => AD.models.coolerApp.tool1.Resource1\n             *\n             * @returns {object}  the object that represents the namespaced base \n             *                    that the Model is to be created on.\n             *                    eg:  nameSpace(AD.models, 'Resource') => return AD.models\n             *                         nameSpace(AD.models, 'coolTool.Resource1') => AD.models.coolTool\n             */\n            var nameSpace = function (baseObj, name) {\n\n                // first lets figure out our namespacing:\n                var nameList = name.split('.');\n                var controlName = nameList.pop(); // remove the last one.\n\n                // for each remaining name segments, make sure we have a \n                // namespace container for it:\n                var curr = baseObj;\n                nameList.forEach(function (name) {\n\n                    if (typeof curr[name] == 'undefined') {\n                        curr[name] = {};\n                    }\n                    curr = curr[name];\n                })\n\n                return curr;\n            }\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/model.js","/*\n * OP.Multilingual\n *\n * A set of helpers for Multilingual Data.\n *\n */\n\nexport default {\n\n\t/**\n\t * @function OP.Multilingual.translate\n\t *\n\t * Given a set of json data, pull out any multilingual translations\n\t * and flatten those values to the base object.\n\t *\n\t * @param {obj} obj  The instance of the object being translated\n\t * @param {json} json The json data being used for translation.\n\t *\t\t\t\t\t\tThere should be json.translations = [ {transEntry}, ...]\n\t *\t\t\t\t\t\twhere transEntry = {\n\t *\t\t\t\t\t\t\tlanguage_code:'en',\n\t *\t\t\t\t\t\t\tfield1:'value',\n\t *\t\t\t\t\t\t\t...\n\t *\t\t\t\t\t\t}\n\t * @param {array} fields an Array of multilingual fields to pull to \n\t *\t\t\t\t\t\t the obj[field] value.\n\t *\n\t */\n\ttranslate:function(obj, json, fields) {\n\n\t\tif (!json.translations) {\n\t\t\tjson.translations = [];\n\t\t}\n\n\t\tvar currLanguage = AD.lang.currentLanguage || 'en';\n\n\t\tif (fields && fields.length > 0) {\n\n\t\t\tjson.translations.forEach(function(t){\n\t\t\t\t// find the translation for the current language code\n\t\t\t\tif (t.language_code == currLanguage) {\n\n\t\t\t\t\t// copy each field to the root object\n\t\t\t\t\tfields.forEach(function(f){\n\t\t\t\t\t\tobj[f] = t[f] || '';  // default to '' if not found. \n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\n\n\t\t}\n\t},\n\n\n\t/**\n\t * @function OP.Multilingual.unTranslate\n\t *\n\t * Take the multilingual information in the base obj, and push that \n\t * down into the json.translations data.\n\t *\n\t * @param {obj} obj  The instance of the object with the translation\n\t * @param {json} json The json data being used for translation.\n\t *\t\t\t\t\t\tThere should be json.translations = [ {transEntry}, ...]\n\t *\t\t\t\t\t\twhere transEntry = {\n\t *\t\t\t\t\t\t\tlanguage_code:'en',\n\t *\t\t\t\t\t\t\tfield1:'value',\n\t *\t\t\t\t\t\t\t...\n\t *\t\t\t\t\t\t}\n\t * @param {array} fields an Array of multilingual fields to pull from \n\t *\t\t\t\t\t\t the obj[field] value.\n\t *\n\t */\n\tunTranslate: function( obj, json, fields) {\n\n\t\tjson = json || {};\n\t\tfields = fields || [];\n\n\t\tif (!json.translations) {\n\t\t\tjson.translations = [];\n\t\t}\n\n\t\tvar currLanguage = AD.lang.currentLanguage || 'en';\n\n\n\t\tif (fields && fields.length > 0) {\n\n\t\t\tvar foundOne = false;\n\n\t\t\tjson.translations.forEach(function(t){\n\t\t\t\t// find the translation for the current language code\n\t\t\t\tif (t.language_code == currLanguage) {\n\n\t\t\t\t\t// copy each field to the root object\n\t\t\t\t\tfields.forEach(function(f){\n\t\t\t\t\t\t\n\t\t\t\t\t\t// verify obj[f] is defined \n\t\t\t\t\t\t// --> DONT erase the existing translation\n\t\t\t\t\t\tif (typeof obj[f] != 'undefined'){\n\t\t\t\t\t\t\tt[f] = obj[f];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t})\n\n\t\t\t\t\tfoundOne = true;\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// if we didn't update an existing translation\n\t\t\tif (!foundOne) {\n\n\t\t\t\t// create a translation entry:\n\t            var trans = {};\n\n\t            // assume current languageCode:\n\t            trans.language_code = currLanguage;\n\n\t            fields.forEach(function (field) {\n\t                if (obj[field] != null) {\n\t                    trans[field] = obj[field];\n\t                }\n\t            })\n\n\t            json.translations.push(trans);\n\t\t\t}\n\n\t\t}\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/multilingual.js","\nexport default {\n\t\n\tuuid: AD.util.uuid\n\t\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/util.js","\nclass OPValidator {\n\n\tconstructor() {\n\n\t\tthis.errors = [];\n\t}\n\n\taddError(name, message) {\n\t\tthis.errors.push({name:name, message:message });\n\t}\n\n\tpass() {\n\t\treturn this.errors.length == 0;\n\t}\n\n\tfail() {\n\t\treturn this.errors.length > 0;\n\t}\n\n\ttoValidationObject() {\n\t\tvar obj = {\n\t\t\terror:'E_VALIDATION',\n\t\t\tinvalidAttributes:{\n\n\t\t\t}\n\t\t}\n\n\t\tvar attr = obj.invalidAttributes;\n\t\t\n\t\tthis.errors.forEach((e)=>{\n\n\t\t\tattr[e.name] = attr[e.name] || [];\n\t\t\tattr[e.name].push(e);\n\t\t})\n\n\t\treturn obj;\n\t}\n\n\n\tupdateForm(form) {\n\t\tvar vObj = this.toValidationObject();\n\t\tOP.Validation.isFormValidationError(vObj, form);\n\t}\n\n\tupdateGrid(rowID, grid) {\n\t\tvar vObj = this.toValidationObject();\n\t\tOP.Validation.isGridValidationError(vObj, rowID, grid);\n\t}\n}\n\n\n//// LEFT OFF HERE:\n// add an OP.Validation  and remove OP.Form  OP.Grid\n// update existing Applicaiton, Object, Field forms to use this.\n\n\nexport default {\n\n\t/**\n\t * @function OP.Validation.validator\n\t * return a new instance of OPValidator.\n\t * @return {OPValidator}\n\t */\n\tvalidator:function() {\n\t\treturn new OPValidator();\n\t},\n\n// var validator = OP.Validation.validator()\n// validator.addError('name', 'message')\n// validator.pass() \n// validator.updateForm(Form);\n// validator.updateGrid(editor, Grid);\n\n\t/**\n\t * @function OP.Validation.isFormValidationError\n\t *\n\t * scans the given error to see if it is a sails' response about an invalid\n\t * value from one of the form elements.\n\t *\n\t * @codestart\n\t * var form = $$('formID');\n\t * var values = form.getValues();\n\t * model.attr(values);\n\t * model.save()\n\t * .fail(function(err){\n\t *     if (!OP.Form.isFormValidationError(err, form)) {\n\t *         OP.error.log('Error saving current model ()', {error:err, values:values});\n\t *     }\n\t * })\n\t * .then(function(newData){\n\t * \n\t * });\n\t * @codeend\n\t *\n\t * @param {obj} error  the error response object\n\t * @param {obj} form   the webix form instance (or reference)\n\t * @return {bool}      true if error was about a form element.  false otherwise.\n\t */\n\tisFormValidationError: function(error, form) {\n\n\t\t// {bool} have we set focus to form component?\n\t\tvar hasFocused = false;\n\n\n\t\t// if we have an error object:\n\t\tif (error) { \n\n\n\t\t\t//// if the error obj is provided by Sails response, \n\t\t\t//// do some clean up on the error object:\n\n\n\t\t\t// dig down to sails provided error object:\n\t\t\tif ((error.error)\n\t\t\t\t&& (error.error == 'E_UNKNOWN')\n\t\t\t\t&& (error.raw)\n\t\t\t\t&& (error.raw.length > 0)) {\n\n\t\t\t\terror = error.raw[0]\n\t\t\t}\n\n\t\t\t// drill down to the embedded .err object if it exists\n\t\t\tif (error.err) {\n\t\t\t\terror = error.err;\n\t\t\t}\n\n\n\t\t\t//// Now process the error object\n\t\t\t//// \n\t\t\tif (((error.error)\n\t\t\t\t\t&& (error.error == 'E_VALIDATION'))\n\t\t\t\t|| ((error.code) && (error.code == 'E_VALIDATION'))) {\n\n\t\t\t\tvar attrs = error.invalidAttributes;\n\t\t\t\tif (attrs) {\n\n\t\t\t\t\tvar wasForm = false;\n\t\t\t\t\tfor (var attr in attrs) {\n\n\t\t\t\t\t\t// if this is a field in the form:\n\t\t\t\t\t\tif (form.elements[attr]) {\n\n\t\t\t\t\t\t\tvar errors = attrs[attr];\n\t\t\t\t\t\t\tvar msg = [];\n\t\t\t\t\t\t\terrors.forEach(function(err) {\n\t\t\t\t\t\t\t\tmsg.push(err.message);\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t// set the invalid error message\n\t\t\t\t\t\t\tform.markInvalid(attr, msg.join(', '));\n\n\t\t\t\t\t\t\t// set focus to the 1st form element we mark:\n\t\t\t\t\t\t\tif (!hasFocused) {\n\t\t\t\t\t\t\t\tform.elements[attr].focus();\n\t\t\t\t\t\t\t\thasFocused = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\twasForm = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif (wasForm) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\t// if we missed updating our form with an error\n\t\t// this was not a validation error so return false\n\t\treturn false\n\n\t},\n\n\n\n\t/**\n\t * @function OP.Validation.isGridValidationError\n\t *\n\t * scans the given error to see if it is a sails' response about an invalid\n\t * value from one of our grid columns.\n\t *\n\t * @codestart\n\t * var grid = $$('myGrid');\n\t * model.attr(values);\n\t * model.save()\n\t * .fail(function(err){\n\t *     if (!OP.Validation.isGridValidationError(err, editor, grid)) {\n\t *         OP.error.log('Error saving current model ()', {error:err, values:values});\n\t *     }\n\t * })\n\t * .then(function(newData){\n\t * \n\t * });\n\t * @codeend\n\t *\n\t * @param {obj} error  the error response object\n\t * @param {integer} row the row id of the Grid to update.\n\t * @param {obj} Grid   the webix grid instance (or reference)\n\t * @return {bool}      true if error was about a grid column.  false otherwise.\n\t */\n\tisGridValidationError: function(error, row, Grid) {\n\n\n\t\t// if we have an error object:\n\t\tif (error) { \n\n\n\t\t\t//// if the error obj is provided by Sails response, \n\t\t\t//// do some clean up on the error object:\n\n\n\t\t\t// dig down to sails provided error object:\n\t\t\tif ((error.error)\n\t\t\t\t&& (error.error == 'E_UNKNOWN')\n\t\t\t\t&& (error.raw)\n\t\t\t\t&& (error.raw.length > 0)) {\n\n\t\t\t\terror = error.raw[0]\n\t\t\t}\n\n\t\t\t// drill down to the embedded .err object if it exists\n\t\t\tif (error.err) {\n\t\t\t\terror = error.err;\n\t\t\t}\n\n\t\t\t// if this is from our server response:\n\t\t\tif (error.data && error.data.error && error.data.error == 'E_VALIDATION') {\n\t\t\t\terror = error.data;\n\t\t\t}\n\n\n\n\t\t\t//// Now process the error object\n\t\t\t//// \n\t\t\tif (((error.error)\n\t\t\t\t\t&& (error.error == 'E_VALIDATION'))\n\t\t\t\t|| ((error.code) && (error.code == 'E_VALIDATION'))) {\n\n\t\t\t\tvar attrs = error.invalidAttributes;\n\t\t\t\tif (attrs) {\n\n\t\t\t\t\tvar wasGrid = false;\n\t\t\t\t\tfor (var attr in attrs) {\n\n\t\t\t\t\t\t// if this is a field in the form:\n\t\t\t\t\t\t// if (form.elements[attr]) {\n\n\t\t\t\t\t\t// \tvar errors = attrs[attr];\n\t\t\t\t\t\t// \tvar msg = [];\n\t\t\t\t\t\t// \terrors.forEach(function(err) {\n\t\t\t\t\t\t// \t\tmsg.push(err.message);\n\t\t\t\t\t\t// \t})\n\n\t\t\t\t\t\t// \t// set the invalid error message\n\t\t\t\t\t\t// \tform.markInvalid(attr, msg.join(', '));\n\n\t\t\t\t\t\t// \t// set focus to the 1st form element we mark:\n\t\t\t\t\t\t// \tif (!hasFocused) {\n\t\t\t\t\t\t// \t\tform.elements[attr].focus();\n\t\t\t\t\t\t// \t\thasFocused = true;\n\t\t\t\t\t\t// \t}\n\n\t\t\t\t\t\t// \twasForm = true;\n\t\t\t\t\t\t// }\n\n\n\t\t\t\t\t\t\tGrid.addCellCss(row, attr, \"webix_invalid\");\n\t\t\t\t\t\t\tGrid.addCellCss(row, attr, \"webix_invalid_cell\");\n\n\t\t\t\t\t\t\tvar msg = [];\n\t\t\t\t\t\t\tattrs[attr].forEach((e)=>{\n\t\t\t\t\t\t\t\tmsg.push(e.message);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tOP.Dialog.Alert({\n\t\t\t\t\t\t\t\ttext: attr + ': ' + msg.join(', ')\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\twasGrid = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tGrid.refresh(row);\n\n\t\t\t\t\tif (wasGrid) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\t// if we missed updating our Grid with an error\n\t\t// this was not a validation error so return false\n\t\treturn false\n\n\t}\n\n\n\t\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/validation.js","//\n// OP.Comm.Service.*\n// \n// Map our old jQuery deferred comm utilities with ES6 promises.\n//\n\n\nvar services = {\n\n\n\t// OP.Comm.Service.get(options, cb) => {promise}\n\tget: function(options, cb) {\n\t\treturn new Promise( \n\t\t\t(resolve, reject) => {\n\t\t\t\tAD.comm.service.get(options,cb)\n\t\t\t\t.then(resolve, reject);\n\t\t\t}\n\t\t);\n\t},\n\n\n\t// OP.Comm.Service.post(options, cb) => {promise}\n\tpost: function(options, cb) {\n\t\treturn new Promise( \n\t\t\t(resolve, reject) => {\n\t\t\t\tAD.comm.service.post(options,cb)\n\t\t\t\t.then(resolve, reject);\n\t\t\t}\n\t\t);\n\t},\n\n\n\t// OP.Comm.Service.put(options, cb) => {promise}\n\tput: function(options, cb) {\n\t\treturn new Promise( \n\t\t\t(resolve, reject) => {\n\t\t\t\tAD.comm.service.put(options,cb)\n\t\t\t\t.then(resolve, reject);\n\t\t\t}\n\t\t);\n\t}\n\n}\n\n\n// OP.Comm.Service.delete(options, cb) => {promise}\nservices['delete'] = function(options, cb) {\n\treturn new Promise( \n\t\t(resolve, reject) => {\n\t\t\tAD.comm.service['delete'](options,cb)\n\t\t\t.then(resolve, reject);\n\t\t}\n\t);\n}\n\n\nexport default services;\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/comm/comm_service.js","\n/**\n * @class configDesktop\n *\n * Manage our configuration settings for Desktop styles.\n\n */\n\n\n\nexport default {\n\n\t// Application List\n\tappListRowHeight: 70,\n\n\t// button types\n\tbuttonWidthLarge: 200,\n\tbuttonWidthMedium: 150,\n\tbuttonWidthSmall: 100,\n\tbuttonWidthExtraSmall: 50,\n\n\t// tab types\n\ttabWidthLarge: 200,\n\ttabWidthMedium: 120,\n\ttabWidthSmall: 100,\n\ttabWidthExtraSmall: 50,\n\n\t// column types\n\n\n\t// spacers\n\tsmallSpacer: 10,\n\tmediumSpacer: 25,\n\tlargeSpacer: 50,\n\txLargeSpacer: 100,\n\txxLargeSpacer: 200,\n\txxxLargeSpacer: 400,\n\tappListSpacerRowHeight: 100,\n\tappListSpacerColMinWidth: 100,\n\tappListSpacerColMaxWidth: 200,\n\tobjectWorkspaceColWidth: 20,\n\n\t// labels\n\tlabelWidthSmall: 50,\n\tlabelWidthMedium: 80,\n\tlabelWidthLarge: 120,\n\tlabelWidthXLarge: 150,\n\tlabelWidthCheckbox: 0,\n\n\t// show elements on desktop\n\thideMobile: false,\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/config/configDesktop.js","\n/**\n * @class configMobile\n *\n * Manage our configuration settings for mobile styles.\n\n */\n\n\n\nexport default {\n\n\t// Application List\n\tappListRowHeight: 70,\n\n\t// button types\n\tbuttonWidthLarge: 200,\n\tbuttonWidthMedium: 150,\n\tbuttonWidthSmall: 100,\n\tbuttonWidthExtraSmall: 50,\n\n\t// tab types\n\ttabWidthLarge: 200,\n\ttabWidthMedium: 120,\n\ttabWidthSmall: 100,\n\ttabWidthExtraSmall: 50,\n\n\t// column types\n\n\n\t// spacers\n\tsmallSpacer: 1,\n\tmediumSpacer: 10,\n\tlargeSpacer: 20,\n\txLargeSpacer: 50,\n\txxLargeSpacer: 100,\n\txxxLargeSpacer: 120,\n\tappListSpacerRowHeight: 10,\n\tappListSpacerColMinWidth: 1,\n\tappListSpacerColMaxWidth: 1,\n\tobjectWorkspaceColWidth: 1,\n\n\t// labels\n\tlabelWidthSmall: 50,\n\tlabelWidthMedium: 80,\n\tlabelWidthLarge: 120,\n\tlabelWidthCheckbox: 0,\n\n\t// hide elements for mobile\n\thideMobile: true,\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/OP/config/configMobile.js","/* \n * ABFieldManager\n * \n * An interface for managing the different ABFields available in our AppBuilder.\n *\n */\n\n\nimport ABFieldString from \"./dataFields/ABFieldString\"\nimport ABFieldNumber from \"./dataFields/ABFieldNumber\"\nimport ABFieldDate from \"./dataFields/ABFieldDate\"\nimport ABFieldBoolean from \"./dataFields/ABFieldBoolean\"\n\n\nimport ABFieldImage from \"./dataFields/ABFieldImage\"\n\n/* \n * Fields\n * A name => ABField  hash of the different ABFields available.\n */\nvar Fields = {};\nFields[ABFieldString.defaults().key] = ABFieldString;\nFields[ABFieldNumber.defaults().key] = ABFieldNumber;\nFields[ABFieldDate.defaults().key] = ABFieldDate;\nFields[ABFieldBoolean.defaults().key] = ABFieldBoolean;\n\n\nFields[ABFieldImage.defaults().key] = ABFieldImage;\n\n\n\nexport default  {\n\n\n\t/*\n\t * @function allFields\n\t * return all the currently defined ABFields in an array.\n\t * @return [{ABField},...]\n\t */\n\tallFields: function() {\n\t\tvar fields = [];\n\t\tfor (var f in Fields) {\n\t\t\tfields.push(Fields[f]);\n\t\t}\n\t\treturn fields;\n\t},\n\n\n\t/*\n\t * @function newField\n\t * return an instance of an ABField based upon the values.type value.\n\t * @return {ABField}\n\t */\n\tnewField: function (values, object) {\n\n\t\tif (values.key) {\n\t\t\treturn new Fields[values.key](values, object);\n\t\t} else {\n\n//// TODO: what to do here?\n\t\t}\n\n\t}\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/ABFieldManager.js","\n/*\n * AB\n *\n * The base AppBuilder component.  It manages these components:\n *   - ab_choose :  choose an application to work with\n *   - ab_work   :  load an application into the work area\n *\n */\n\n// import '../OP/OP'\n\nimport './ab_choose'\nimport './ab_work'\n\n// Import our Custom Components here:\nimport EditTree from '../webix_custom_components/edittree'\nimport EditList from '../webix_custom_components/editlist'\n\nimport style from \"../AppBuilder.css\"\n\nOP.Component.extend('ab', function(App) {\n\n\n\tfunction L(key, altText) {\n\t\treturn AD.lang.label.getLabel(key) || altText;\n\t}\n\n\n\t// setup the common labels for our AppBuilder Application.\n\tApp.labels = {\n\t\tadd: L('ab.common.add', \"*Add\"),\n\t\tcreate: L('ab.common.create', \"*Create\"),\n\t\t\"delete\": L('ab.common.delete', \"*Delete\"),\n\t\tedit: \t  L('ab.common.edit', \"*Edit\"),\n\t\t\"export\": L('ab.common.export', \"*Export\"),\n\t\tformName: L('ab.common.form.name', \"*Name\"),\n\t\t\"import\": L('ab.common.import', \"*Import\"),\n\t\trename: L('ab.common.rename', \"*Rename\"),\n\t\tok: \t  L('ab.common.ok', \"*Ok\"),\n\n\t\tcancel:   L('ab.common.cancel', \"*Cancel\"),\n\t\tsave: \t  L('ab.common.save', \"*Save\"),\n\n\t\tyes: \t  L('ab.common.yes', \"*Yes\"),\n\t\tno: \t  L('ab.common.no', \"*No\"),\n\n\t\tcreateErrorMessage:   L('ab.common.create.error', \"*System could not create <b>{0}</b>.\"),\n\t\tcreateSuccessMessage: L('ab.common.create.success', \"*<b>{0}</b> is created.\"),\n\n\t\tupdateErrorMessage:  L('ab.common.update.error', \"*System could not update <b>{0}</b>.\"),\n\t\tupdateSucessMessage: L('ab.common.update.success', \"*<b>{0}</b> is updated.\"),\n\n\t\tdeleteErrorMessage:   L('ab.common.delete.error', \"*System could not delete <b>{0}</b>.\"),\n\t\tdeleteSuccessMessage: L('ab.common.delete.success', \"*<b>{0}</b> is deleted.\"),\n\n\t\trenameErrorMessage: L('ab.common.rename.error', \"*System could not rename <b>{0}</b>.\"),\n\t\trenameSuccessMessage: L('ab.common.rename.success', \"*<b>{0}</b> is renamed.\"),\n\n\n\t\t// Data Field  common Property labels:\n\t\tdataFieldHeaderLabel: L('ab.dataField.common.headerLabel', '*Label'),\n\t\tdataFieldHeaderLabelPlaceholder: L('ab.dataField.common.headerLabelPlaceholder', '*Header Name'),\n\n\t\tdataFieldColumnName: L('ab.dataField.common.columnName', '*Name'),\n\t\tdataFieldColumnNamePlaceholder: L('ab.dataField.common.columnNamePlaceholder', '*Column Name'),\n\n\t\tdataFieldShowIcon: L('ab.dataField.common.showIcon', '*show icon?')\n\t}\n\n\n\t// make instances of our Custom Components:\n\tOP.CustomComponent[EditTree.key](App, 'edittree'); // ->  App.custom.edittree  now exists\n\tOP.CustomComponent[EditList.key](App, 'editlist'); // ->  App.custom.editlist  now exists\n\n\n\n\n\tvar ids = {\n\t\tcomponent:App.unique('app_builder_root')\n\t}\n\n\n\n\t// Define the external components used in this Component:\n\tvar AppChooser = OP.Component['ab_choose'](App);\n\tvar AppWorkspace = OP.Component['ab_work'](App);\n\n\n\t// This component's UI definition:\n\t// Application multi-views\n\tvar _ui = {\n\t\tid: ids.component,\n\t\tview:\"multiview\",\n\t\tborderless:true,\n\t\tanimate: false,\n\t\trows:[\n\t\t\tAppChooser.ui,\n\t\t\tAppWorkspace.ui\n\t\t]\n\t};\n\n\n\n\t// This component's init() definition:\n\tvar _init = function() {\n\n\t\tAppChooser.init();\n\t\tAppWorkspace.init();\n\n\t\t// start off only showing the App Chooser:\n\t\tApp.actions.transitionApplicationChooser();\n\n\t\t// perform an initial resize adjustment\n\t\t$$(ids.component).adjust();\n\t}\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\t}\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\t}\n\n});\n\n\n\n\n\n\n//// REFACTORING TODOs:\n// TODO: AppForm-> Permissions : refresh permission list, remove AppRole permission on Application.delete().\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab.js","\n// import 'OP';\n// import '../../../../../assets/js/webix/webix'\n\n\nimport './components/ab'\n\n\nAD.Control.OpsTool.extend('BuildApp', {\n\n\tinit: function (element, options) {\n\t\tvar self = this;\n\n\t\toptions = AD.defaults({\n\t\t\ttemplateDOM: '/opstools/BuildApp/views/BuildApp/BuildApp.ejs',\n\t\t\tresize_notification: 'BuildApp.resize',\n\t\t\ttool: null   // the parent opsPortal Tool() object\n\t\t}, options);\n\t\tself.options = options;\n\n\t\t// Call parent init\n\t\tself._super(element, options);\n\n\t\tself.data = {};\n\n\t\tself.webixUiId = {\n\t\t\tloadingScreen: 'ab-loading-screen',\n\t\t\tsyncButton: 'ab-sync-button'\n\t\t};\n\n\t\tself.initDOM(function(){\n\t\t\tself.initWebixUI();\n\t\t});\n\n\n\t},\n\n\n\tinitDOM: function (cb) {\n\t\tvar _this = this;\n\n\t\tcan.view(this.options.templateDOM, {}, function(fragment){\n\t\t\t_this.element.html(fragment);\n\n\t\t\t// _this.element.find(\".ab-app-list\").show();\n\t\t\t// _this.element.find(\".ab-app-workspace\").hide();\n\n\t\t\tcb();\n\t\t});\n\t},\n\n\n\tinitWebixUI: function () {\n\n\t\t// get the AppBuilder (AB) Webix Component\n\t\tvar AppBuilder = OP.Component['ab']();\n\t\tvar ui = AppBuilder.ui;\n\n\t\t// tell the AppBuilder where to attach\n\t\tui.container = 'ab-main-container'\n\n\t\t// instantiate the UI first\n\t\tthis.AppBuilder = webix.ui(ui);\n\n\t\t// then perform the init()\n\t\tAppBuilder.init();\n\n\t},\n\n\n\tresize: function (height) {\n\t\tvar self = this;\n\n\t\theight = height.height || height;\n\n\t\tvar appListDom = $(self.element);\n\n\t\tif (appListDom) {\n\t\t\tvar width = appListDom.parent().css('width');\n\t\t\tif (width) {\n\t\t\t\twidth = parseInt(width.replace('px', ''));\n\t\t\t}\n\t\t\tappListDom.width(width);\n\n\t\t\t// Removed this because the 140 pixels was causing the list to not scroll to the bottom of the page\n\t\t\t// var computedHeight = height - 140;\n\n\t\t\tvar computedHeight = height;\n\t\t\tconsole.log(\"computed height: \" + computedHeight);\n\t\t\tvar mh = parseInt(appListDom.css('min-height').replace('px', ''));\n\t\t\tconsole.log(\"min-height: \" + mh);\n\t\t\tif (mh < computedHeight) {\n\t\t\t\tappListDom.height(computedHeight);\n\t\t\t\t$('#ab-main-container').height(computedHeight);\n\t\t\t} else {\n\t\t\t\tappListDom.height(mh);\n\t\t\t\t$('#ab-main-container').height(mh);\n\t\t\t}\n\n\t\t\tif (this.AppBuilder) {\n\t\t\t\t// this.AppBuilder.define('height', height - 140);\n\t\t\t\tthis.AppBuilder.adjust();\n\t\t\t}\n\n\t\t}\n\t}\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/AppBuilder.js","//\n// ABModel\n//\n// Represents the Data interface for an ABObject data.\n//\n// 2 ways to use an ABModel to load a DataTable:\n// \tMethod 1:  \n// \tgather all the data externally and send to the DataTable\n//\t\tModel.findAll()\n//\t\t.then((data)=>{\n//\t\t\tDataTable.parse(data);\n//\t\t})\n//\n// \tMethod 2: \n// \tSet the Model object with a condition / skip / limit, then \n// \tuse it to load the DataTable:\n//\t\tModel.where({})\n//\t\t.skip(XX)\n//\t\t.limit(XX)\n//\t\t.loadInto(DataTable);\n\n\n\nfunction toDC( data ) {\n\treturn new webix.DataCollection({\n\t\tdata: data,\n\n\t\t// on: {\n\t\t// \tonAfterDelete: function(id) {\n\n\t\t// \t}\n\t\t// }\n\t});\n}\n\n\nexport default class ABModel {\n\n    constructor(object) {\n\n\t  \t// link me to my parent ABApplication\n\t  \tthis.object = object;\n\n\t  \tthis._where = null;\n\t  \tthis._skip = null;\n\t  \tthis._limit = null;\n  \t}\n\n\n\n  \t///\n  \t/// Static Methods\n  \t///\n  \t/// Available to the Class level object.  These methods are not dependent\n  \t/// on the instance values of the Application.\n  \t///\n\n\n\n\t///\n\t/// Instance Methods\n\t///\n\tmodelURL () {\n\t\treturn '/app_builder/model/application/#appID#/object/#objID#'\n\t\t.replace('#appID#', this.object.application.id)\n\t\t.replace('#objID#', this.object.id)\n\t}\n\n\tmodelURLUpdate ( id ) {\n\t\treturn '/app_builder/model/application/#appID#/object/#objID#/#id#'\n\t\t.replace('#appID#', this.object.application.id)\n\t\t.replace('#objID#', this.object.id)\n\t\t.replace('#id#', id);\n\t}\n\n\n\t/**\n\t * @method findAll\n\t * performs a data find with the provided condition.\n\t */\n\tfindAll(cond) {\n\n\t\tcond = cond || {};\n\n\n\t\t// prepare our condition:\n\t\tvar newCond = {};\n\n\t\t// if the provided cond looks like our { where:{}, skip:xx, limit:xx } format,\n\t\t// just use this one.\n\t\tif (cond.where) {\n\t\t\tnewCond = cond;\n\t\t} else {\n\n\t\t\t// else, assume the provided condition is the .where clause.\n\t\t\tnewCond.where = cond;\n\t\t}\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\tOP.Comm.Service.get({\n\t\t\t\t\turl:this.modelURL(),\n\t\t\t\t\tparams:newCond\n\t\t\t\t})\n\t\t\t\t.then((data)=>{\n\n\t\t\t\t\t// if this object has some multilingual fields, translate the data:\n\t\t\t\t\tvar mlFields = this.object.multilingualFields();\n\t\t\t\t\tif (mlFields.length) {\n\n\t\t\t\t\t\tdata.data.forEach((d)=>{\n\t\t\t\t\t\t\tOP.Multilingual.translate(d,d, mlFields);\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(data);\n\t\t\t\t})\n\t\t\t\t.catch(reject);\n\n\t\t\t}\n\t\t)\n\n\t}\n\n\n\t/**\n\t * @method loadInto\n\t * loads the current values into the provided Webix DataTable\n\t * @param {DataTable} DT  A Webix component that can dynamically load data.\n\t */\n\tloadInto( DT ) {\n\t\t\n\t\t// if a limit was applied, then this component should be loading dynamically\n\t\tif (this._limit) {\n\n\t\t\tDT.define('datafetch', this._limit);\n\t\t\tDT.define('datathrottle',  250 );  // 250ms???\n\t\t\n\n\t\t\t// catch the event where data is requested:\n\t\t\t// here we will do our own findAll() so we can persist\n\t\t\t// the provided .where condition.\n\t\t\tDT.attachEvent(\"onDataRequest\", (start, count) => {\n\t\t\t\t\n\t\t\t\tvar cond = {\n\t\t\t\t\twhere:this._where,\n\t\t\t\t\tlimit:count,\n\t\t\t\t\tskip:start\n\t\t\t\t}\n\n\t\t\t\tthis.findAll(cond)\n\t\t\t\t.then((data) => {\n\t\t\t\t\tDT.parse(data);\n\t\t\t\t})\n\t\t\t  \n\t\t\t\treturn false;\t// <-- prevent the default \"onDataRequest\"\n\t\t\t});\n\n\n\t\t\tDT.refresh();\n\t\t}\n\n\n\t\t// else just load it all at once:\n\t\tvar cond = {};\n\t\tif (this._where) cond.where = this._where;\n\t\tif (this._limit != null) cond.limit = this._limit;\n\t\tif (this._skip  != null) cond.skip  = this._skip;\n\n\t\tthis.findAll(cond)\n\t\t.then((data)=>{\n\t\t\tDT.parse(data);\n\t\t})\n\t\t.catch((err)=>{\nconsole.error('!!!!!', err);\n\t\t})\n\n\n\t}\n\n\n\t/**\n\t * @method limit\n\t * set the limit value for this set of data\n\t * @param {integer} limit  the number or elements to return in this call\n\t * @return {ABModel} this object that is chainable.\n\t */\n\tlimit(limit) {\n\t\tthis._limit = limit;\n\t\treturn this;\n\t}\n\n\n\t/**\n\t * @method skip\n\t * set the skip value for this set of data\n\t * @param {integer} skip  the number or elements to skip\n\t * @return {ABModel} this object that is chainable.\n\t */\n\tskip(skip) {\n\t\tthis._skip = skip;\n\t\treturn this;\n\t}\n\n\n\n\n\t/**\n\t * @method update\n\t * update model values on the server.\n\t */\n\tupdate(id, values) {\n\n// if this object has some multilingual fields, translate the data:\n\t\tvar mlFields = this.object.multilingualFields();\n\t\tif (mlFields.length) {\n\t\t\tif (values.translations) {\n\t\t\t\tOP.Multilingual.unTranslate(values, values, mlFields);\n\t\t\t}\n\t\t}\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\tOP.Comm.Service.put({\n\t\t\t\t\turl:this.modelURLUpdate( id ),\n\t\t\t\t\tparams:values\n\t\t\t\t})\n\t\t\t\t.then((data)=>{\n\n\t\t\t\t\tresolve(data);\n\t\t\t\t})\n\t\t\t\t.catch(reject);\n\n\t\t\t}\n\t\t)\n\n\t}\n\n\n\t/**\n\t * @method where\n\t * set the where condition for the data being loaded.\n\t * @param {json} cond  the json condition statement.\n\t * @return {ABModel} this object that is chainable.\n\t */\n\twhere(cond) {\n\t\tthis._where = cond;\n\t\treturn this;\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/ABModel.js","\n// import OP from \"OP\"\nimport ABFieldManager from \"./ABFieldManager\"\nimport ABModel from \"./ABModel\"\n\n\nfunction toDC( data ) {\n\treturn new webix.DataCollection({\n\t\tdata: data,\n\n\t\t// on: {\n\t\t// \tonAfterDelete: function(id) {\n\n\t\t// \t}\n\t\t// }\n\t});\n}\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\nexport default class ABObject {\n\n    constructor(attributes, application) {\n/*\n{\n\tid: uuid(),\n\tname: 'name',\n\tlabelFormat: 'xxxxx',\n\tisImported: 1/0,\n\turlPath:'string',\n\timportFromObject: 'string', // JSON Schema style reference:  '#[ABApplication.id]/objects/[ABObject.id]'\n\t\t\t\t\t\t\t\t// to get other object:  ABApplication.objectFromRef(obj.importFromObject);\n\ttranslations:[\n\t\t{}\n\t],\n\tfields:[\n\t\t{ABDataField}\n\t]\n}\n*/\n\n    \t// ABApplication Attributes\n    \tthis.id    = attributes.id;\n    \tthis.name  = attributes.name || \"\";\n    \tthis.labelFormat = attributes.labelFormat || \"\";\n    \tthis.isImported  = attributes.isImported  || 0;\n    \tthis.urlPath\t = attributes.urlPath     || \"\";\n    \tthis.importFromObject = attributes.importFromObject || \"\";\n    \tthis.translations = attributes.translations;\n\n\t\tif (typeof(attributes.objectWorkspace) != \"undefined\") {\n\t\t\tif (typeof(attributes.objectWorkspace.sortFields) == \"undefined\") attributes.objectWorkspace.sortFields = [];\n\t\t\tif (typeof(attributes.objectWorkspace.frozenColumnID) == \"undefined\") attributes.objectWorkspace.frozenColumnID = \"\";\n\t\t\tif (typeof(attributes.objectWorkspace.hiddenFields) == \"undefined\") attributes.objectWorkspace.hiddenFields = [];\n\t\t}\n\n    \tthis.objectWorkspace = attributes.objectWorkspace || {\n\t\t\tsortFields:[], // array of columns with their sort configurations\n\t\t\tfrozenColumnID:\"\", // id of column you want to stop freezing\n    \t\thiddenFields:[], // array of [ids] to add hidden:true to\n    \t};\n\n    \t// multilingual fields: label, description\n    \tOP.Multilingual.translate(this, this, ['label']);\n\n\n\t  \t// import all our ABObjects\n\t  \tvar newFields = [];\n\t  \t(attributes.fields || []).forEach((field) => {\n\t  \t\tnewFields.push( this.fieldNew(field) );\n\t  \t})\n\t  \tthis._fields = newFields;\n\n\n\t  \t// link me to my parent ABApplication\n\t  \tthis.application = application;\n  \t}\n\n\n\n  \t///\n  \t/// Static Methods\n  \t///\n  \t/// Available to the Class level object.  These methods are not dependent\n  \t/// on the instance values of the Application.\n  \t///\n\n\n\n//// TODO: Refactor isValid() to ignore op and not error if duplicateName is own .id\n\n\tisValid() {\n\n\t\tvar validator = OP.Validation.validator();\n\n\n\t\t// label/name must be unique:\n\t\tvar isNameUnique = (this.application.objects((o) => { return o.name.toLowerCase() == this.name.toLowerCase(); }).length == 0);\n\t\tif (!isNameUnique) {\n\t\t\tvalidator.addError('name', L('ab.validation.object.name.unique', 'Object name must be unique (#name# already used in this Application)').replace('#name#', this.name) );\n// errors = OP.Form.validationError({\n// \t\tname:'name',\n// \t\tmessage:L('ab.validation.object.name.unique', 'Object name must be unique (#name# already used in this Application)').replace('#name#', this.name),\n// \t}, errors);\n\t\t}\n\n\n\t\t\t// Check the common validations:\n// TODO:\n// if (!inputValidator.validate(values.label)) {\n// \t_logic.buttonSaveEnable();\n// \treturn false;\n// }\n\n\t\treturn validator;\n\t}\n\n\n\n\t///\n\t/// Instance Methods\n\t///\n\n\n\t/// ABApplication data methods\n\n\n\t/**\n\t * @method destroy()\n\t *\n\t * destroy the current instance of ABApplication\n\t *\n\t * also remove it from our _AllApplications\n\t *\n\t * @return {Promise}\n\t */\n\tdestroy () {\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\t// OK, some of our Fields have special follow up actions that need to be\n\t\t\t\t// considered when they no longer exist, so before we simply drop this\n\t\t\t\t// object/table, drop each of our fields and give them a chance to clean up\n\t\t\t\t// what needs cleaning up.\n\n\t\t\t\t// ==> More work, but safer.\n\t\t\t\tvar fieldDrops = [];\n\t\t\t\tthis.fields().forEach((f)=>{\n\t\t\t\t\tfieldDrops.push(f.destroy());\n\t\t\t\t})\n\n\t\t\t\tPromise.all(fieldDrops)\n\t\t\t\t.then(()=>{\n\n\t\t\t\t\t// now drop our table\n\t\t\t\t\t// NOTE: our .migrateXXX() routines expect the object to currently exist\n\t\t\t\t\t// in the DB before we perform the DB operations.  So we need to\n\t\t\t\t\t// .migrateDrop()  before we actually .objectDestroy() this.\n\t\t\t\t\tthis.migrateDrop()\n\t\t\t\t\t.then(()=>{\n\n\t\t\t\t\t\t// finally remove us from the application storage\n\t\t\t\t\t\treturn this.application.objectDestroy(this);\n\n\t\t\t\t\t})\n\t\t\t\t\t.then(resolve)\n\t\t\t\t\t.catch(reject);\n\n\t\t\t\t})\n\t\t\t\t.catch(reject);\n\n\t\t\t}\n\t\t);\n\t}\n\n\n\t/**\n\t * @method save()\n\t *\n\t * persist this instance of ABObject with it's parent ABApplication\n\t *\n\t *\n\t * @return {Promise}\n\t *\t\t\t\t\t\t.resolve( {this} )\n\t */\n\tsave () {\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\tvar isAdd = false;\n\n\t\t\t\t// if this is our initial save()\n\t\t\t\tif (!this.id) {\n\n\t\t\t\t\tthis.id = OP.Util.uuid();\t// setup default .id\n\t\t\t\t\tthis.label = this.label || this.name;\n\t\t\t\t\tthis.urlPath = this.urlPath || this.application.name + '/' + this.name;\n\t\t\t\t\tisAdd = true;\n\t\t\t\t}\n\n\t\t\t\tthis.application.objectSave(this)\n\t\t\t\t.then(() => {\n\n\t\t\t\t\tif (isAdd) {\n\n\t\t\t\t\t\t// on a Create: trigger a migrateCreate object\n\t\t\t\t\t\tthis.migrateCreate()\n\t\t\t\t\t\t.then(()=>{\n\t\t\t\t\t\t\tresolve(this);\n\t\t\t\t\t\t}, reject);\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(this);\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t\t.catch(function(err){\n\t\t\t\t\treject(err);\n\t\t\t\t})\n\t\t\t}\n\t\t)\n\t}\n\n\n\t/**\n\t * @method toObj()\n\t *\n\t * properly compile the current state of this ABApplication instance\n\t * into the values needed for saving to the DB.\n\t *\n\t * Most of the instance data is stored in .json field, so be sure to\n\t * update that from all the current values of our child fields.\n\t *\n\t * @return {json}\n\t */\n\ttoObj () {\n\n\t\tOP.Multilingual.unTranslate(this, this, [\"label\"]);\n\n\t\t// // for each Object: compile to json\n\t\tvar currFields = [];\n\t\tthis._fields.forEach((obj) => {\n\t\t\tcurrFields.push(obj.toObj())\n\t\t})\n\n\n\t\treturn {\n\t\t\tid: \t\t\tthis.id,\n\t\t\tname: \t\t\tthis.name,\n    \t\tlabelFormat: \tthis.labelFormat,\n    \t\tisImported:  \tthis.isImported,\n    \t\turlPath: \t\tthis.urlPath,\n    \t\timportFromObject: this.importFromObject,\n    \t\tobjectWorkspace:  this.objectWorkspace,\n    \t\ttranslations: \tthis.translations,\n    \t\tfields: \t \tcurrFields\n\t\t}\n\t}\n\n\n\n\n\t///\n\t/// DB Migrations\n\t///\n\n\tmigrateCreate() {\n\t\tvar url = '/app_builder/migrate/application/#appID#/object/#objID#'\n\t\t\t.replace('#appID#', this.application.id)\n\t\t\t.replace('#objID#', this.id);\n\n\t\treturn OP.Comm.Service.post({\n\t\t\turl: url\n\t\t})\n\t}\n\n\n\tmigrateDrop() {\n\t\tvar url = '/app_builder/migrate/application/#appID#/object/#objID#'\n\t\t\t.replace('#appID#', this.application.id)\n\t\t\t.replace('#objID#', this.id);\n\n\t\treturn OP.Comm.Service['delete']({\n\t\t\turl: url\n\t\t})\n\t}\n\n\n\t///\n\t/// Fields\n\t///\n\n\n\n\n\t/**\n\t * @method fields()\n\t *\n\t * return an array of all the ABFields for this ABObject.\n\t *\n\t * @return {array}\n\t */\n\tfields (filter) {\n\n\t\tfilter = filter || function() {return true; };\n\n\t\treturn this._fields.filter(filter);\n\t}\n\n\n\n\t/**\n\t * @method fieldNew()\n\t *\n\t * return an instance of a new (unsaved) ABField that is tied to this\n\t * ABObject.\n\t *\n\t * NOTE: this new field is not included in our this.fields until a .save()\n\t * is performed on the field.\n\t *\n\t * @return {ABField}\n\t */\n\tfieldNew ( values ) {\n\t\t// NOTE: ABFieldManager returns the proper ABFieldXXXX instance.\n\t\treturn ABFieldManager.newField( values, this );\n\t}\n\n\n\n\t/**\n\t * @method fieldRemove()\n\t *\n\t * remove the given ABField from our ._fields array and persist the current\n\t * values.\n\t *\n\t * @param {ABField} field The instance of the field to remove.\n\t * @return {Promise}\n\t */\n\tfieldRemove( field ) {\n\t\tthis._fields = this.fields(function(o){ return o.id != field.id });\n\n\t\treturn this.save();\n\t}\n\n\n\n\t/**\n\t * @method fieldSave()\n\t *\n\t * save the given ABField in our ._fields array and persist the current\n\t * values.\n\t *\n\t * @param {ABField} field The instance of the field to save.\n\t * @return {Promise}\n\t */\n\tfieldSave( field ) {\n\t\tvar isIncluded = (this.fields(function(o){ return o.id == field.id }).length > 0);\n\t\tif (!isIncluded) {\n\t\t\tthis._fields.push(field);\n\t\t}\n\n\t\treturn this.save();\n\t}\n\n\n\tmultilingualFields() {\n\t\tvar fields = [];\n\n\t\tvar found = this.fields(function(f){ return f.isMultilingual(); });\n\t\tfound.forEach((f)=>{\n\t\t\tfields.push(f.columnName);\n\t\t})\n\n\t\treturn fields;\n\t}\n\n\n\t///\n\t///\tObject Workspace Settings\n\t///\n\tget workspaceSortFields() {\n\t\treturn this.objectWorkspace.sortFields;\n\t}\n\n\tset workspaceSortFields( fields ) {\n\t\tthis.objectWorkspace.sortFields = fields;\n\t}\n\n\tget workspaceFrozenColumnID() {\n\t\treturn this.objectWorkspace.frozenColumnID;\n\t}\n\n\tset workspaceFrozenColumnID( id ) {\n\t\tthis.objectWorkspace.frozenColumnID = id;\n\t}\n\n\tget workspaceHiddenFields() {\n\t\treturn this.objectWorkspace.hiddenFields;\n\t}\n\n\tset workspaceHiddenFields( fields ) {\n\t\tthis.objectWorkspace.hiddenFields = fields;\n\t}\n\n\n\n\n\n\t///\n\t/// Working with Client Components:\n\t///\n\n\n\t// return the column headers for this object\n\t// @param {bool} isObjectWorkspace  return the settings saved for the object workspace\n\tcolumnHeaders (isObjectWorkspace) {\n\n\t\tvar headers = [];\n\t\tvar columnNameLookup = {};\n\n\t\t// get the header for each of our fields:\n\t\tthis._fields.forEach(function(f){\n\t\t\tvar header = f.columnHeader(isObjectWorkspace);\n\t\t\theaders.push(header);\n\t\t\tcolumnNameLookup[header.id] = f.columnName;\t// name => id\n\t\t})\n\n\n\t\t// update our headers with any settings applied in the Object Workspace\n\t\tif (isObjectWorkspace) {\n\n\t\t\t// set column width to adjust:true by default;\n\t\t\theaders.forEach((h) => { h.adjust = true; });\n\n\t\t\t// hide any hiddenfields\n\t\t\tif (this.workspaceHiddenFields.length > 0) {\n\t\t\t\tthis.workspaceHiddenFields.forEach((hfID)=>{\n\t\t\t\t\theaders.forEach((h)=> {\n\t\t\t\t\t\tif (columnNameLookup[h.id] == hfID){\n\t\t\t\t\t\t\th.hidden = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn headers;\n\t}\n\n\n\n\t// after a component has rendered, tell each of our fields to perform\n\t// any custom display operations\n\t// @param {Webix.DataStore} data a webix datastore of all the rows effected\n\t//        by the render.\n\tcustomDisplays(data, App, DataTable) {\n\t\tvar fields = this.fields();\n\n\t\tvar id = data.getFirstId();\n\t\twhile(id) {\n\t\t\tvar row = data.getItem(id);\n\t\t\tfields.forEach((f)=>{\n\t\t\t\tif (this.objectWorkspace.hiddenFields.indexOf(f.columnName) == -1) {\n\t\t\t\t\tvar node = DataTable.getItemNode({ row: row.id, column: f.columnName });\n\t\t\t\t\tf.customDisplay(row, App, node);\n\t\t\t\t}\n\t\t\t})\n\t\t\tid = data.getNextId(id);\n\t\t}\n\t}\n\n\n\n\t/**\n\t * @method isValidData\n\t * Parse through the given data and return an array of any invalid\n\t * value errors.\n\t * @param {obj} data a key=>value hash of the inputs to parse.\n\t * @return {array}\n\t */\n\tisValidData(data) {\n\t\tvar validator = OP.Validation.validator();\n\t\tthis.fields().forEach((f) => {\n\t\t\tvar p = f.isValidData(data, validator);\n\t\t})\n\n\t\treturn validator;\n\t}\n\n\n\t///\n\t/// Working with data from server\n\t///\n\n\t/**\n\t * @method model\n\t * return a Model object that will allow you to interact with the data for\n\t * this ABObject.\n\t */\n\tmodel() {\n\t\treturn new ABModel(this);\n\t}\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/ABObject.js","/*\n * ABFieldBoolean\n *\n * An ABFieldBoolean defines a boolean field type.\n *\n */\n\nimport ABField from \"./ABField\"\nimport ABFieldComponent from \"./ABFieldComponent\"\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar ABFieldBooleanDefaults = {\n\tkey: 'boolean', // unique key to reference this specific DataField\n\n\ticon: 'check-square-o',   // font-awesome icon reference.  (without the 'fa-').  so 'user'  to reference 'fa-user'\n\n\t// menuName: what gets displayed in the Editor drop list\n\tmenuName: L('ab.dataField.boolean.menuName', '*Checkbox'),\n\n\t// description: what gets displayed in the Editor description.\n\tdescription: L('ab.dataField.boolean.description', '*A single checkbox that can be checked or unchecked.')\n}\n\n\nvar defaultValues = {\n\tdefault: 0\n}\n\n/**\n * ABFieldBooleanComponent\n *\n * Defines the UI Component for this Data Field.  The ui component is responsible\n * for displaying the properties editor, populating existing data, retrieving\n * property values, etc.\n */\nvar ABFieldBooleanComponent = new ABFieldComponent({\n\tfieldDefaults: ABFieldBooleanDefaults,\n\n\telements: (App, field) => {\n\t\t// ids = field.idsUnique(ids, App);\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tname: \"default\",\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tlabel: \"Default\",\n\t\t\t\tlabelPosition: \"left\",\n\t\t\t\tlabelWidth: 70,\n\t\t\t\tlabelRight: 'Uncheck',\n\t\t\t\tcss: \"webix_table_checkbox\",\n\t\t\t\ton: {\n\t\t\t\t\tonChange: function (newVal, oldVal) {\n\t\t\t\t\t\tthis.define('labelRight', newVal ? 'Check' : 'Uncheck');\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\n\t// defaultValues: the keys must match a .name of your elements to set it's default value.\n\tdefaultValues: defaultValues,\n\n\t// rules: basic form validation rules for webix form entry.\n\t// the keys must match a .name of your .elements for it to apply\n\trules: {},\n\n\t// include additional behavior on default component operations here:\n\t// The base routines will be processed first, then these.  Any results\n\t// from the base routine, will be passed on to these:\n\tlogic: {\n\n\t\t// isValid: function (ids, isValid) {\n\n\t\t// }\n\n\t\t// populate: function (ids, values) {\n\t\t// \tif (values.settings.validation) {\n\t\t// \t\t$$(ids.validateMinimum).enable();\n\t\t// \t\t$$(ids.validateMaximum).enable();\n\t\t// \t} else {\n\t\t// \t\t$$(ids.validateMinimum).disable();\n\t\t// \t\t$$(ids.validateMaximum).disable();\n\t\t// \t}\n\t\t// }\n\n\t},\n\n\t// perform any additional setup actions here.\n\t// @param {obj} ids  the hash of id values for all the current form elements.\n\t//\t\t\t\t\t it should have your elements + the default Header elements:\n\t//\t\t\t\t\t\t.label, .columnName, .fieldDescription, .showIcon\n\tinit: function (ids) {\n\t}\n\n\n});\n\n\nclass ABFieldBoolean extends ABField {\n\tconstructor(values, object) {\n\t\tsuper(values, object, ABFieldBooleanDefaults);\n\n\t\t// we're responsible for setting up our specific settings:\n\t\tfor (var dv in defaultValues) {\n\t\t\tthis.settings[dv] = values.settings[dv] || defaultValues[dv];\n\t\t}\n\n\t\tif (this.settings.default != null)\n\t\t\tthis.settings.default = parseInt(this.settings.default);\n\t}\n\n\t// return the default values for this DataField\n\tstatic defaults() {\n\t\treturn ABFieldBooleanDefaults;\n\t}\n\n\t/*\n\t* @function propertiesComponent\n\t*\n\t* return a UI Component that contains the property definitions for this Field.\n\t*\n\t* @param {App} App the UI App instance passed around the Components.\n\t* @return {Component}\n\t*/\n\tstatic propertiesComponent(App) {\n\t\treturn ABFieldBooleanComponent.component(App);\n\t}\n\n\t///\n\t/// Instance Methods\n\t///\n\n\n\tisValid() {\n\n\t\tvar validator = super.isValid();\n\n\t\t// validator.addError('columnName', L('ab.validation.object.name.unique', 'Field columnName must be unique (#name# already used in this Application)').replace('#name#', this.name) );\n\n\t\treturn validator;\n\t}\n\n\n\t/**\n\t * @method toObj()\n\t *\n\t * properly compile the current state of this ABApplication instance\n\t * into the values needed for saving to the DB.\n\t *\n\t * Most of the instance data is stored in .json field, so be sure to\n\t * update that from all the current values of our child fields.\n\t *\n\t * @return {json}\n\t */\n\t// toObj () {\n\n\t// \tvar obj = super.toObj();\n\n\t// \t// obj.settings = this.settings;  // <--  super.toObj()\n\n\t// \treturn obj;\n\t// }\n\n\n\n\n\t///\n\t/// Working with Actual Object Values:\n\t///\n\n\t// return the grid column header definition for this instance of ABFieldBoolean\n\tcolumnHeader(isObjectWorkspace) {\n\t\tvar config = super.columnHeader(isObjectWorkspace);\n\n\t\tconfig.editor = 'template';\n\t\tconfig.template = '<div class=\"ab-boolean-display\">{common.checkbox()}</div>';\n\t\tconfig.css = 'center';\n\t\t// config.sort = 'string';\n\n\t\treturn config;\n\t}\n\n\n\n\t/**\n\t * @method isValidData\n\t * Parse through the given data and return an error if this field's\n\t * data seems invalid.\n\t * @param {obj} data  a key=>value hash of the inputs to parse.\n\t * @param {OPValidator} validator  provided Validator fn\n\t * @return {array} \n\t */\n\tisValidData(data, validator) {\n\t}\n\n}\n\n\nexport default ABFieldBoolean;\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/dataFields/ABFieldBoolean.js","/*\n * ABFieldDate\n *\n * An ABFieldDate defines a date/datetime field type.\n *\n */\n\nimport ABField from \"./ABField\"\nimport ABFieldComponent from \"./ABFieldComponent\"\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\n\nvar ABFieldDateDefaults = {\n\tkey: 'date', // unique key to reference this specific DataField\n\n\ticon: 'calendar',   // font-awesome icon reference.  (without the 'fa-').  so 'user'  to reference 'fa-user'\n\n\t// menuName: what gets displayed in the Editor drop list\n\tmenuName: L('ab.dataField.date.menuName', '*Date'),\n\n\t// description: what gets displayed in the Editor description.\n\tdescription: L('ab.dataField.date.description', '*Pick one from a calendar.')\n}\n\nvar defaultValues = {\n\tincludeTime: 0,\n\tdefaultCurrentDate: 0,\n\tdefaultDate: \"\",\n\tdayFormat: \"DD\",\n\tdayOrder: 1,\n\tdayDelimiter: \"slash\",\n\tmonthFormat: \"MM\",\n\tmonthOrder: 2,\n\tmonthDelimiter: \"slash\",\n\tyearFormat: \"YYYY\",\n\tyearOrder: 3,\n\tyearDelimiter: \"slash\",\n\n\tvalidateCondition: \"none\",\n\tvalidateRangeUnit: \"days\",\n\tvalidateRangeBefore: 0,\n\tvalidateRangeAfter: 0,\n\tvalidateStartDate: null,\n\tvalidateEndDate: null\n}\n\nvar ids = {\n\tdefault: 'ab-date-default',\n\tcurrentToDefault: 'ab-date-current-to-default',\n\n\tdateDisplay: 'ab-date-display',\n\n\tdayOrder: 'ab-date-day-order',\n\tmonthOrder: 'ab-date-month-order',\n\tyearOrder: 'ab-date-year-order',\n\tdayFormat: 'ab-date-day-format',\n\tmonthFormat: 'ab-date-month-format',\n\tyearFormat: 'ab-date-year-format',\n\tdayDelimiter: 'ab-date-day-delimiter',\n\tmonthDelimiter: 'ab-date-month-delimiter',\n\tyearDelimiter: 'ab-date-year-delimiter',\n\n\t// validation\n\tvalidateCondition: 'ab-date-validate-condition',\n\tvalidateRange: 'ab-date-validate-range',\n\tvalidateRangeUnit: 'ab-date-validate-range-unit',\n\tvalidateRangeBefore: 'ab-date-validate-range-before',\n\tvalidateRangeAfter: 'ab-date-validate-range-after',\n\tvalidateRangeBeforeLabel: 'ab-date-validate-before-label',\n\tvalidateRangeAfterLabel: 'ab-date-validate-after-label',\n\n\tvalidateLeft: 'ab-date-validate-left',\n\tvalidateRight: 'ab-date-validate-right'\n};\n\nvar delimiterList = [\n\t{ id: 'comma', value: \"Comma\", sign: \",\" },\n\t{ id: 'slash', value: \"Slash\", sign: \"/\" },\n\t{ id: 'space', value: \"Space\", sign: \" \" },\n\t{ id: 'dash', value: \"Dash\", sign: \"-\" }\n];\n\n\n/** Private methods **/\nfunction getDelimiterSign(text) {\n\tvar delimiterItem = delimiterList.filter(function (item) {\n\t\treturn item.id == text;\n\t})[0];\n\n\treturn delimiterItem ? delimiterItem.sign : null;\n}\n\nfunction getDateFormat(setting) {\n\tvar momentFormat = \"\";\n\n\tfor (var i = 1; i <= 3; i++) {\n\t\tif (setting.dayOrder == i) {\n\t\t\tmomentFormat += setting.dayFormat;\n\t\t\tmomentFormat += (i != 3) ? setting.dayDelimiter : '';\n\t\t}\n\t\tif (setting.monthOrder == i) {\n\t\t\tmomentFormat += setting.monthFormat;\n\t\t\tmomentFormat += (i != 3) ? setting.monthDelimiter : '';\n\t\t}\n\t\tif (setting.yearOrder == i) {\n\t\t\tmomentFormat += setting.yearFormat;\n\t\t\tmomentFormat += (i != 3) ? setting.yearDelimiter : '';\n\t\t}\n\t}\n\n\treturn moment(new Date()).format(momentFormat);\n}\n\nfunction refreshDateDisplay() {\n\tvar dateFormat = getDateFormat({\n\t\tdayOrder: $$(ids.dayOrder).getValue(),\n\t\tmonthOrder: $$(ids.monthOrder).getValue(),\n\t\tyearOrder: $$(ids.yearOrder).getValue(),\n\t\tdayFormat: $$(ids.dayFormat).getValue(),\n\t\tmonthFormat: $$(ids.monthFormat).getValue(),\n\t\tyearFormat: $$(ids.yearFormat).getValue(),\n\t\tdayDelimiter: getDelimiterSign($$(ids.dayDelimiter).getValue()),\n\t\tmonthDelimiter: getDelimiterSign($$(ids.monthDelimiter).getValue()),\n\t\tyearDelimiter: getDelimiterSign($$(ids.yearDelimiter).getValue()),\n\t});\n\n\t$$(ids.dateDisplay).setValue(dateFormat);\n}\n\n\n/**\n * ABFieldDateComponent\n *\n * Defines the UI Component for this Data Field.  The ui component is responsible\n * for displaying the properties editor, populating existing data, retrieving\n * property values, etc.\n */\nvar ABFieldDateComponent = new ABFieldComponent({\n\tfieldDefaults: ABFieldDateDefaults,\n\n\telements: (App, field) => {\n\t\tids = field.idsUnique(ids, App);\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname: \"includeTime\",\n\t\t\t\tlabelRight: \"Include time\",\n\t\t\t\tlabelWidth: 0,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: function (newVal, oldVal) {\n\t\t\t\t\t\t// Re-render default date picker\n\t\t\t\t\t\twebix.ui({\n\t\t\t\t\t\t\tview: 'datepicker',\n\t\t\t\t\t\t\tlabel: \"Default\",\n\t\t\t\t\t\t\tid: ids.default,\n\t\t\t\t\t\t\ttimepicker: newVal ? true : false,\n\t\t\t\t\t\t\tdisabled: $$(ids.currentToDefault).getValue() == true\n\t\t\t\t\t\t}, $$(ids.default));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: 'checkbox',\n\t\t\t\tid: ids.currentToDefault,\n\t\t\t\tname: \"defaultCurrentDate\",\n\t\t\t\tlabelRight: 'Set current date to default value',\n\t\t\t\tlabelWidth: 0,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: function (newVal, oldVal) {\n\t\t\t\t\t\tif (newVal) {\n\t\t\t\t\t\t\t$$(ids.default).disable();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t$$(ids.default).enable();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: 'datepicker',\n\t\t\t\tid: ids.default,\n\t\t\t\tlabel: \"Default\",\n\t\t\t\tname: 'defaultDate',\n\t\t\t\ttimepicker: false\n\t\t\t},\n\t\t\t{\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: 'label',\n\t\t\t\t\t\tlabel: 'Display',\n\t\t\t\t\t\tcss: 'ab-text-bold'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: 'label',\n\t\t\t\t\t\tid: ids.dateDisplay,\n\t\t\t\t\t\tlabel: ''\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\n\t\t\t// Display date format\n\t\t\t{\n\t\t\t\tview: \"accordion\",\n\t\t\t\tmulti: false,\n\t\t\t\tcollapsed: true,\n\t\t\t\trows: [\n\t\t\t\t\t// Day format\n\t\t\t\t\t{\n\t\t\t\t\t\theader: \"Day\",\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\tname: \"dayFormat\",\n\t\t\t\t\t\t\t\t\tid: ids.dayFormat,\n\t\t\t\t\t\t\t\t\tlabel: \"Format\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvalue: 'D',\n\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t{ id: 'D', value: \"1 2 ... 30 31\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'Do', value: \"1st 2nd ... 30th 31st\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'DD', value: \"01 02 ... 30 31\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'dd', value: \"Su Mo ... Fr Sa\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'ddd', value: \"Sun Mon ... Fri Sat\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'dddd', value: \"Sunday Monday ... Friday Saturday\" },\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\tname: \"dayOrder\",\n\t\t\t\t\t\t\t\t\tid: ids.dayOrder,\n\t\t\t\t\t\t\t\t\tlabel: \"Places\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvalue: '1',\n\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t{ id: 1, value: \"1\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 2, value: \"2\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 3, value: \"3\" }\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\t\t\tname: \"dayDelimiter\",\n\t\t\t\t\t\t\t\t\tid: ids.dayDelimiter,\n\t\t\t\t\t\t\t\t\tlabel: \"Delimiter\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\t\t\t\toptions: delimiterList,\n\t\t\t\t\t\t\t\t\tvalue: 'slash',\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\n\t\t\t\t\t// Month format\n\t\t\t\t\t{\n\t\t\t\t\t\theader: \"Month\",\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\tname: \"monthFormat\",\n\t\t\t\t\t\t\t\t\tid: ids.monthFormat,\n\t\t\t\t\t\t\t\t\tlabel: \"Format\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvalue: 'MM',\n\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t{ id: 'M', value: \"1 2 ... 11 12\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'Mo', value: \"1st 2nd ... 11th 12th\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'MM', value: \"01 02 ... 11 12\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'MMM', value: \"Jan Feb ... Nov Dec\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'MMMM', value: \"January February ... November December\" }\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\tname: \"monthOrder\",\n\t\t\t\t\t\t\t\t\tid: ids.monthOrder,\n\t\t\t\t\t\t\t\t\tlabel: \"Places\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvalue: '2',\n\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t{ id: 1, value: \"1\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 2, value: \"2\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 3, value: \"3\" },\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\t\t\tname: \"monthDelimiter\",\n\t\t\t\t\t\t\t\t\tid: ids.monthDelimiter,\n\t\t\t\t\t\t\t\t\tlabel: \"Delimiter\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\t\t\t\toptions: delimiterList,\n\t\t\t\t\t\t\t\t\tvalue: 'slash',\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\n\t\t\t\t\t// Year format\n\t\t\t\t\t{\n\t\t\t\t\t\theader: \"Year\",\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\tname: \"yearFormat\",\n\t\t\t\t\t\t\t\t\tid: ids.yearFormat,\n\t\t\t\t\t\t\t\t\tlabel: \"Format\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvalue: 'YYYY',\n\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t{ id: 'YY', value: \"70 71 ... 29 30\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 'YYYY', value: \"1970 1971 ... 2029 2030\" },\n\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\t\t\t\t\tname: \"yearOrder\",\n\t\t\t\t\t\t\t\t\tid: ids.yearOrder,\n\t\t\t\t\t\t\t\t\tlabel: \"Places\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvalue: '3',\n\t\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t\t{ id: 1, value: \"1\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 2, value: \"2\" },\n\t\t\t\t\t\t\t\t\t\t{ id: 3, value: \"3\" },\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tview: \"radio\",\n\t\t\t\t\t\t\t\t\tname: \"yearDelimiter\",\n\t\t\t\t\t\t\t\t\tid: ids.yearDelimiter,\n\t\t\t\t\t\t\t\t\tlabel: \"Delimiter\",\n\t\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\t\tvertical: true,\n\t\t\t\t\t\t\t\t\toptions: delimiterList,\n\t\t\t\t\t\t\t\t\tvalue: 'slash',\n\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t\trefreshDateDisplay();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t]\n\t\t\t},\n\n\t\t\t// Validator\n\t\t\t{\n\t\t\t\tview: 'label',\n\t\t\t\tlabel: \"Validation criteria\",\n\t\t\t\tcss: 'ab-text-bold'\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: ids.validateCondition,\n\t\t\t\tview: \"select\",\n\t\t\t\tname: \"validateCondition\",\n\t\t\t\tlabel: \"Condition\",\n\t\t\t\tlabelWidth: 100,\n\t\t\t\tvalue: 'none',\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: 'none', value: '[None]' },\n\t\t\t\t\t{ id: 'dateRange', value: 'Range' },\n\t\t\t\t\t{ id: 'between', value: 'Between' },\n\t\t\t\t\t{ id: 'notBetween', value: 'Not between' },\n\t\t\t\t\t{ id: '=', value: 'Equal to' },\n\t\t\t\t\t{ id: '<>', value: 'Not equal to' },\n\t\t\t\t\t{ id: '>', value: 'Greater than' },\n\t\t\t\t\t{ id: '<', value: 'Less than' },\n\t\t\t\t\t{ id: '>=', value: 'Greater than or Equal to' },\n\t\t\t\t\t{ id: '<=', value: 'Less than or Equal to' }\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\tonChange: function (newVal, oldVal) {\n\t\t\t\t\t\tswitch (newVal) {\n\t\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\t\t$$(ids.validateRange).hide();\n\t\t\t\t\t\t\t\t$$(ids.validateLeft).hide();\n\t\t\t\t\t\t\t\t$$(ids.validateRight).hide();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'dateRange':\n\t\t\t\t\t\t\t\t$$(ids.validateRange).show();\n\t\t\t\t\t\t\t\t$$(ids.validateLeft).hide();\n\t\t\t\t\t\t\t\t$$(ids.validateRight).hide();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'between':\n\t\t\t\t\t\t\tcase 'notBetween':\n\t\t\t\t\t\t\t\t$$(ids.validateRange).hide();\n\t\t\t\t\t\t\t\t$$(ids.validateLeft).define('label', 'Start Date');\n\t\t\t\t\t\t\t\t$$(ids.validateLeft).refresh();\n\t\t\t\t\t\t\t\t$$(ids.validateLeft).show();\n\t\t\t\t\t\t\t\t$$(ids.validateRight).show();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase '=':\n\t\t\t\t\t\t\tcase '<>':\n\t\t\t\t\t\t\tcase '>':\n\t\t\t\t\t\t\tcase '<':\n\t\t\t\t\t\t\tcase '>=':\n\t\t\t\t\t\t\tcase '<=':\n\t\t\t\t\t\t\t\t$$(ids.validateRange).hide();\n\t\t\t\t\t\t\t\t$$(ids.validateLeft).define('label', 'Date');\n\t\t\t\t\t\t\t\t$$(ids.validateLeft).refresh();\n\t\t\t\t\t\t\t\t$$(ids.validateLeft).show();\n\t\t\t\t\t\t\t\t$$(ids.validateRight).hide();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: ids.validateRange,\n\t\t\t\thidden: true,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ids.validateRangeUnit,\n\t\t\t\t\t\tview: \"select\",\n\t\t\t\t\t\tname: \"validateRangeUnit\",\n\t\t\t\t\t\tlabel: 'Unit',\n\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{ id: 'days', value: 'Days' },\n\t\t\t\t\t\t\t{ id: 'months', value: 'Months' },\n\t\t\t\t\t\t\t{ id: 'years', value: 'Years' }\n\t\t\t\t\t\t],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function (newVal) {\n\t\t\t\t\t\t\t\t$$(ids.validateRangeBeforeLabel).refresh();\n\t\t\t\t\t\t\t\t$$(ids.validateRangeAfterLabel).refresh();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: ids.validateRangeBeforeLabel,\n\t\t\t\t\t\t\t\tview: 'template',\n\t\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\t\twidth: 140,\n\t\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\t\ttemplate: function () {\n\t\t\t\t\t\t\t\t\tvar beforeLabel = 'Before #number# #unit#'\n\t\t\t\t\t\t\t\t\t\t.replace('#number#', $$(ids.validateRangeBefore).getValue())\n\t\t\t\t\t\t\t\t\t\t.replace('#unit#', $$(ids.validateRangeUnit).getValue());\n\n\t\t\t\t\t\t\t\t\treturn beforeLabel;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: 'label',\n\t\t\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\t\twidth: 1\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: ids.validateRangeAfterLabel,\n\t\t\t\t\t\t\t\tview: 'template',\n\t\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\t\ttemplate: function () {\n\t\t\t\t\t\t\t\t\tvar afterLabel = 'After #number# #unit#'\n\t\t\t\t\t\t\t\t\t\t.replace('#number#', $$(ids.validateRangeAfter).getValue())\n\t\t\t\t\t\t\t\t\t\t.replace('#unit#', $$(ids.validateRangeUnit).getValue());\n\n\t\t\t\t\t\t\t\t\treturn afterLabel;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: ids.validateRangeBefore,\n\t\t\t\t\t\t\t\tview: 'slider',\n\t\t\t\t\t\t\t\tname: \"validateRangeBefore\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonChange: function (newVal, oldValue) {\n\t\t\t\t\t\t\t\t\t\t$$(ids.validateRangeBeforeLabel).refresh();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: ids.validateRangeAfter,\n\t\t\t\t\t\t\t\tview: 'slider',\n\t\t\t\t\t\t\t\tname: \"validateRangeAfter\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonChange: function (newVal, oldValue) {\n\t\t\t\t\t\t\t\t\t\t$$(ids.validateRangeAfterLabel).refresh();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: ids.validateLeft,\n\t\t\t\tname: \"validateStartDate\",\n\t\t\t\tview: 'datepicker',\n\t\t\t\tlabel: 'Start Date',\n\t\t\t\tlabelWidth: 100,\n\t\t\t\thidden: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: ids.validateRight,\n\t\t\t\tname: \"validateEndDate\",\n\t\t\t\tview: 'datepicker',\n\t\t\t\tlabel: 'End Date',\n\t\t\t\tlabelWidth: 100,\n\t\t\t\thidden: true\n\t\t\t}\n\n\n\t\t]\n\t},\n\n\t// defaultValues: the keys must match a .name of your elements to set it's default value.\n\tdefaultValues: defaultValues,\n\n\t// rules: basic form validation rules for webix form entry.\n\t// the keys must match a .name of your .elements for it to apply\n\trules: {},\n\n\t// include additional behavior on default component operations here:\n\t// The base routines will be processed first, then these.  Any results\n\t// from the base routine, will be passed on to these:\n\tlogic: {\n\n\t\tisValid: function (ids, isValid) {\n\n\t\t}\n\n\t\t// populate: function (ids, values) {\n\t\t// \tif (values.settings.validation) {\n\t\t// \t\t$$(ids.validateMinimum).enable();\n\t\t// \t\t$$(ids.validateMaximum).enable();\n\t\t// \t} else {\n\t\t// \t\t$$(ids.validateMinimum).disable();\n\t\t// \t\t$$(ids.validateMaximum).disable();\n\t\t// \t}\n\t\t// }\n\n\t},\n\n\t// perform any additional setup actions here.\n\t// @param {obj} ids  the hash of id values for all the current form elements.\n\t//\t\t\t\t\t it should have your elements + the default Header elements:\n\t//\t\t\t\t\t\t.label, .columnName, .fieldDescription, .showIcon\n\tinit: function (ids) {\n\t\trefreshDateDisplay();\n\t}\n\n\n});\n\n\nclass ABFieldDate extends ABField {\n\tconstructor(values, object) {\n\t\tsuper(values, object, ABFieldDateDefaults);\n\n\t\t// we're responsible for setting up our specific settings:\n\t\tfor (var dv in defaultValues) {\n\t\t\tthis.settings[dv] = values.settings[dv] || defaultValues[dv];\n\t\t}\n\n\t\t// text to Int:\n\t\tthis.settings.includeTime = parseInt(this.settings.includeTime);\n\t\tthis.settings.defaultCurrentDate = parseInt(this.settings.defaultCurrentDate);\n\t\tthis.settings.dayOrder = parseInt(this.settings.dayOrder);\n\t\tthis.settings.monthOrder = parseInt(this.settings.monthOrder);\n\t\tthis.settings.yearOrder = parseInt(this.settings.yearOrder);\n\n\n\t}\n\n\t// return the default values for this DataField\n\tstatic defaults() {\n\t\treturn ABFieldDateDefaults;\n\t}\n\n\t/*\n\t* @function propertiesComponent\n\t*\n\t* return a UI Component that contains the property definitions for this Field.\n\t*\n\t* @param {App} App the UI App instance passed around the Components.\n\t* @return {Component}\n\t*/\n\tstatic propertiesComponent(App) {\n\t\treturn ABFieldDateComponent.component(App);\n\t}\n\n\t///\n\t/// Instance Methods\n\t///\n\n\n\tisValid() {\n\n\t\tvar validator = super.isValid();\n\n\t\t// validator.addError('columnName', L('ab.validation.object.name.unique', 'Field columnName must be unique (#name# already used in this Application)').replace('#name#', this.name) );\n\n\t\treturn validator;\n\t}\n\n\n\t/**\n\t * @method toObj()\n\t *\n\t * properly compile the current state of this ABApplication instance\n\t * into the values needed for saving to the DB.\n\t *\n\t * Most of the instance data is stored in .json field, so be sure to\n\t * update that from all the current values of our child fields.\n\t *\n\t * @return {json}\n\t */\n\t// toObj () {\n\n\t// \tvar obj = super.toObj();\n\n\t// \t// obj.settings = this.settings;  // <--  super.toObj()\n\n\t// \treturn obj;\n\t// }\n\n\n\n\n\t///\n\t/// Working with Actual Object Values:\n\t///\n\n\t// return the grid column header definition for this instance of ABFieldDate\n\tcolumnHeader(isObjectWorkspace) {\n\t\tvar config = super.columnHeader(isObjectWorkspace);\n\n\t\tconfig.editor = 'date';\n\t\tconfig.sort = 'string';\n\t\t\n\n\t\t// NOTE: it seems that the default value is a string in ISO format.\n\n\t\t//// NOTE: webix seems unable to parse ISO string into => date here.\n\t\t// config.map = '(date)#'+this.columnName+'#';   // so don't use this.\n\n\t\tconfig.format = function (d) {\n\t\t\tif ((d == '') || (typeof d == 'undefined')) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\t// convert ISO string -> Date() -> our formatted string\n\n// TODO: pull format from settings.\n\t\t\treturn webix.Date.dateToStr('%d %M %Y')(new Date(d));  \n\t\t}\n\n\n\t\tconfig.editFormat = function(d) {\n\t\t\t// this routine needs to return a Date() object for the editor to work with.\n\n\t\t\t// if d is not set, return a default Date() value.\n\t\t\tif ((d == '') || (typeof d == 'undefined')) {\n// TODO: setup default date from settings:\n\t\t\t\treturn new Date();\t\n\t\t\t}\n\n\t\t\t// else retun the actual ISO string => Date() value\n\t\t\treturn new Date(d);\n\t\t}\n\n\n\t\treturn config;\n\t}\n\n\n\n\t/**\n\t * @method isValidData\n\t * Parse through the given data and return an error if this field's\n\t * data seems invalid.\n\t * @param {obj} data  a key=>value hash of the inputs to parse.\n\t * @param {OPValidator} validator  provided Validator fn\n\t * @return {array} \n\t */\n\tisValidData(data, validator) {\n\n\t\tif (typeof data[this.columnName] != 'undefined') {\n\t\t\tvar value = data[this.columnName];\n\n\t\t\tif (!(value instanceof Date)) {\n\t\t\t\tvalue = new Date(value);\n\t\t\t}\n\n\t\t\t// verify we didn't end up with an InValid Date result.\n\t\t\tif ((Object.prototype.toString.call(value) === '[object Date]')\n\t\t\t\t&& (isFinite(value))) {\n\n\t\t\t\t// all good, so store as ISO format string.\n\t\t\t\tdata[this.columnName] = value.toISOString();\n\n\t\t\t} else {\n\n\t\t\t\t// return a validation error\n\t\t\t\tvalidator.addError(this.columnName, 'Should be a Date!');\n\t\t\t}\n\t\t}\n\n\t}\n\n}\n\n\nexport default ABFieldDate;\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/dataFields/ABFieldDate.js","/*\n * ABFieldImage\n *\n * An ABFieldImage defines a Image field type.\n *\n */\n\nimport ABField from \"./ABField\"\nimport ABFieldComponent from \"./ABFieldComponent\"\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\n\nvar ABFieldImageDefaults = {\n\tkey : 'image', // unique key to reference this specific DataField\n\t// type : 'string', // http://sailsjs.org/documentation/concepts/models-and-orm/attributes#?attribute-options\n\ticon : 'file-image-o',   // font-awesome icon reference.  (without the 'fa-').  so 'user'  to reference 'fa-user'\t\t\n\t\n\t// menuName: what gets displayed in the Editor drop list\n\tmenuName : L('ab.dataField.image.menuName', '*Image Attachment'),\n\t\n\t// description: what gets displayed in the Editor description.\n\tdescription: L('ab.dataField.image.description', '*Attach an image to this object.')\n}\n\n\n\nvar defaultValues = {\n\t'useWidth':0,\n\t'imageWidth':'',\n\t'useHeight': 0,\n\t'imageHeight': '',\n\t'removeExistingData': 0\n}\n\n\n\n/**\n * ABFieldImageComponent\n *\n * Defines the UI Component for this Data Field.  The ui component is responsible\n * for displaying the properties editor, populating existing data, retrieving\n * property values, etc.\n *\n * @param {obj} App  the current Component Application instance for the current UI.\n * @return {obj} the Component object.\n */\nvar ABFieldImageComponent = new ABFieldComponent({\n\n\tfieldDefaults: ABFieldImageDefaults,\n\n\telements:(App, field) => {\n\n\t\tvar ids = {\n\t\t\timageWidth: '',\n\t\t\timageHeight: ''\n\t\t}\n\t\tids = field.idsUnique(ids, App);\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"checkbox\",\n\t\t\t\t\t\tname:\"useWidth\", \n\t\t\t\t\t\tlabelRight:L('ab.dataField.image.width', \"*width\"), \n\t\t\t            width: 80,\n\t\t\t            labelWidth: 0,\n\t\t\t\t\t\tvalue:1,\n\t\t\t            click: function() {\n\t\t\t\t\t\t\tif (this.getValue())\n\t\t\t\t\t\t\t\t$$(ids.imageWidth).enable()\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t$$(ids.imageWidth).disable();\n\t\t\t            }\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: 'text',\n\t\t\t\t\t\tname:'imageWidth',\n\t\t\t\t\t\tid: ids.imageWidth\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"checkbox\",\n\t\t\t\t\t\tname:\"useHeight\",\n// id:componentIds.useHeight, \n\t\t\t\t\t\tlabelRight:L('ab.dataField.image.height', \"*height\"), \n\t\t\t          \twidth: 80,\n\t\t\t            labelWidth: 0,\n\t\t\t\t\t\tvalue:1,\n\t\t\t            click: function() {\n\t\t\t\t\t\t\tif (this.getValue())\n\t\t\t\t\t\t\t\t$$(ids.imageHeight).enable()\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t$$(ids.imageHeight).disable();\n\t\t\t            }\n\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: 'text',\n\t\t\t\t\t\tname: 'imageHeight',\n\t\t\t          \tid: ids.imageHeight\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t},\n\n\t// defaultValues: the keys must match a .name of your elements to set it's default value.\n\tdefaultValues: defaultValues,\n\n\t// rules: basic form validation rules for webix form entry.\n\t// the keys must match a .name of your .elements for it to apply\n\trules:{\n\t\t// 'textDefault':webix.rules.isNotEmpty,\n\t\t// 'supportMultilingual':webix.rules.isNotEmpty\n\t},\n\n\t// include additional behavior on default component operations here:\n\t// The base routines will be processed first, then these.  Any results\n\t// from the base routine, will be passed on to these: \n\t// \t@param {obj} ids  the list of ids used to generate the UI.  your \n\t//\t\t\t\t\t  provided .elements will have matching .name keys\n\t//\t\t\t\t\t  to access them here.\n\t//  @param {obj} values the current set of values provided for this instance\n\t// \t\t\t\t\t  of ABField:\n\t//\t\t\t\t\t  {\n\t//\t\t\t\t\t\tid:'',\t\t\t// if already .saved()\n\t// \t\t\t\t\t\tlabel:'',\n\t// \t\t\t\t\t\tcolumnName:'',\n\t//\t\t\t\t\t\tsettings:{\n\t//\t\t\t\t\t\t\tshowIcon:'',\n\t//\n\t//\t\t\t\t\t\t\tyour element key=>values here\t\n\t//\t\t\t\t\t\t}\n\t//\t\t\t\t\t  }\n\t//\n\t// \t\t.clear(ids)  : reset the display to an empty state\n\t// \t\t.isValid(ids, isValid): perform validation on the current editor values\n\t// \t\t.populate(ids, values) : populate the form with your current settings\n\t// \t\t.show(ids)   : display the form in the editor\n\t// \t\t.values(ids, values) : return the current values from the form\n\tlogic:{\n\n\t},\n\n\t// perform any additional setup actions here.\n\t// @param {obj} ids  the hash of id values for all the current form elements.\n\t//\t\t\t\t\t it should have your elements + the default Header elements:\n\t//\t\t\t\t\t\t.label, .columnName, .fieldDescription, .showIcon\n\tinit:function(ids) {\n\t\t// want to hide the description? :\n\t\t// $$(ids.fieldDescription).hide();\n\t}\n\n})\n\n\n\n\n\nclass ABFieldImage extends ABField {\n\n    constructor(values, object) {\n    \tsuper(values, object, ABFieldImageDefaults);\n\n    \t/*\n    \t{\n\t\t\tsettings: {\n\t\t\t\t'useWidth':0,\n\t\t\t\t'imageWidth':'',\n\t\t\t\t'useHeight': 0,\n\t\t\t\t'imageHeight': '',\n\t\t\t\t'removeExistingData': 0\n\t\t\t}\n    \t}\n    \t*/\n\n    \t// we're responsible for setting up our specific settings:\n    \tfor (var dv in defaultValues) {\n    \t\tthis.settings[dv] = values.settings[dv] || defaultValues[dv];\n    \t}\n\n\n    \t// text to Int:\n    \tthis.settings.useWidth = parseInt(this.settings.useWidth);\n    \tthis.settings.useHeight = parseInt(this.settings.useHeight);\n    \tthis.settings.removeExistingData = parseInt(this.settings.removeExistingData);\n  \t}\n\n\n  \t// return the default values for this DataField\n  \tstatic defaults() {\n  \t\treturn ABFieldImageDefaults;\n  \t}\n\n\n\n\t/*\n\t * @function propertiesComponent\n\t *\n\t * return a UI Component that contains the property definitions for this Field.\n\t *\n\t * @param {App} App the UI App instance passed around the Components.\n\t * @return {Component}\n\t */\n  \tstatic propertiesComponent(App) {\n  \t\treturn ABFieldImageComponent.component(App);\n  \t}\n\n\n\n\t///\n\t/// Instance Methods\n\t///\n\n\n\tisValid() {\n\n\t\tvar validator = super.isValid();\n\n\t\t// validator.addError('columnName', L('ab.validation.object.name.unique', 'Field columnName must be unique (#name# already used in this Application)').replace('#name#', this.name) );\n\n\t\treturn validator;\n\t}\n\n\n\n\t/**\n\t * @function destroy\n\t * On a destroy operation, ask if the user wants to keep the related images.\n\t */\n\tdestroy () {\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\n\t\t\t\t// verify we have been .save()d before:\n\t\t\t\tif (this.id) {\n\n\t\t\t\t\t// Ask the user what to do about the existing images:\n\t\t\t\t\tOP.Dialog.Confirm({\n\t\t\t\t\t\ttitle: L('ab.dataField.image.keepImages', '*Keep Images?'),\n\t\t\t\t\t\tmessage: L('ab.dataField.image.keepImagesDescription', '*Do you want to keep the images referenced by #label#?').replace('#label#', this.label),\n\t\t\t\t\t\tcallback: (result) => {\n\n\t\t\t\t\t\t\t// update this setting so the server can respond correctly in\n\t\t\t\t\t\t\t// ABFieldImage.migrateDrop()\n\t\t\t\t\t\t\tthis.settings.removeExistingData = result ? 0: 1;\n\t\t\t\t\t\t\tthis.save()\n\t\t\t\t\t\t\t.then(()=>{\n\n// TODO: a reminder that you still got alot on the server to do!\nOP.Dialog.Alert({\n\ttitle:'!! TODO !!',\n\ttext:'Tell a Developer to actually pay attention to this!'\n})\n\t\t\t\t\t\t\t\t// now the default .destroy() \n\t\t\t\t\t\t\t\tsuper.destroy()\n\t\t\t\t\t\t\t\t.then(resolve)\n\t\t\t\t\t\t\t\t.catch(reject);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(reject);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t} else {\n\t\t\t\t\tresolve();  // nothing to do really\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t)\n\t}\n\n\n\n\n\t/**\n\t * @method toObj()\n\t *\n\t * properly compile the current state of this ABApplication instance\n\t * into the values needed for saving to the DB.\n\t *\n\t * Most of the instance data is stored in .json field, so be sure to\n\t * update that from all the current values of our child fields.\n\t *\n\t * @return {json}\n\t */\n\t// toObj () {\n\n\t// \tvar obj = super.toObj();\n\n\t// \t// obj.settings = this.settings;  // <--  super.toObj()\n\n\t// \treturn obj;\n\t// }\n\n\n\n\n\t///\n\t/// Working with Actual Object Values:\n\t///\n\n\tidCustomContainer(obj) {\n\t\treturn \"#columnName#-#id#-image\"\n\t\t\t.replace('#id#', obj.id)\n\t\t\t.replace('#columnName#', this.columnName);\n\t}\n\n\n\t// return the grid column header definition for this instance of ABFieldImage\n\tcolumnHeader (isObjectWorkspace) {\n\t\tvar config = super.columnHeader(isObjectWorkspace);\n\n\t\tconfig.editor = false;  // 'text';  // '[edit_type]'   for your unique situation\n\t\tconfig.sort   = 'string' // '[sort_type]'   for your unique situation\n\n\t\tif (this.settings.useWidth) {\n\t\t\tconfig.width = this.settings.imageWidth;\n\t\t}\n\n\t\t// populate our default template:\n\t\tconfig.template = (obj) => {\n\n\t\t\tvar imgDiv = [\n\t\t\t\t'<div id=\"#id#\" class=\"ab-image-data-field\">',\n\t\t\t\tthis.imageTemplate(obj),\n\t\t\t\t'</div>'\n\t\t\t].join('');\n\n\t\t\treturn imgDiv\n\t\t\t\t.replace('#id#', this.idCustomContainer(obj) )\n\t\t}\n\n\t\treturn config;\n\t}\n\n\n\t/*\n\t * @function customDisplay\n\t * perform any custom display modifications for this field.  \n\t * @param {object} row is the {name=>value} hash of the current row of data.\n\t * @param {App} App the shared ui App object useful more making globally\n\t *\t\t\t\t\tunique id references.\n\t * @param {HtmlDOM} node  the HTML Dom object for this field's display.\n\t */\n\tcustomDisplay(row, App, node) {\n\t\t// sanity check.\n\t\tif (!node) { return }\n\n\n\t\tvar idBase = App.unique(this.idCustomContainer(row));\n\t\tvar ids = {\n\t\t\tcontainer:idBase+'-container',\n\t\t\tuploader: idBase+'-uploader',\n\t\t\ticon: idBase+'-icon',\n\t\t\timage: idBase+'-image'\n\t\t}\n\n\n\t\t// safety check:\n\t\t// webix seems to crash if you specify a .container that doesn't exists:\n\t\t// Note: when the template is first created, we don't have App.unique() \n\t\tvar parentContainer = node.querySelector('#'+this.idCustomContainer(row)); // $$(this.idCustomContainer(obj));\n\t\tif(parentContainer) {\n\n\t\t\tparentContainer.innerHTML = '';\n\t\t\tparentContainer.id = idBase;\t// change it to the unique one.\n\n\t\t\tvar imgHeight = 33;\n\t\t\tif (this.settings.useHeight){\n\t\t\t\timgHeight = parseInt(this.settings.imageHeight);\n\t\t\t}\n\n\t\t\tvar imgWidth = 50;\n\t\t\tif (this.settings.useWidth){\n\t\t\t\timgWidth = parseInt(this.settings.imageWidth);\n\t\t\t}\n//// TODO: actually pay attention to the height and width when \n//// displaying the images.\n\n\t\t\t// use a webix component for displaying the content.\n\t\t\t// do this so I can use the progress spinner\n\t\t\tvar webixContainer = webix.ui({\n\t\t\t\tview:'template',\n\t\t\t\tid: ids.container,\n\t\t\t\tcontainer: idBase,\n\t\t\t\t\n\t\t\t\ttemplate:this.imageTemplate(row),\n\n\t\t\t\tborderless:true,\n\t\t\t\theight: imgHeight,\n\t\t\t\twidth:  imgWidth\n\t\t\t});\n\t\t\twebix.extend(webixContainer, webix.ProgressBar);\n\n\t\t\t////\n\t\t\t//// Prepare the Uploader\n\t\t\t////\n\n\t\t\t// The Server Side action key format for this Application:\n\t\t\tvar actionKey = 'opstool.AB_'+this.object.application.name.replace('_','')+'.view';\n\t\t\tvar url = '/'+[ 'opsportal', 'image', this.object.application.name, actionKey, '1'].join('/');\n\n\t\t\tvar uploader = webix.ui({ \n\t\t\t    view:\"uploader\",  \n\t\t\t    id:ids.uploader, \n\t\t\t    apiOnly: true, \n\t\t\t    upload:url,\n\t\t\t    inputName:'image',\n\t\t\t    multiple: false,\n\t\t\t    // formData:{\n\t\t\t    // \tappKey:application.name,\n\t\t\t    // \tpermission:actionKey,\n\t\t\t    // \tisWebix:true,\n\t\t\t    // \timageParam:'upload'\n\t\t\t    // },\n\t\t\t    on: {\n\n\t\t\t    \t// when a file is added to the uploader\n\t\t\t    \tonBeforeFileAdd:function(item){\n\n\t\t\t\t\t\tnode.classList.remove('webix_invalid');\n\t\t\t\t\t\tnode.classList.remove('webix_invalid_cell');\n\t\t\t\t\t\t\n\t\t\t    \t\t// verify file type\n\t\t\t    \t\tvar acceptableTypes = ['jpg', 'jpeg', 'bmp', 'png', 'gif'];\n\t\t\t\t\t    var type = item.type.toLowerCase();\n\t\t\t\t\t    if (acceptableTypes.indexOf(type) == -1){\n//// TODO: multilingual\nwebix.message(\"Only [\"+acceptableTypes.join(\", \")+\"] images are supported\");\n\t\t\t\t\t        return false;\n\t\t\t\t\t    }\n\n\t\t\t\t\t\t// start progress indicator\n\t\t\t\t\t\twebixContainer.showProgress({\n\t\t\t\t\t\t   type:\"icon\",\n\t\t\t\t\t\t   delay:2000\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\n\t\t\t    \t// when upload is complete:\n\t\t\t    \tonFileUpload:(item, response)=>{\n\t\t\t\t\t\t\n\t\t\t\t\t\twebixContainer.hideProgress();\n\t\t\t\t\t\tthis.showImage(idBase, response.data.uuid);\n\n// TODO: delete previous image from our OPsPortal service?\n\t\t\t\t\t\t\n\t\t\t\t\t\t// update just this value on our current object.model\n\t\t\t\t\t\tvar values = {};\n\t\t\t\t\t\tvalues[this.columnName] = response.data.uuid\n\t\t\t\t\t\tthis.object.model().update(row.id, values)\n\t\t\t\t\t\t.then(()=>{\n\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((err)=>{\n\n\t\t\t\t\t\t\tnode.classList.add('webix_invalid');\n\t\t\t\t\t\t\tnode.classList.add('webix_invalid_cell');\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tOP.Error.log('Error updating our entry.', {error:err, row:row, values:values });\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t})\n\n\t\t\t\t\t},\n\n\t\t\t\t\t// if an error was returned\n\t\t\t\t\tonFileUploadError:function(item, response){\n\t\t\t\t\t\tOP.Error.log('Error loading image', response);\n\t\t\t\t\t\twebixContainer.hideProgress();\n\t\t\t\t\t}\n\t\t\t    }\n\t\t\t});\n\t\t\tuploader.addDropZone(webixContainer.$view);\n\n\t\t}\t\n\t}\n\n\n\timageTemplate(obj) {\n\n\t\t// deault view is icon:\n\t\tvar iconDisplay = '';\n\t\tvar imageDisplay = 'display:none;';\n\t\tvar imageURL    = ''\n\t\t\n\t\t// if we have a value for this field, then switch to image:\n\t\tvar value = obj[this.columnName];\n\t\tif ((value) && (value != '')) {\n\t\t\ticonDisplay = 'display:none;';\n\t\t\timageDisplay = '';\n\t\t\timageURL    = \"background-image:url('/opsportal/image/\" + this.object.application.name+\"/\"+obj[this.columnName]+\"');\"\n\t\t}\n\n\t\treturn [\n\t\t\t'<div class=\"image-data-field-icon\" style=\"text-align: center; '+iconDisplay+'\"><i class=\"fa fa-file-image-o fa-2x\"></i></div>',\n\t\t\t'<div class=\"image-data-field-image\" style=\"'+imageDisplay+' width:100%; height:100%; background-repeat: no-repeat; background-position: center center; background-size: cover; '+imageURL+'\"></div>',\n\t\t].join('');\n\n\t}\n\n\n\tshowImage(id, uuid) {\n\t\tvar parentContainer = document.getElementById(id); // $$(this.idCustomContainer(obj));\n\t\tif(parentContainer) {\n\n\t\t\tparentContainer.querySelector('.image-data-field-icon').style.display = 'none';\n\t\t\tvar image = parentContainer.querySelector('.image-data-field-image');\n\t\t\timage.style.display = '';\n\t\t\timage.style.backgroundImage = \"url('/opsportal/image/\" + this.object.application.name+\"/\"+uuid+\"')\";\n\n\t\t}\n\t}\n\n\n}\n\n\n\n//// NOTE: if you need a unique [edit_type] by your returned config.editor above:\n// webix.editors = {\n//   \"[edit_type]\": {\n//     focus: function () {...}\n//     getValue: function () {...},\n//     setValue: function (value) {...},\n//     render: function () {...}\n//   }\n// };\n\n\n//// NOTE: if you need a unique [sort_type] by your returned config.sort above:\n// webix.DataStore.prototype.sorting.as.[sort_type] = function(a,b){ \n//     return a > b ? 1 : -1; \n// }\n\n\nexport default ABFieldImage;\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/dataFields/ABFieldImage.js","/*\n * ABFieldNumber\n *\n * An ABFieldNumber defines a Number field type.\n *\n */\n\nimport ABField from \"./ABField\"\nimport ABFieldComponent from \"./ABFieldComponent\"\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\n\nvar ABFieldNumberDefaults = {\n\tkey : 'number', // unique key to reference this specific DataField\n\ticon : 'slack',   // font-awesome icon reference.  (without the 'fa-').  so 'user'  to reference 'fa-user'\n\n\t// menuName: what gets displayed in the Editor drop list\n\tmenuName : L('ab.dataField.number.menuName', '*Number'),\n\n\t// description: what gets displayed in the Editor description.\n\tdescription: L('ab.dataField.number.description', '*A Float or Integer Value')\n}\n\n\n\nvar formatList = [\n\t{ id: 'none', value: L('ab.dataField.number.none', \"*None\") },\n\t{ id: 'dollar', value: L('ab.dataField.number.format.dollar', \"$\"), sign: \"$\", position: \"prefix\" },\n\t{ id: 'pound', value: L('ab.dataField.number.format.pound', \"\"), sign: \"\", position: \"prefix\" },\n\t{ id: 'euroBefore', value: L('ab.dataField.number.format.euroBefore', \" (before)\"), sign: \"\", position: \"prefix\" },\n\t{ id: 'euroAfter', value: L('ab.dataField.number.format.euroAfter', \" (after)\"), sign: \"\", position: \"postfix\" },\n\t{ id: 'percent', value: L('ab.dataField.number.format.percent', \"%\"), sign: \"%\", position: \"postfix\" },\n];\n\nvar defaultValues = {\n\t'allowRequired':0,\n\t'numberDefault':'',\n\t'typeFormat': 'none',\n\t'typeDecimals': 'none',\n\t'typeDecimalPlaces': 'none',\n\t'typeRounding' : 'none',\n\t'typeThousands': 'none',\n\t'validation':0,\n\t'validateMinimum':'',\n\t'validateMaximum':''\n}\n\n/**\n * ABFieldNumberComponent\n *\n * Defines the UI Component for this Data Field.  The ui component is responsible\n * for displaying the properties editor, populating existing data, retrieving\n * property values, etc.\n *\n * @param {obj} App  the current Component Application instance for the current UI.\n * @return {obj} the Component object.\n */\nvar ABFieldNumberComponent = new ABFieldComponent({\n\n\tfieldDefaults: ABFieldNumberDefaults,\n\n\telements:(App, field) => {\n\n\n\n\t\t// var idBase = ABFieldNumberDefaults.type;\n\t\t// var ids = {\n\t\t// \ttypeDecimalPlaces: this.unique(App, '_typeDecimalPlaces'),  // App.unique(idBase +'_typeDecimalPlaces'),\n\t\t// \ttypeRounding: App.unique(idBase +'_typeRounding'),\n\t\t// \tvalidateMinimum: App.unique(idBase + '_validateMinimum'),\n\t\t// \tvalidateMaximum: App.unique(idBase + '_validateMaximum')\n\t\t// }\n\n\t\tvar ids = {\n\t\t\ttypeDecimalPlaces \t: '',\n\t\t\ttypeRounding \t\t: '',\n\t\t\tvalidateMinimum \t: '',\n\t\t\tvalidateMaximum \t: ''\n\t\t}\n\t\tids = field.idsUnique(ids, App);\n\n\t\treturn [\n\t\t\t// {\n\t\t\t// \tview: \"text\",\n\t\t\t// \tname:'textDefault',\n\t\t\t// \tlabelWidth: App.config.labelWidthLarge,\n\t\t\t// \tplaceholder: L('ab.dataField.string.default', '*Default text')\n\t\t\t// },\n\t\t\t{\n\t\t\t\tview: \"checkbox\",\n// id: componentIds.allowRequired,\n\t\t\t\tname:\"allowRequired\",\n\t\t\t\tlabelRight: L(\"ab.dataField.number.required\", \"*Required\"),\n\t\t\t\t// inputWidth: 130,\n\t\t\t\tlabelWidth: 0\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"text\",\n\t\t\t\tlabel: L(\"ab.dataField.number.defaultValue\", \"*Default Value\"),\n\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n// id: componentIds.numberDefault,\n\t\t\t\tname:\"numberDefault\",\n\t\t\t\tplaceholder: L('ab.dataField.number.defaultNumber', '*Default number'),\n\t\t\t\ton: {\n\t\t\t\t\tonChange: function (newVal, oldVal) {\n\t\t\t\t\t\t// Validate number\n\t\t\t\t\t\tif (!new RegExp('^[0-9.]*$').test(newVal)) {\n\t\t\t\t\t\t\t// $$(componentIds.numberDefault).setValue(oldVal);\n\t\t\t\t\t\t\tthis.setValue(oldVal);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n// id: componentIds.typeFormat,\n\t\t\t\tname:'typeFormat',\n\t\t\t\tlabel: L('ab.dataField.number.format', \"*Format\"),\n\t\t\t\tvalue: 'none',\n\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n\t\t\t\toptions: formatList\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n// id: componentIds.typeDecimals,\n\t\t\t\tname:'typeDecimals',\n\t\t\t\tlabel: L('ab.dataField.number.decimals', \"*Decimals\"),\n\t\t\t\tvalue: 'none',\n\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: 'none', value: L('ab.dataField.number.none', \"*None\") },\n\t\t\t\t\t{ id: 'period', value: L('ab.dataField.number.period', \"*Period\") },\n\t\t\t\t\t{ id: 'comma', value: L('ab.dataField.number.comma', \"*Comma\") }\n\t\t\t\t],\n\t\t\t\ton: {\n\t\t\t\t\t'onChange': function (newValue, oldValue) {\n\t\t\t\t\t\tif (newValue == 'none') {\n\t\t\t\t\t\t\t$$(ids.typeDecimalPlaces).disable();\n\t\t\t\t\t\t\t$$(ids.typeRounding).disable();\n\t\t\t\t\t\t\t$$(ids.typeDecimalPlaces).hide();\n\t\t\t\t\t\t\t$$(ids.typeRounding).hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t$$(ids.typeDecimalPlaces).enable();\n\t\t\t\t\t\t\t$$(ids.typeRounding).enable();\n\t\t\t\t\t\t\t$$(ids.typeDecimalPlaces).show();\n\t\t\t\t\t\t\t$$(ids.typeRounding).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tid: ids.typeDecimalPlaces,\n\t\t\t\tname:'typeDecimalPlaces',\n\t\t\t\tlabel: \"Places\",\n\t\t\t\tvalue: 'none',\n\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n\t\t\t\tdisabled: true,\n\t\t\t\thidden: true,\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: 'none', value: \"0\" },\n\t\t\t\t\t{ id: 1, value: \"1\" },\n\t\t\t\t\t{ id: 2, value: \"2\" },\n\t\t\t\t\t{ id: 3, value: \"3\" },\n\t\t\t\t\t{ id: 4, value: \"4\" },\n\t\t\t\t\t{ id: 5, value: \"5\" },\n\t\t\t\t\t{ id: 10, value: \"10\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n\t\t\t\tid: ids.typeRounding,\n\t\t\t\tname:'typeRounding',\n\t\t\t\tlabel: L('ab.dataField.number.rounding', \"*Rounding\"),\n\t\t\t\tvalue: 'none',\n\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n\t\t\t\tvertical: true,\n\t\t\t\tdisabled: true,\n\t\t\t\thidden: true,\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: 'none', value: L('ab.dataField.number.default', \"*Default\") },\n\t\t\t\t\t{ id: 'roundUp', value: L('ab.dataField.number.roundUp', \"*Round Up\") },\n\t\t\t\t\t{ id: 'roundDown', value: L('ab.dataField.number.roundDown', \"*Round Down\") }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"richselect\",\n// id: componentIds.typeThousands,\n\t\t\t\tname:'typeThousands',\n\t\t\t\tlabel: L('ab.dataField.number.thousands', \"*Thousands\"),\n\t\t\t\tvalue: 'none',\n\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n\t\t\t\tvertical: true,\n\t\t\t\toptions: [\n\t\t\t\t\t{ id: 'none', value: L('ab.dataField.number.none', \"*None\") },\n\t\t\t\t\t{ id: 'comma', value: L('ab.dataField.number.comma', \"*Comma\") },\n\t\t\t\t\t{ id: 'period', value: L('ab.dataField.number.period', \"*Period\") },\n\t\t\t\t\t{ id: 'space', value: L('ab.dataField.number.space', \"*Space\") }\n\t\t\t\t]\n\t\t\t},\n\n\n\n\t\t\t{\n\t\t\t\tview: 'checkbox',\n// id: componentIds.validate,\n\t\t\t\tname:'validation',\n\t\t\t\tlabelWidth: App.config.labelWidthCheckbox,\n\t\t\t\tlabelRight: L('ab.dataField.number.validation', \"*Validation\"),\n\t\t\t\ton: {\n\t\t\t\t\tonChange: function (newVal) {\n\t\t\t\t\t\tif (newVal) {\n\t\t\t\t\t\t\t$$(ids.validateMinimum).enable();\n\t\t\t\t\t\t\t$$(ids.validateMaximum).enable();\n\t\t\t\t\t\t\t$$(ids.validateMinimum).show();\n\t\t\t\t\t\t\t$$(ids.validateMaximum).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t$$(ids.validateMinimum).disable();\n\t\t\t\t\t\t\t$$(ids.validateMaximum).disable();\n\t\t\t\t\t\t\t$$(ids.validateMinimum).hide();\n\t\t\t\t\t\t\t$$(ids.validateMaximum).hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: 'text',\n\t\t\t\tid: ids.validateMinimum,\n\t\t\t\tname:'validateMinimum',\n\t\t\t\tlabel: L('ab.dataField.number.minimum', \"*Minimum\"),\n\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n\t\t\t\tdisabled: true,\n\t\t\t\thidden: true,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: function(newVal, oldVal) {\n\t\t\t\t\t\t// Validate number\n\t\t\t\t\t\tif (!new RegExp('^[0-9.]*$').test(newVal)) {\n\t\t\t\t\t\t\t$$(ids.validateMinimum).setValue(oldVal || '');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: 'text',\n\t\t\t\tid: ids.validateMaximum,\n\t\t\t\tname:'validateMaximum',\n\t\t\t\tlabel: L('ab.dataField.number.maximum', \"*Maximum\"),\n\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n\t\t\t\tdisabled: true,\n\t\t\t\thidden: true,\n\t\t\t\ton: {\n\t\t\t\t\tonChange: function (newVal, oldVal) {\n\t\t\t\t\t\t// Validate number\n\t\t\t\t\t\tif (!new RegExp('^[0-9.]*$').test(newVal)) {\n\t\t\t\t\t\t\t$$(ids.validateMaximum).setValue(oldVal || '');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t]\n\t},\n\n\t// defaultValues: the keys must match a .name of your elements to set it's default value.\n\tdefaultValues:defaultValues,\n\n\t// rules: basic form validation rules for webix form entry.\n\t// the keys must match a .name of your .elements for it to apply\n\trules:{\n\t\t// 'textDefault':webix.rules.isNotEmpty,\n\t\t// 'supportMultilingual':webix.rules.isNotEmpty\n\t},\n\n\t// include additional behavior on default component operations here:\n\t// The base routines will be processed first, then these.  Any results\n\t// from the base routine, will be passed on to these:\n\t// \t@param {obj} ids  the list of ids used to generate the UI.  your\n\t//\t\t\t\t\t  provided .elements will have matching .name keys\n\t//\t\t\t\t\t  to access them here.\n\t//  @param {obj} values the current set of values provided for this instance\n\t// \t\t\t\t\t  of ABField:\n\t//\t\t\t\t\t  {\n\t//\t\t\t\t\t\tid:'',\t\t\t// if already .saved()\n\t// \t\t\t\t\t\tlabel:'',\n\t// \t\t\t\t\t\tcolumnName:'',\n\t//\t\t\t\t\t\tsettings:{\n\t//\t\t\t\t\t\t\tshowIcon:'',\n\t//\n\t//\t\t\t\t\t\t\tyour element key=>values here\n\t//\t\t\t\t\t\t}\n\t//\t\t\t\t\t  }\n\t//\n\t// \t\t.clear(ids)  : reset the display to an empty state\n\t// \t\t.isValid(ids, isValid): perform validation on the current editor values\n\t// \t\t.populate(ids, values) : populate the form with your current settings\n\t// \t\t.show(ids)   : display the form in the editor\n\t// \t\t.values(ids, values) : return the current values from the form\n\tlogic:{\n\n\t\tpopulate:function(ids, values) {\n\t\t\tif (values.settings.validation) {\n\t\t\t\t$$(ids.validateMinimum).enable();\n\t\t\t\t$$(ids.validateMaximum).enable();\n\t\t\t} else {\n\t\t\t\t$$(ids.validateMinimum).disable();\n\t\t\t\t$$(ids.validateMaximum).disable();\n\t\t\t}\n\t\t}\n\t},\n\n\t// perform any additional setup actions here.\n\t// @param {obj} ids  the hash of id values for all the current form elements.\n\t//\t\t\t\t\t it should have your elements + the default Header elements:\n\t//\t\t\t\t\t\t.label, .columnName, .fieldDescription, .showIcon\n\tinit:function(ids) {\n\t\t// want to hide the description? :\n\t\t// $$(ids.fieldDescription).hide();\n\t}\n\n})\n\n\n\n\n\nclass ABFieldNumber extends ABField {\n\n    constructor(values, object) {\n    \tsuper(values, object, ABFieldNumberDefaults);\n\n    \t/*\n    \t{\n\t\t\tsettings: {\n\t\t\t\t'allowRequired':0,\n\t\t\t\t'numberDefault':null,\n\t\t\t\t'typeFormat': 'none',\n\t\t\t\t'typeDecimals': 'none',\n\t\t\t\t'typeDecimalPlaces': 'none',\n\t\t\t\t'typeRounding' : 'none',\n\t\t\t\t'typeThousands': 'none',\n\t\t\t\t'validation':0,\n\t\t\t\t'validateMinimum':null,\n\t\t\t\t'validateMaximum':null\n\t\t\t}\n    \t}\n    \t*/\n\n    \t// we're responsible for setting up our specific settings:\n    \tfor (var dv in defaultValues) {\n    \t\tthis.settings[dv] = values.settings[dv] || defaultValues[dv];\n    \t}\n\n\n    \t// text to Int:\n    \tthis.settings.allowRequired = parseInt(this.settings.allowRequired);\n    \tthis.settings.validation = parseInt(this.settings.validation);\n\n  \t}\n\n\n  \t// return the default values for this DataField\n  \tstatic defaults() {\n  \t\treturn ABFieldNumberDefaults;\n  \t}\n\n\n\n\t/*\n\t * @function propertiesComponent\n\t *\n\t * return a UI Component that contains the property definitions for this Field.\n\t *\n\t * @param {App} App the UI App instance passed around the Components.\n\t * @return {Component}\n\t */\n  \tstatic propertiesComponent(App) {\n  \t\treturn ABFieldNumberComponent.component(App);\n  \t}\n\n\n\n\t///\n\t/// Instance Methods\n\t///\n\n\n\tisValid() {\n\n\t\tvar validator = super.isValid();\n\n\t\t// validator.addError('columnName', L('ab.validation.object.name.unique', 'Field columnName must be unique (#name# already used in this Application)').replace('#name#', this.name) );\n\n\t\treturn validator;\n\t}\n\n\n\t/**\n\t * @method toObj()\n\t *\n\t * properly compile the current state of this ABApplication instance\n\t * into the values needed for saving to the DB.\n\t *\n\t * Most of the instance data is stored in .json field, so be sure to\n\t * update that from all the current values of our child fields.\n\t *\n\t * @return {json}\n\t */\n\t// toObj () {\n\n\t// \tvar obj = super.toObj();\n\n\t// \t// obj.settings = this.settings;  // <--  super.toObj()\n\n\t// \treturn obj;\n\t// }\n\n\n\n\n\t///\n\t/// Working with Actual Object Values:\n\t///\n\n\t// return the grid column header definition for this instance of ABFieldNumber\n\tcolumnHeader (isObjectWorkspace) {\n\t\tvar config = super.columnHeader(isObjectWorkspace);\n\n\t\tconfig.editor = 'number';\t\t// [edit_type] simple inline editing.\n\t\tconfig.sort   = 'int';\t\t\t// [sort_type]\n\n\t\treturn config;\n\t}\n\n\n\n\t/**\n\t * @method isValidData\n\t * Parse through the given data and return an error if this field's\n\t * data seems invalid.\n\t * @param {obj} data  a key=>value hash of the inputs to parse.\n\t * @param {OPValidator} validator  provided Validator fn\n\t * @return {array} \n\t */\n\tisValidData(data, validator) {\n\n\t\tif (typeof data[this.columnName] != 'undefined') {\n\t\t\tvar value = data[this.columnName];\n\n\t\t\t// if this is an integer:\n\t\t\tif (this.settings.typeDecimals == 'none') {\n\n\t\t\t\tvalue = parseInt(value);\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tvar places = parseInt(this.settings.typeDecimalPlaces) || 2;\n\t\t\t\tvalue = parseFloat(parseFloat(value).toFixed(places));\n\t\t\t}\n\n\t\t\tfunction isNumeric(n) {\n\t\t\t  return !Number.isNaN(parseFloat(n)) && Number.isFinite(n);\n\t\t\t}\n\t\t\tif (!isNumeric(value)) {\n\t\t\t\tvalidator.addError(this.columnName, 'invalid number');\n\t\t\t}\n\t\t}\n\n\t}\n\n}\n\n\n\t// NOTE: if you need a unique [edit_type] by your returned config.editor above:\n    webix.editors.number = webix.extend({\n// TODO : Validate number only\n    }, webix.editors.text);\n\n\n//// NOTE: if you need a unique [sort_type] by your returned config.sort above:\n// webix.DataStore.prototype.sorting.as.[sort_type] = function(a,b){\n//     return a > b ? 1 : -1;\n// }\n\nexport default ABFieldNumber;\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/dataFields/ABFieldNumber.js","/*\n * ABFieldString\n *\n * An ABFieldString defines a string field type.\n *\n */\n\nimport ABField from \"./ABField\"\nimport ABFieldComponent from \"./ABFieldComponent\"\n\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar ABFieldStringDefaults = {\n\tkey : 'string', // unique key to reference this specific DataField\n\t// type : 'string', // http://sailsjs.org/documentation/concepts/models-and-orm/attributes#?attribute-options\n\ticon : 'font',   // font-awesome icon reference.  (without the 'fa-').  so 'user'  to reference 'fa-user'\n\n\t// menuName: what gets displayed in the Editor drop list\n\tmenuName : L('ab.dataField.string.menuName', '*Single line text'),\n\n\t// description: what gets displayed in the Editor description.\n\tdescription: L('ab.dataField.string.description', '*short string value')\n}\n\n\n\n\n/**\n * ABFieldStringComponent\n *\n * Defines the UI Component for this Data Field.  The ui component is responsible\n * for displaying the properties editor, populating existing data, retrieving\n * property values, etc.\n */\nvar ABFieldStringComponent = new ABFieldComponent({\n\n\tfieldDefaults: ABFieldStringDefaults,\n\n\telements:function(App) {\n\t\treturn [\n\t\t\t{\n\t\t\t\tview: \"text\",\n\t\t\t\tname:'textDefault',\n\t\t\t\tlabelWidth: App.config.labelWidthMedium,\n\t\t\t\tlabel: L('ab.dataField.string.defaultLabel', '*Default'),\n\t\t\t\tplaceholder: L('ab.dataField.string.default', '*Enter default value')\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"checkbox\",\n\t\t\t\tname:'supportMultilingual',\n\t\t\t\tlabelRight: L('ab.dataField.string.supportMultilingual', '*Support multilingual'),\n\t\t\t\tlabelWidth: App.config.labelWidthCheckbox,\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t]\n\t},\n\n\t// defaultValues: the keys must match a .name of your elements to set it's default value.\n\tdefaultValues:{\n\t\t'textDefault': '',\n\t\t'supportMultilingual':1\n\t},\n\n\t// rules: basic form validation rules for webix form entry.\n\t// the keys must match a .name of your .elements for it to apply\n\trules:{\n\t\t// 'textDefault':webix.rules.isNotEmpty,\n\t\t// 'supportMultilingual':webix.rules.isNotEmpty\n\t},\n\n\t// include additional behavior on default component operations here:\n\t// The base routines will be processed first, then these.  Any results\n\t// from the base routine, will be passed on to these:\n\t// \t@param {obj} ids  the list of ids used to generate the UI.  your\n\t//\t\t\t\t\t  provided .elements will have matching .name keys\n\t//\t\t\t\t\t  to access them here.\n\t//  @param {obj} values the current set of values provided for this instance\n\t// \t\t\t\t\t  of ABField:\n\t//\t\t\t\t\t  {\n\t//\t\t\t\t\t\tid:'',\t\t\t// if already .saved()\n\t// \t\t\t\t\t\tlabel:'',\n\t// \t\t\t\t\t\tcolumnName:'',\n\t//\t\t\t\t\t\tsettings:{\n\t//\t\t\t\t\t\t\tshowIcon:'',\n\t//\n\t//\t\t\t\t\t\t\tyour element key=>values here\n\t//\t\t\t\t\t\t}\n\t//\t\t\t\t\t  }\n\t//\n\t// \t\t.clear(ids)  : reset the display to an empty state\n\t// \t\t.isValid(ids, isValid): perform validation on the current editor values\n\t// \t\t.populate(ids, values) : populate the form with your current settings\n\t// \t\t.show(ids)   : display the form in the editor\n\t// \t\t.values(ids, values) : return the current values from the form\n\tlogic:{\n\n\t},\n\n\t// perform any additional setup actions here.\n\t// @param {obj} ids  the hash of id values for all the current form elements.\n\t//\t\t\t\t\t it should have your elements + the default Header elements:\n\t//\t\t\t\t\t\t.label, .columnName, .fieldDescription, .showIcon\n\tinit:function(ids) {\n\t\t// want to hide the description? :\n\t\t// $$(ids.fieldDescription).hide();\n\t}\n\n})\n\n\n\n\n\nclass ABFieldString extends ABField {\n\n    constructor(values, object) {\n    \tsuper(values, object, ABFieldStringDefaults);\n\n    \t/*\n    \t{\n\t\t\tsettings: {\n\t\t\t\ttextDefault: 'string',\n\t\t\t\tsupportMultilingual: true/false\n\t\t\t}\n    \t}\n    \t*/\n\n    \t// we're responsible for setting up our specific settings:\n    \tthis.settings.textDefault = values.settings.textDefault || '';\n    \tthis.settings.supportMultilingual = values.settings.supportMultilingual+\"\" || \"1\";\n\n    \t// text to Int:\n    \tthis.settings.supportMultilingual = parseInt(this.settings.supportMultilingual);\n\n  \t}\n\n\n  \t// return the default values for this DataField\n  \tstatic defaults() {\n  \t\treturn ABFieldStringDefaults;\n  \t}\n\n\n\n\t/*\n\t * @function propertiesComponent\n\t *\n\t * return a UI Component that contains the property definitions for this Field.\n\t *\n\t * @param {App} App the UI App instance passed around the Components.\n\t * @return {Component}\n\t */\n  \tstatic propertiesComponent(App) {\n  \t\treturn ABFieldStringComponent.component(App);\n  \t}\n\n\n\n\t///\n\t/// Instance Methods\n\t///\n\n\n\tisValid() {\n\n\t\tvar validator = super.isValid();\n\n\t\t// validator.addError('columnName', L('ab.validation.object.name.unique', 'Field columnName must be unique (#name# already used in this Application)').replace('#name#', this.name) );\n\n\t\treturn validator;\n\t}\n\n\n\t/**\n\t * @method toObj()\n\t *\n\t * properly compile the current state of this ABApplication instance\n\t * into the values needed for saving to the DB.\n\t *\n\t * Most of the instance data is stored in .json field, so be sure to\n\t * update that from all the current values of our child fields.\n\t *\n\t * @return {json}\n\t */\n\t// toObj () {\n\n\t// \tvar obj = super.toObj();\n\n\t// \t// obj.settings = this.settings;  // <--  super.toObj()\n\n\t// \treturn obj;\n\t// }\n\n\n\n\n\t///\n\t/// Working with Actual Object Values:\n\t///\n\n\t// return the grid column header definition for this instance of ABFieldString\n\tcolumnHeader (isObjectWorkspace) {\n\t\tvar config = super.columnHeader(isObjectWorkspace);\n\n\t\tconfig.editor = 'text';\n\t\tconfig.sort   = 'string'\n\n\t\treturn config;\n\t}\n\n\n\n\t/*\n\t * @function isMultilingual\n\t * does this field represent multilingual data?\n\t * @return {bool}\n\t */\n\tisMultilingual() {\n\t\treturn this.settings.supportMultilingual == 1;\n\t}\n\n\n\n}\n\n\n\nexport default ABFieldString;\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/classes/dataFields/ABFieldString.js","\n/*\n * AB Choose\n *\n * When choosing an initial application to work with, we can\n *   - select an application from a list  :  ab_choose_list\n *   - create an application from a form  :  ab_choose_form\n *\n */\n\n\nimport './ab_choose_list'\nimport './ab_choose_form'\n\nvar idBase = 'ab_choose';\nOP.Component.extend(idBase, function(App) {\n\n\n\tvar ids = {\n\t\tcomponent:App.unique(idBase + '_component')\n\t}\n\n\n\n\t// Define the external components used in this Component:\n\tvar AppList = OP.Component['ab_choose_list'](App);\n\tvar AppForm = OP.Component['ab_choose_form'](App);\n\n\n\t// This component's UI definition:\n\t// Application multi-views\n\tvar _ui = {\n\t\tview:\"multiview\",\n\t\tanimate:false,\n\t\tid: ids.component,\n\t\tcells: [\n\t\t\tAppList.ui,\n\t\t\tAppForm.ui\n\t\t]\n\t};\n\n\n\n\t// This component's Init definition:\n\tvar _init = function() {\n\n\t\tAppList.init();\n\t\tAppForm.init();\n\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t\t/**\n\t\t * @function transitionApplicationChooser\n\t\t *\n\t\t * Switch the AppBuilder UI to show the Application Chooser component.\n\t\t */\n\t\ttransitionApplicationChooser:function() {\n\t\t\t$$(ids.component).show();\n\t\t}\n\n\t}\n\n\n\n\tvar _logic = {\n\n\t}\n\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\n\t\tinit:_init,\n\t\tactions:_actions,\n\n\t\t_logic:_logic\t\t// Unit Testing\n\t}\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_choose.js","\n/*\n * AB Choose Form\n *\n * Display the form for creating a new Application.\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\tformHeader: L('ab.application.form.header', \"*Application Info\"),\n\t\tplaceholderName: L('ab.application.form.placeholderName', \"*Application name\"),\n\t\tplaceholderDescription: L('ab.application.form.placeholderDescription', \"*Application description\"),\n\t\tformDescription: L('ab.application.form.formDescription', \"*Description\"),\n\n\t\tsectionPermission: L('ab.application.form.sectionPermission', \"*Permission\"),\n\t\tpermissionHeader: L('ab.application.form.headerPermission',  \"*Who can use this app?\"),\n\t\tcreateNewRole: L('ab.application.form.createNewRoleButton', \"*Create new roll\"),\n\n\t\tinvalidName: L('ab.application.invalidName', \"*This application name is invalid\"),\n\t\tduplicateName: L('ab.application.duplicateName', \"*Name must be unique.\"),\n\n\t}\n}\n\n\nvar idBase = 'ab_choose_form';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\n\t\tform: App.unique(idBase + '_form'),\n\t\tappFormPermissionList: App.unique(idBase + '_permission'),\n\t\tappFormCreateRoleButton: App.unique(idBase + '_createRole'),\n\n\t\tsaveButton: App.unique(idBase + '_buttonSave')\n\t}\n\n\n\n\tvar _ui = {\n\n\t\tid: ids.component,\n\t\tresponsive:\"hide\",\n\t\tcols: [\n\t\t\t{\n\t\t\t\tmaxWidth: App.config.appListSpacerColMaxWidth,\n\t\t\t\tminWidth: App.config.appListSpacerColMinWidth,\n\t\t\t\twidth: App.config.appListSpacerColMaxWidth\n\t\t\t},\n\t\t\t{\n\t\t\t\tresponsiveCell:false,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmaxHeight: App.config.appListSpacerRowHeight,\n\t\t\t\t\t\thidden: App.config.hideMobile\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\t\tcols: [{ view: \"label\", label: labels.component.formHeader, fillspace: true }]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"form\",\n\t\t\t\t\t\tid: ids.form,\n\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t\telements: [\n\t\t\t\t\t\t\t//{ type: \"section\", template: '<span class=\"webix_icon fa-edit\" style=\"max-width:32px;\"></span>Information', margin: 0 },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: \"label\",\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tlabel: labels.common.formName,\n\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t\tplaceholder: labels.component.placeholderName,\n\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonChange: function (newValue, oldValue) {\n\t\t\t\t\t\t\t\t\t\t_logic.permissionRenameRole(newValue, oldValue);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ height: App.config.smallSpacer },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: \"description\",\n\t\t\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\t\t\t// label: labels.common.formDescription,\n\t\t\t\t\t\t\t\tlabel: \"Description\",\n\t\t\t\t\t\t\t\tlabelAlign: \"left\",\n\t\t\t\t\t\t\t\tlabelWidth: 100,\n\t\t\t\t\t\t\t\tplaceholder: labels.component.placeholderDescription,\n\t\t\t\t\t\t\t\theight: 100\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ height: App.config.smallSpacer },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\t\t\t\tcss: \"ab-toolbar-submenu\",\n\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttemplate: labels.component.permissionHeader,\n\t\t\t\t\t\t\t\t\t\ttype: 'header',\n\t\t\t\t\t\t\t\t\t\tborderless: true\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"toggle\",\n\t\t\t\t\t\t\t\t\t\tid: ids.appFormCreateRoleButton,\n\t\t\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\t\t\talign: \"right\",\n\t\t\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\t\t\tcss: \"ab-standard-button\",\n\t\t\t\t\t\t\t\t\t\toffIcon: \"square-o\",\n\t\t\t\t\t\t\t\t\t\tonIcon: \"check-square-o\",\n\t\t\t\t\t\t\t\t\t\tlabel: labels.component.createNewRole,\n\t\t\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\t\t\tonItemClick: function (id, e) {\n\t\t\t\t\t\t\t\t\t\t\t\t_logic.createRoleButtonClick();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: \"permissions\",\n\t\t\t\t\t\t\t\tid: ids.appFormPermissionList,\n\t\t\t\t\t\t\t\tview: \"list\",\n\t\t\t\t\t\t\t\t//height: 130,\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t\t\t\tcss: \"ab-app-form-permission\",\n\t\t\t\t\t\t\t\ttemplate: \"{common.markCheckbox()} #name#\",\n\t\t\t\t\t\t\t\ttype:{\n\t\t\t\t\t\t\t\t\tmarkCheckbox:function(obj ){\n\t\t\t\t\t\t\t\t\t\treturn \"<span class='check webix_icon fa-\"+(obj.markCheckbox?\"check-\":\"\")+\"square-o'></span>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonItemClick: function (id, e, node) {\n\t\t\t\t\t\t\t\t\t\t_logic.permissionClick(id, e, node);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ height: App.config.smallSpacer },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmargin: 5,\n\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t{ fillspace: true },\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\t\tvalue: labels.common.cancel,\n\t\t\t\t\t\t\t\t\t\twidth: App.config.buttonWidthSmall,\n\t\t\t\t\t\t\t\t\t\tcss: \"ab-cancel-button\",\n\t\t\t\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t\t\t\t_logic.cancel();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tid: ids.saveButton,\n\t\t\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\t\t\tlabel: labels.common.save,\n\t\t\t\t\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\t\t\t\t\twidth: App.config.buttonWidthSmall,\n\t\t\t\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t\t\t\t_logic.buttonSaveClick();\n\t\t\t\t\t\t\t\t\t\t} // end click()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tmaxHeight: App.config.appListSpacerRowHeight,\n\t\t\t\t\t\thidden: App.config.hideMobile\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tmaxWidth: App.config.appListSpacerColMaxWidth,\n\t\t\t\tminWidth: App.config.appListSpacerColMinWidth,\n\t\t\t\twidth: App.config.appListSpacerColMaxWidth\n\t\t\t}\n\t\t]\n\t};\n\n\tconst FormFields = ['label', 'description'];\n\n\n\n\tvar _init = function() {\n\t\twebix.extend($$(ids.form), webix.ProgressBar);\n\t\twebix.extend($$(ids.appFormPermissionList), webix.ProgressBar);\n\t}\n\n\n\n\tvar _logic = {\n\n\n\t\t/**\n\t\t * @function applicationCreate\n\t\t *\n\t\t * Step through the process of creating an ABApplication with the\n\t\t * current state of the Form.\n\t\t *\n\t\t * @param {obj} values \tcurrent value hash of the form values.\n\t\t */\n\t\tapplicationCreate: function(values) {\n\n\t\t\tvar newApp = {\n\t\t\t\tname: values.label,\n\t\t\t\tlabel: values.label,\n\t\t\t\tdescription: values.description\n\t\t\t};\n\n\t\t\tasync.waterfall([\n\t\t\t\tfunction (cb) {\n\t\t\t\t\t// Create application data\n\t\t\t\t\tABApplication.create(newApp)\n\t\t\t\t\t\t.then(function (result) {\n\t\t\t\t\t\t\tcb(null, result);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(cb);\n\t\t\t\t},\n\t\t\t\tfunction (createdApp, cb) {\n\t\t\t\t\t_logic.permissionSave(createdApp)\n\t\t\t\t\t\t.then(function () { cb(); })\n\t\t\t\t\t\t.catch(cb)\n\t\t\t\t}\n\t\t\t], function (err) {\n\t\t\t\t_logic.formReady();\n\n\t\t\t\tif (err) {\n\t\t\t\t\twebix.message({\n\t\t\t\t\t\ttype: \"error\",\n\t\t\t\t\t\ttext: labels.common.createErrorMessage.replace('{0}', values.label)\n\t\t\t\t\t});\n\n\t\t\t\t\tAD.error.log('App Builder : Error create application data', { error: err });\n\n\t\t\t\t\t_logic.buttonSaveEnable();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tApp.actions.transitionApplicationList();\n\n\t\t\t\twebix.message({\n\t\t\t\t\ttype: \"success\",\n\t\t\t\t\ttext: labels.common.createSuccessMessage.replace('{0}', values.label)\n\t\t\t\t});\n\n\t\t\t\t_logic.buttonSaveEnable();\n\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * @function applicationUpdate\n\t\t *\n\t\t * Step through the process of updating an ABApplication with the\n\t\t * current state of the Form.\n\t\t *\n\t\t * @param {ABApplication} application\n\t\t */\n\t\tapplicationUpdate: function(Application) {\n\t\t\tvar values = _logic.formValues();\n\n\t\t\tasync.waterfall([\n\t\t\t\tfunction (next) {\n\t\t\t\t\t_logic.permissionSave(Application)\n\t\t\t\t\t\t.then(function (result) { next(null, result); })\n\t\t\t\t\t\t.catch(next);\n\t\t\t\t},\n\t\t\t\tfunction (app_role, next) {\n\t\t\t\t\t// Update application data\n\t\t\t\t\tApplication.label = values.label;\n\t\t\t\t\tApplication.description = values.description;\n\n\t\t\t\t\tif (app_role && app_role.id)\n\t\t\t\t\t\tApplication.role = app_role.id;\n\t\t\t\t\telse\n\t\t\t\t\t\tApplication.role = null;\n\n\t\t\t\t\tApplication.save()\n\t\t\t\t\t\t.then(function () {\n\t\t\t\t\t\t\tnext();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(next)\n\n\t\t\t\t}\n\t\t\t], function (err) {\n\n\t\t\t\t_logic.formReady();\n\t\t\t\t_logic.buttonSaveEnable();\n\t\t\t\tif (err) {\n\t\t\t\t\twebix.message({\n\t\t\t\t\t\ttype: \"error\",\n\t\t\t\t\t\ttext: labels.common.updateErrorMessage.replace('{0}', Application.label)\n\t\t\t\t\t});\n\t\t\t\t\tAD.error.log('App Builder : Error update application data', { error: err });\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tApp.actions.transitionApplicationList();\n\n\t\t\t\twebix.message({\n\t\t\t\t\ttype: \"success\",\n\t\t\t\t\ttext: labels.common.updateSucessMessage.replace('{0}', Application.label)\n\t\t\t\t});\n\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * @function buttonSaveClick\n\t\t *\n\t\t * Process the user clicking on the [Save] button.\n\t\t */\n\t\tbuttonSaveClick: function() {\n\n\t\t\t_logic.buttonSaveDisable();\n\t\t\t_logic.formBusy();\n\n\t\t\t// if there is a selected Application, then this is an UPDATE\n\t\t\tvar updateApp = App.actions.getSelectedApplication();\n\t\t\tif (updateApp) { \n\n\t\t\t\tif (_logic.formValidate('update')) {\n\n\t\t\t\t\t_logic.applicationUpdate(updateApp);\n\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else { \n\n\t\t\t\t// else this is a Create\n\t\t\t\tif (_logic.formValidate('add')) {\n\n\t\t\t\t\t_logic.applicationCreate(_logic.formValues());\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\t\n\t\t},\n\n\t\t/**\n\t\t * @function buttonSaveDisable\n\t\t *\n\t\t * Disable the save button.\n\t\t */\n\t\tbuttonSaveDisable:function() {\n\t\t\t$$(ids.saveButton).disable();\n\t\t},\n\n\n\t\t/**\n\t\t * @function buttonSaveEnable\n\t\t *\n\t\t * Re-enable the save button.\n\t\t */\n\t\tbuttonSaveEnable:function() {\n\t\t\t$$(ids.saveButton).enable();\n\t\t},\n\n\n\t\t/**\n\t\t * @function cancel\n\t\t *\n\t\t * Cancel the current Form Operation and return us to the AppList.\n\t\t */\n\t\tcancel: function() {\n\n\t\t\t_logic.formReset();\n\t\t\tApp.actions.transitionApplicationList();\n\t\t},\n\n\n\t\t/**\n\t\t * @function createRoleButtonClick\n\t\t *\n\t\t * The user clicked the [Create Role] button.  Update the UI and add a\n\t\t * unique Application permission to our list.\n\t\t */\n\t\tcreateRoleButtonClick: function() {\n\n\t\t\tif ($$(ids.appFormCreateRoleButton).getValue()) {\n\n// TODO: if not called from anywhere else, then move the name gathering into .permissionAddNew()\n\t\t\t\t// Add new app role\n\t\t\t\tvar appName = $$(ids.form).elements[\"label\"].getValue();\n\t\t\t\t_logic.permissionAddNew(appName);\n\t\t\t}\n\t\t\telse { \n\t\t\t\t// Remove app role\n\t\t\t\t_logic.permissionRemoveNew();\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * @function formBusy\n\t\t *\n\t\t * Show the progress indicator to indicate a Form operation is in\n\t\t * progress.\n\t\t */\n\t\tformBusy: function() {\n\n\t\t\t$$(ids.form).showProgress({ type: 'icon' });\n\t\t},\n\n\n\t\t/**\n\t\t * @function formPopulate()\n\t\t *\n\t\t * populate the form values from the given ABApplication\n\t\t *\n\t\t * @param {ABApplication} application  instance of the ABApplication\n\t\t */\n\t\tformPopulate: function(application) {\n\n\t\t\tvar Form = $$(ids.form);\n\n\t\t\t// Populate data to form\n\t\t\tif (application) {\n\t\t\t\tFormFields.forEach(function(f){\n\t\t\t\t\tif (Form.elements[f]) {\n\t\t\t\t\t\tForm.elements[f].setValue(application[f]);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t// _logic.permissionPopulate(application);\n\n\t\t},\n\n\n\t\t/**\n\t\t * @function formReady()\n\t\t *\n\t\t * remove the busy indicator from the form.\n\t\t */\n\t\tformReady: function() {\n\t\t\t$$(ids.form).hideProgress();\n\t\t},\n\n\n\t\t/**\n\t\t * @function formReset()\n\t\t *\n\t\t * return the form to an empty state.\n\t\t */\n\t\tformReset: function() {\n\n\t\t\t$$(ids.form).clear();\n\t\t\t$$(ids.form).clearValidation();\n\t\t\t// $$(self.webixUiids.appFormPermissionList).clearValidation();\n\t\t\t// $$(self.webixUiids.appFormPermissionList).clearAll();\n\t\t\t// $$(self.webixUiids.appFormCreateRoleButton).setValue(0);\n\t\t},\n\n\n\t\t/**\n\t\t * @function formValidate()\n\t\t *\n\t\t * validate the form values.\n\t\t *\n\t\t * @return {bool}  true if all values pass validation.  false otherwise.\n\t\t */\n\t\tformValidate:function(op) {\n\t\t\t// op : ['add', 'update', 'destroy']\n\n\t\t\tvar Form = $$(ids.form);\n\t\t\tif (!Form.validate()) {\n\t\t\t\t// TODO : Error message\n\n\t\t\t\t_logic.buttonSaveEnable();\n\t\t\t\treturn false;\n\t\t\t}\n\n\n\t\t\tvar validator = ABApplication.isValid(op, Form.getValues());\n\t\t\tif (validator.fail()) {\n\t\t\t\tvalidator.updateForm(Form);\n\t\t\t\t_logic.formReady();\n\t\t\t\t_logic.buttonSaveEnable();\n\t\t\t\treturn false;\n\t\t\t}\n\n\n\n\t\t\t// var appName = $$(ids.form).elements['label'].getValue(),\n\t\t\t// \tappDescription = $$(ids.form).elements['description'].getValue();\n\n\t\t\t// if (!inputValidator.validate(appName)) {\n\t\t\t// \t_logic.buttonSaveEnable();\n\t\t\t// \treturn false;\n\t\t\t// }\n\n\t\t\t// // Prevent duplicate application name\n\t\t\t// if (self.data.filter(function (app) { return app.name.trim().toLowerCase() == appName.trim().replace(/ /g, '_').toLowerCase(); }).length > 0) {\n\t\t\t// \tOP.Dialog.Alert({\n\t\t\t// \t\ttitle: labels.component.invalidName,\n\t\t\t// \t\ttext: labels.component.duplicateName.replace(\"#appName#\", appName),\n\t\t\t// \t\tok: labels.common.ok\n\t\t\t// \t});\n\n\t\t\t// \t$$(ids.form).elements['label'].focus();\n\t\t\t// \t_logic.buttonSaveEnable();\n\t\t\t// \treturn false;\n\t\t\t// }\n\n\t\t\treturn true;\n\t\t},\n\n\n\t\t/**\n\t\t * @function formValues()\n\t\t *\n\t\t * return an object hash of name:value pairs of the current Form.\n\t\t *\n\t\t * @return {obj}\n\t\t */\n\t\tformValues: function() {\n\t\t\t// return the current values of the Form elements.\n\t\t\treturn $$(ids.form).getValues();\n\n\t\t},\n\n\n\t\t/**\n\t\t * @function permissionAddNew\n\t\t *\n\t\t * create a new permission entry based upon the current Application.label\n\t\t *\n\t\t * This not only adds it to our Permission List, but also selects it.\n\t\t *\n\t\t * @param {string} appName\tThe Application.label of the current Application\n\t\t */\n\t\tpermissionAddNew: function(appName) {\n\n\t\t\t// add new role entry\n\t\t\t$$(ids.appFormPermissionList).add({\n\t\t\t\tid: 'newRole',\n\t\t\t\tname: _logic.permissionName(appName),\n\t\t\t\tisApplicationRole: true,\n\t\t\t\tmarkCheckbox: 1\n\t\t\t}, 0);\n\n\n\t\t\t// Select new role\n\t\t\tvar selectedIds = $$(ids.appFormPermissionList).getSelectedId(true);\n\t\t\tselectedIds.push('newRole');\n\t\t\t$$(ids.appFormPermissionList).select(selectedIds);\n\n\t\t},\n\n\n\t\t/**\n\t\t * @function permissionClick\n\t\t *\n\t\t * Process when a permission entry in the list is clicked.\n\t\t */\n\t\tpermissionClick: function (id, e, node) {\n\t\t\t\n\n\t\t\tvar List = $$(ids.appFormPermissionList);\n\n\t\t\tvar item = List.getItem(id); \n\n\t\t\tif (List.getItem(id).isApplicationRole) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (List.isSelected(id)) {\n\t\t\t\titem.markCheckbox = 0; \n\t\t\t\tList.unselect(id);\n\t\t\t}\n\t\t\telse {\n\t\t\t\titem.markCheckbox = 1; \n\t\t\t\tvar selectedIds = List.getSelectedId();\n\n\t\t\t\tif (typeof selectedIds === 'string' || !isNaN(selectedIds)) {\n\t\t\t\t\tif (selectedIds)\n\t\t\t\t\t\tselectedIds = [selectedIds];\n\t\t\t\t\telse\n\t\t\t\t\t\tselectedIds = [];\n\t\t\t\t}\n\n\t\t\t\tselectedIds.push(id);\n\n\t\t\t\tList.select(selectedIds);\n\n\t\t\t\tList.updateItem(id, item); \n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * @function permissionName\n\t\t *\n\t\t * returns a formatted name for a Permission Role based upon the provided Application.label\n\t\t *\n\t\t * @param {string} appName\tthe current value of the Application.label\n\t\t * @return {string} \tPermission Role Name.\n\t\t */\n\t\tpermissionName: function(appName) {\n\t\t\treturn appName  + \" Application Role\";\n\t\t},\n\n\n\t\t/**\n\t\t * @function permissionPopulate\n\t\t *\n\t\t * fill out the Permission list\n\t\t *\n\t\t * @param {ABApplication} application\tthe current ABApplication we are editing\n\t\t */\n\t\tpermissionPopulate: function(application) {\n\n\t\t\tvar PermForm = $$(ids.appFormPermissionList);\n\t\t\t// Get user's roles\n\t\t\tPermForm.showProgress({ type: 'icon' });\n\t\t\tasync.waterfall([\n\t\t\t\tfunction (next) {\n\t\t\t\t\tAD.comm.service.get({ url: '/app_builder/user/roles' })\n\t\t\t\t\t\t.fail(function (err) { next(err); })\n\t\t\t\t\t\t.done(function (roles) {\n\n\t\t\t\t\t\t\t// scan the roles and determine if any of them have been created\n\t\t\t\t\t\t\t// after the current Application.name:\n\t\t\t\t\t\t\tvar parsedRoles = roles.map((r) => {\n\t\t\t\t\t\t\t\tif (application) {\n\t\t\t\t\t\t\t\t\tif (r.name == _logic.permissionName(application.name.split('_').join(' '))) {\n\t\t\t\t\t\t\t\t\t\tr.isApplicationRole = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn r;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tnext(null, parsedRoles);\n\t\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tfunction (available_roles, next) {\n\t\t\t\t\tif (application && application.id) {\n\t\t\t\t\t\tapplication.getPermissions()\n\t\t\t\t\t\t\t.then(function (selected_role_ids) {\n\t\t\t\t\t\t\t\tnext(null, available_roles, selected_role_ids);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(function (err) { next(err); });\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tnext(null, available_roles, []);\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tfunction (available_roles, selected_role_ids, next) {\n\n\t\t\t\t\t// mark the role(s) in available_roles that is tied\n\t\t\t\t\t// this application:\n\t\t\t\t\tif (application && application.role) {\n\t\t\t\t\t\tavailable_roles.forEach(function (r) {\n\t\t\t\t\t\t\tif (r.id == (application.role.id || application.role)) {\n\t\t\t\t\t\t\t\tr.isApplicationRole = true;\n\t\t\t\t\t\t\t\tr.markCheckbox = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sort permission list\n\t\t\t\t\tavailable_roles.sort(function (a, b) {\n\t\t\t\t\t\treturn (a.isApplicationRole === b.isApplicationRole) ? 0 : a.isApplicationRole ? -1 : 1;\n\t\t\t\t\t});\n\n\t\t\t\t\t// reload list from our available_roles\n\t\t\t\t\tPermForm.clearAll();\n\t\t\t\t\tPermForm.parse(available_roles);\n\n\t\t\t\t\t// mark which roles have already been selected\n\t\t\t\t\tif (selected_role_ids && selected_role_ids.length > 0) {\n\t\t\t\t\t\t// Select permissions\n\t\t\t\t\t\tPermForm.select(selected_role_ids);\n\t\t\t\t\t\tavailable_roles.forEach(function (r) {\n\t\t\t\t\t\t\tif (selected_role_ids.indexOf(r.id) > -1) {\n\t\t\t\t\t\t\t\tvar item = $$(ids.appFormPermissionList).getItem(r.id);\n\t\t\t\t\t\t\t\titem.markCheckbox = 1;\n\t\t\t\t\t\t\t\t$$(ids.appFormPermissionList).updateItem(r.id, item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Select create role application button\n\t\t\t\t\t\tvar markCreateButton = available_roles.filter(function (r) { return r.isApplicationRole; }).length > 0 ? 1 : 0;\n\t\t\t\t\t\t$$(ids.appFormCreateRoleButton).setValue(markCreateButton);\n\t\t\t\t\t}\n\n\t\t\t\t\tnext();\n\t\t\t\t}\n\t\t\t], function (err) {\n\t\t\t\tif (err) {\n\t\t\t\t\twebix.message(err.message);\n\t\t\t\t}\n\n\t\t\t\tPermForm.hideProgress();\n\n\t\t\t});\n\n\t\t\t// return appName  + \" Application Role\";\n\t\t},\n\n\n\t\t/**\n\t\t * @function permissionRemoveNew()\n\t\t *\n\t\t * Intended to be called when the USER unselects the option to create a Permission\n\t\t * for this Application.\n\t\t *\n\t\t * We remove any Permission Role created for this Application.\n\t\t */\n\t\tpermissionRemoveNew: function() {\n\n\t\t\t// find any roles that are put here from our application form:\n\t\t\tvar appRoles = $$(ids.appFormPermissionList).find(function (perm) { return perm.isApplicationRole; });\n\n\t\t\t// remove them:\n\t\t\tappRoles.forEach(function (r) {\n\t\t\t\t$$(ids.appFormPermissionList).remove(r.id);\n\t\t\t});\n\t\t},\n\n\n\t\t/*\n\t\t * permissionRenameRole\n\t\t *\n\t\t * When the name of the Appliction changes, change the Name of the Permission as well.\n\t\t *\n\t\t * @param {string} newValue  the current name of the application\n\t\t * @param {string} oldValue  the previous name of the application\n\t\t */\n\t\tpermissionRenameRole:function( newValue, oldValue) {\n\n\t\t\tvar editRole = $$(ids.appFormPermissionList).find(function (d) { return d.name === _logic.permissionName(oldValue); });\n\n\t\t\teditRole.forEach(function (r) {\n\t\t\t\tvar editItem = $$(ids.appFormPermissionList).getItem(r.id);\n\t\t\t\teditItem.name = _logic.permissionName(newValue);\n\n\t\t\t\t$$(ids.appFormPermissionList).updateItem(editItem.id, editItem);\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * @function permissionSave()\n\t\t *\n\t\t * step through saving the current Permission Settings and associating\n\t\t * them with the current Application.\n\t\t *\n\t\t * @param {ABApplication} App  \tThe current Application we are working with.\n\t\t * @return {Promise}\t\t\t.resolve( {Permission} ) if one is created for this App\n\t\t */\n\t\tpermissionSave: function (app) {\n//// REFACTOR:\n// this step implies that ab_choose_form understands the intracies of how\n// ABApplication and Permissions work.\n\t\t\treturn new Promise(\n\t\t\t\t(resolve, reject) => {\n\n\t\t\t\t\tvar saveRoleTasks = [],\n\t\t\t\t\t\tappRole = null;\n\n\t\t\t\t\t//// Process the option to create a newRole For this Application:\n\n\t\t\t\t\t// if the button is set\n\t\t\t\t\tif ($$(ids.appFormCreateRoleButton).getValue()) {\n\n\t\t\t\t\t\t// check to see if we already have a permission that isApplicationRole\n\t\t\t\t\t\tvar selectedPerms = $$(ids.appFormPermissionList).getSelectedItem(true);\n\t\t\t\t\t\tselectedPerms = selectedPerms.filter((perm) => { return perm.isApplicationRole; })\n\n\t\t\t\t\t\t// if not, then create one:\n\t\t\t\t\t\tif (selectedPerms.length == 0) {\n\n\t\t\t\t\t\t\t// Create new role for application\n\t\t\t\t\t\t\tsaveRoleTasks.push(function (cb) {\n\t\t\t\t\t\t\t\tapp.createPermission()\n\t\t\t\t\t\t\t\t\t.then(function (result) {\n\n\t\t\t\t\t\t\t\t\t\t// remember the Role we just created\n\t\t\t\t\t\t\t\t\t\tappRole = result;\n\t\t\t\t\t\t\t\t\t\tcb();\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch(cb)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Delete any existing application roles\n\t\t\t\t\t\tsaveRoleTasks.push(function (cb) {\n\t\t\t\t\t\t\tapp.deletePermission()\n\t\t\t\t\t\t\t\t.then(function () { cb(); })\n\t\t\t\t\t\t\t\t.catch(cb)\n\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t//// Now process any additional roles:\n\n\t\t\t\t\t// get array of selected permissions that are not our newRole\n\t\t\t\t\tvar permItems = $$(ids.appFormPermissionList).getSelectedItem(true);\n\t\t\t\t\tpermItems = permItems.filter( function (item) { return item.id !== 'newRole'; }); // Remove new role item\n\n\n\t\t\t\t\t// Make sure Application is linked to selected permission items:\n\t\t\t\t\tsaveRoleTasks.push(function (cb) {\n\n\t\t\t\t\t\t// ok, so we removed the 'newRole' entry, but we might\n\t\t\t\t\t\t// have created an entry for it earlier, if so, add in\n\t\t\t\t\t\t// the created one here:\n\t\t\t\t\t\tif ($$(ids.appFormCreateRoleButton).getValue() && appRole) {\n\n\t\t\t\t\t\t\t// make sure it isn't already in there:\n\t\t\t\t\t\t\tvar appRoleItem = permItems.filter( function (item) { return item.id == appRole.id; });\n\t\t\t\t\t\t\tif (!appRoleItem || appRoleItem.length < 1) {\n\n\t\t\t\t\t\t\t\t// if not, add it :\n\t\t\t\t\t\t\t\tpermItems.push({\n\t\t\t\t\t\t\t\t\tid: appRole.id,\n\t\t\t\t\t\t\t\t\tisApplicationRole: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t// Assign Role Permissions\n\t\t\t\t\t\tapp.assignPermissions(permItems)\n\t\t\t\t\t\t\t.then(function () { cb(); })\n\t\t\t\t\t\t\t.catch(cb)\n\t\t\t\t\t});\n\n\n\n\t\t\t\t\tasync.series(saveRoleTasks, function(err, results) {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// we return the instance of the newly created Permission.\n\t\t\t\t\t\t\tresolve(appRole);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\n\n//// REFACTOR QUESTION:\n// why are we updating the app.permissions with this data structure?\n// where is this data structure being used?\n// Earlier we are using another structure (permissionAddNew()) ... how is that related to this?\n\n\t\t\t\t\t\t\t// // Final task\n\t\t\t\t\t\t\t// saveRoleTasks.push(function (cb) {\n\t\t\t\t\t\t\t// \t// Update store app data\n\t\t\t\t\t\t\t// \tvar applicationData = self.data.filter(function (d) { return d.id == app.id; });\n\t\t\t\t\t\t\t// \tapplicationData.forEach(function (app) {\n\t\t\t\t\t\t\t// \t\tapp.attr('permissions', $.map(permItems, function (item) {\n\t\t\t\t\t\t\t// \t\t\treturn {\n\t\t\t\t\t\t\t// \t\t\t\tapplication: app.id,\n\t\t\t\t\t\t\t// \t\t\t\tpermission: item.id,\n\t\t\t\t\t\t\t// \t\t\t\tisApplicationRole: item.isApplicationRole\n\t\t\t\t\t\t\t// \t\t\t}\n\t\t\t\t\t\t\t// \t\t}));\n\t\t\t\t\t\t\t// \t});\n\n\t\t\t\t\t\t\t// \tq.resolve(appRole);\n\t\t\t\t\t\t\t// \tcb();\n\t\t\t\t\t\t\t// })\n\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show the Form Component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\t$$(ids.component).show();\n\t\t}\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t\t// initiate a request to create a new Application\n\t\ttransitionApplicationForm:function(application){\n\t\t\t\n\t\t\t// if no application is given, then this should be a [create] operation,\n\n\t\t\t// so clear our AppList\n\t\t\tif ('undefined' == typeof application) {\n\t\t\t\tApp.actions.unselectApplication();\n\t\t\t}\n\n\t\t\t// now prepare our form:\n\t\t\t_logic.formReset();\n\t\t\tif (application) {\n\t\t\t\t// populate Form here:\n\t\t\t\t_logic.formPopulate(application);\n\t\t\t}\n\t\t\t_logic.permissionPopulate(application);\n\t\t\t_logic.show();\n\t\t}\n\n\t}\n\n\n\treturn {\n\t\tui: _ui,\n\t\tinit: _init,\n\t\tactions:_actions,\n\n\t\t_logic: _logic\n\t}\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_choose_form.js","\n/*\n * AB Choose List\n *\n * Display a list of Applications for the user to select.\n *\n */\nimport ABApplication from \"../classes/ABApplication\"\nimport \"./ab_choose_list_menu\"\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\n\nvar labels = {\n\n\tcomponent: {\n\t\ttitle: L('ab.application.application', '*Application'),\n\n\t\tcreateNew: L('ab.application.createNew', '*Add new application'),\n\t\tnoApplication: L('ab.application.noApplication', \"*There is no application data\")\t\t\t\t\t\n\t}\n}\n\n\nvar idBase = 'ab_choose_list';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\tvar ids = {\n\t\tcomponent:App.unique(idBase + '_component'),\n\n\t\tuploader:App.unique(idBase + '_uploader'),\n\t\tlist:App.unique(idBase + '_list'),\n\t\ttoolBar:App.unique(idBase + '_toolbar'),\n\t\tbuttonCreateNewApplication: App.unique(idBase + '_buttonNewApp')\n\t}\n\n\tvar MenuComponent = OP.Component['ab_choose_list_menu'](App);\n\tvar PopupMenu = webix.ui(MenuComponent.ui);\n\tPopupMenu.hide();\n\n\tvar _ui = {\n\n\t\tid: ids.component,\n\t\tresponsive:\"hide\",\n\n\t\tcols: [\n\t\t\t{\n\t\t\t\tmaxWidth: App.config.appListSpacerColMaxWidth,\n\t\t\t\tminWidth: App.config.appListSpacerColMinWidth,\n\t\t\t\twidth: App.config.appListSpacerColMaxWidth\n\t\t\t},\n\t\t\t{\n\t\t\t\tresponsiveCell:false,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmaxHeight: App.config.appListSpacerRowHeight,\n\t\t\t\t\t\thidden: App.config.hideMobile\n\t\t\t\t\t},\n\t\t\t\t\t//\n\t\t\t\t\t// ToolBar\n\t\t\t\t\t//\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"toolbar\",\n\t\t\t\t\t\tid: ids.toolBar,\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{ view: \"label\", label:labels.component.title, fillspace: true },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: ids.buttonCreateNewApplication,\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tlabel: labels.component.createNew,\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\ticon: \"plus\",\n\t\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\t\t// Inform our Chooser we have a request to create an Application:\n\t\t\t\t\t\t\t\t\tApp.actions.transitionApplicationForm( /* leave empty for a create */ );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"uploader\",\n\t\t\t\t\t\t\t\tid: ids.uploader,\n\t\t\t\t\t\t\t\tlabel: labels.common.import,\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tupload: '/app_builder/appJSON',\n\t\t\t\t\t\t\t\tmultiple: false,\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\ticon: \"upload\",\n\t\t\t\t\t\t\t\tautosend: true,\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonAfterFileAdd: function () {\n\t\t\t\t\t\t\t\t\t\t_logic.onAfterFileAdd();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonFileUpload: function (item, response) {\n\t\t\t\t\t\t\t\t\t\t_logic.onFileUpload(item, response);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonFileUploadError: function (details, response) {\n\t\t\t\t\t\t\t\t\t\t_logic.onFileUploadError(details, response);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\n\n\t\t\t\t\t//\n\t\t\t\t\t// The List of Applications\n\t\t\t\t\t//\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ids.list,\n\t\t\t\t\t\tview: \"list\",\n\t\t\t\t\t\tcss: 'ab-app-select-list',\n\t\t\t\t\t\ttemplate: function (obj, common) {\n\t\t\t\t\t\t\treturn _logic.templateListItem(obj, common);\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: {\n\t\t\t\t\t\t\theight: App.config.appListRowHeight, // Defines item height\n\t\t\t\t\t\t\ticonGear: \"<span class='webix_icon fa-cog'></span>\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselect: false,\n\t\t\t\t\t\tonClick: {\n\t\t\t\t\t\t\t\"ab-app-list-item\": function (ev, id, trg) {\n\t\t\t\t\t\t\t\treturn _logic.onClickListItem(ev, id, trg);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"ab-app-list-edit\": function (ev, id, trg) {\n\t\t\t\t\t\t\t\treturn _logic.onClickListEdit(ev, id, trg);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tmaxHeight: App.config.appListSpacerRowHeight,\n\t\t\t\t\t\thidden: App.config.hideMobile\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tmaxWidth: App.config.appListSpacerColMaxWidth,\n\t\t\t\tminWidth: App.config.appListSpacerColMinWidth,\n\t\t\t\twidth: App.config.appListSpacerColMaxWidth\n \t\t\t}\n\t\t]\n\t}\n\n\n\n\tvar _data={};\n\n\n\tvar _logic = {\n\n\n\t\t/**\n\t\t * @function busy\n\t\t *\n\t\t * show a busy indicator on our App List\n\t\t */\n\t\tbusy: function() {\n\t\t\tif ($$(ids.list).showProgress)\n\t\t\t\t$$(ids.list).showProgress({ icon: 'cursor' });\n\t\t},\n\n\n\t\t/**\n\t\t * @function loadData\n\t\t *\n\t\t * Load all the ABApplications and display them in our App List\n\t\t */\n\t\tloadData:function(){\n\n\t\t\t// Get applications data from the server\n\t\t\t_logic.busy();\n\t\t\tABApplication.allApplications()\n\t\t\t\t.then(function (data) {\n\n\t\t\t\t\t_logic.ready();\n\n\t\t\t\t\t// make sure our overlay is updated when items are added/removed\n\t\t\t\t\t// from our data list.\n\t\t\t\t\tdata.attachEvent(\"onAfterAdd\", function(id, index){\n\t\t\t\t\t    _logic.refreshOverlay();\n\t\t\t\t\t});\n\n\t\t\t\t\tdata.attachEvent(\"onAfterDelete\", function(id){\n\t\t\t\t\t\t_logic.refreshOverlay();\n\t\t\t\t\t})\n\n\t\t\t\t\t_data.listApplications = data;\n\n\t\t\t\t\t_logic.refreshList();\n\t\t\t\t})\n\t\t\t\t.catch(function (err) {\n\t\t\t\t\t_logic.ready();\n\t\t\t\t\twebix.message({\n\t\t\t\t\t\ttype: \"error\",\n\t\t\t\t\t\ttext: err\n\t\t\t\t\t});\n\t\t\t\t\tAD.error.log('App Builder : Error loading application data', { error: err });\n\t\t\t\t})\n\t\t},\n\n\n\t\t/**\n\t\t * @function onAfterFileAdd\n\t\t *\n\t\t * UI updates for when a file upload is initiated\n\t\t */\n\t\tonAfterFileAdd: function () {\n\t\t\t$$(ids.uploader).disable();\n\t\t\t_logic.busy();\n\t\t},\n\n\n\t\t/**\n\t\t * @function onClickListEdit\n\t\t *\n\t\t * UI updates for when the edit gear is clicked\n\t\t */\n\t\tonClickListEdit: function(ev, id, trg) {\n\n\t\t\t// Show menu\n\t\t\tPopupMenu.show(trg);\n\t\t\t$$(ids.list).select(id);\n\n\t\t\treturn false; // block default behavior\n\t\t},\n\n\n\t\t/**\n\t\t * @function onClickListItem\n\t\t *\n\t\t * An item in the list is selected. So update the workspace with that \n\t\t * object.\n\t\t */\n\t\tonClickListItem: function(ev, id, trg) {\n\t\t\t\t\t\t\t\t\n\t\t\t_logic.busy();\n\n\t\t\t$$(ids.list).select(id);\n\n\t\t\tvar selectedApp = $$(ids.list).getItem(id);\n\n\t\t\tif (selectedApp) {\n\n\t\t\t\t_logic.ready();\n\n\t\t\t\t// We've selected an Application to work with\n\t\t\t\tApp.actions.transitionWorkspace( selectedApp );\n\t\t\t}\n\n\t\t\treturn false; // block default behavior\n\t\t},\n\n\n\t\t/**\n\t\t * @function onFileUpload\n\t\t *\n\t\t * The File Upload process finished.\n\t\t */\n\t\tonFileUpload: function (item, response) {\n\t\t\t_logic.loadData(); // refresh app list\n\t\t\t$$(ids.uploader).enable();\n            _logic.ready();\n        },\n\n\n\t\t/**\n\t\t * @function onFileUploadError\n\t\t *\n\t\t * The File Upload process exited with an error.\n\t\t */\n        onFileUploadError: function(details, response) {\n\n\t\t\tvar errorMessage = 'Error: ' + (response && response.message);\n\t\t\tOP.Dialog.Alert({\n\t\t\t\ttext: errorMessage\n\t\t\t});\n\t\t\t// webix.message({\n\t\t\t// \ttype: 'error',\n\t\t\t// \ttext: errorMessage\n\t\t\t// });\n\t\t\t_logic.loadData(); // refresh app list\n\t\t\t$$(ids.uploader).enable();\n            _logic.ready();\n        },\n\n\n\t\t/**\n\t\t * @function refreshOverlay\n\t\t *\n\t\t * If we have no items in our list, display a Message.\n\t\t */\n\t\trefreshOverlay: function() {\n\t\t\tvar appList = $$(ids.list);\n\n\t\t\tif (!appList.count()) //if no data is available\n\t\t\t\tappList.showOverlay(labels.component.noApplication);\n\t\t\telse\n\t\t\t\tappList.hideOverlay();\n\t\t},\n\n\n\t\t/**\n\t\t * @function ready\n\t\t *\n\t\t * remove the busy indicator on our App List\n\t\t */\n\t\tready: function() {\n\t\t\tif ($$(ids.list).hideProgress)\n\t\t\t\t$$(ids.list).hideProgress();\n\t\t},\n\n\n\t\t/**\n\t\t * @function reset\n\t\t *\n\t\t * Return our App List to an unselected state.\n\t\t */\n\t\treset:function() {\n\t\t\t$$(ids.list).unselectAll();\n\t\t},\n\n\n\t\t/**\n\t\t * @function refreshList\n\t\t *\n\t\t * Apply our list of ABApplication data to our AppList\n\t\t */\n\t\trefreshList: function() {\n\n\t\t\tvar appList = $$(ids.list);\n\n\t\t\tappList.clearAll();\n\t\t\tappList.data.unsync();\n\t\t\tappList.data.sync(_data.listApplications);\n\n\t\t\t_logic.refreshOverlay();\n\n\t\t\tappList.refresh();\n\n\t\t\t_logic.ready();\n\t\t},\n\n\n\t\t/**\n\t\t * @function show\n\t\t *\n\t\t * Trigger our List component to show\n\t\t */\n\t\tshow:function() {\n\t\t\t$$(ids.component).show();\n\t\t},\n\n\n\t\t/**\n\t\t * @function templateListItem\n\t\t *\n\t\t * Defines the template for each row of our AppList.\n\t\t *\n\t\t * @param {obj} obj the current instance of ABApplication for the row.\n\t\t * @param {?} common the webix.common icon data structure\n\t\t * @return {string}\n\t\t */\n\t\ttemplateListItem: function(obj, common) {\n\t\t\treturn _templateListItem\n\t\t\t\t.replace('#label#', obj.label || '')\n\t\t\t\t.replace('#description#', obj.description || '')\n\t\t\t\t.replace('{common.iconGear}', common.iconGear);\n\t\t}\n\t}\n\n\n\n\t/*\n\t * _templateListItem\n\t *\n\t * The AppList Row template definition.\n\t */\n\tvar _templateListItem = [\n\t\t\"<div class='ab-app-list-item'>\",\n\t\t\t\"<div class='ab-app-list-info'>\",\n\t\t\t\t\"<div class='ab-app-list-name'>#label#</div>\",\n\t\t\t\t\"<div class='ab-app-list-description'>#description#</div>\",\n\t\t\t\"</div>\",\n\t\t\t\"<div class='ab-app-list-edit'>\",\n\t\t\t\t\"{common.iconGear}\",\n\t\t\t\"</div>\",\n\t\t\"</div>\"\n\t].join('');\n\n\n\n\t/*\n\t * @function _init\n\t *\n\t * The init() that performs the necessary setup for our AppList chooser.\n\t */\n\tvar _init = function() {\n\t\twebix.extend($$(ids.list), webix.ProgressBar);\n\t\twebix.extend($$(ids.list), webix.OverlayBox);\n\n\t\tMenuComponent.init();\n\n\t\t// start things off by loading the current list of Applications\n\t\t_logic.loadData();\n\t}\n\n\n\n\t/*\n\t * {json} _actions\n\t *\n\t * The exported methods available to other Components.\n\t */\n\tvar _actions = {\n\n\n\t\t/**\n\t\t * @function unselectApplication\n\t\t *\n\t\t * resets the AppList to an unselected state.\n\t\t */\n\t\tunselectApplication:function() {\n\t\t\t_logic.reset();\n\t\t},\n\n\n\t\t/**\n\t\t * @function getSelectedApplication\n\t\t *\n\t\t * returns which ABApplication is currently selected.\n\t\t * @return {ABApplication}  or {null} if nothing selected.\n\t\t */\n\t\tgetSelectedApplication:function() {\n\t\t\treturn $$(ids.list).getSelectedItem();\n\t\t},\n\n\n\t\t/**\n\t\t * @function deleteApplication\n\t\t *\n\t\t * deletes the given ABAppliction.\n\t\t *\n\t\t * NOTE: this assumes the component using this method has already\n\t\t * provided the delete confirmation.\n\t\t *\n\t\t * @param {ABApplication} app  the ABAppliction to delete.\n\t\t */\n\t\tdeleteApplication: function(app) {\n\n\t\t\tif (!app) return;\n\n\t\t\t// Delete application data\n\t\t\t_logic.busy();\n\n\n\t\t\tapp.destroy()\n\t\t\t\t.then(function (result) {\n\t\t\t\t\t_logic.reset();\n\t\t\t\t\t_logic.ready();\n\n\t\t\t\t\twebix.message({\n\t\t\t\t\t\ttype: \"success\",\n\t\t\t\t\t\ttext: labels.common.deleteSuccessMessage.replace('{0}', app.label)\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(function (err) {\n\t\t\t\t\t_logic.reset();\n\t\t\t\t\t_logic.ready()\n\n\t\t\t\t\twebix.message({\n\t\t\t\t\t\ttype: \"error\",\n\t\t\t\t\t\ttext: labels.common.deleteErrorMessage.replace(\"{0}\", app.label)\n\t\t\t\t\t});\n\n\t\t\t\t\tAD.error.log('App Builder : Error delete application data', { error: err });\n\t\t\t\t})\n\t\t},\n\n\n\t\t/**\n\t\t * @function transitionApplicationList\n\t\t *\n\t\t * Trigger our List component to show\n\t\t */\n\t\ttransitionApplicationList:function() {\n\t\t\t$$(ids.component).show();\n\t\t}\n\t}\n\n\n\n\treturn {\n\t\tui: _ui,\n\t\tinit: _init,\n\t\tactions:_actions,\n\n\n\t\t_logic:_logic\t// exposed for Unit Testing\n\t}\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_choose_list.js","\n/*\n * AB Choose List\n *\n * Display a list of Applications for the user to select.\n *\n */\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\n\nvar labels = {\n\n\tcomponent: {\n\t\tmenu : L('ab.application.menu', \"*Application Menu\"),\n\t\tconfirmDeleteTitle : L('ab.application.delete.title', \"*Delete application\"),\n\t\tconfirmDeleteMessage : L('ab.application.delete.message', \"*Do you want to delete <b>{0}</b>?\")\n\t}\n}\n\n\nvar idBase = 'ab_choose_list_menu';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\tvar ids = {\n\t\tmenu:App.unique(idBase + '_menu')\n\t}\n\n\n\n\tvar _ui = {\n\t\tview: \"popup\",\n\t\tid: ids.menu,\n\t\thead: labels.component.menu,\n\t\twidth: 100,\n\t\tbody: {\n\t\t\tview: \"list\",\n\t\t\tborderless: true,\n\t\t\tdata: [\n\t\t\t\t{ command: labels.common.edit, icon: \"fa-pencil-square-o\" },\n\t\t\t\t{ command: labels.common.export, icon: \"fa-download\" },\n\t\t\t\t{ command: labels.common.delete, icon: \"fa-trash\" }\n\t\t\t],\n\t\t\tdatatype: \"json\",\n\n\t\t\ttemplate: \"<i class='fa #icon#' aria-hidden='true'></i> #command#\",\n\t\t\tautoheight: true,\n\t\t\tselect: false,\n\t\t\ton: {\n\t\t\t\t'onItemClick': function (timestamp, e, trg) {\n\t\t\t\t\treturn _logic.onItemClick(timestamp, e, trg);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\n\tvar _data={};\n\n\n\tvar _init = function() {\n\t\t\t\n\t}\n\n\n\tvar _logic = {\n\n\n\t\t/**\n\t\t * @function onItemClick\n\t\t * process which item in our popup was selected.\n\t\t */\n\t\tonItemClick: function( timestamp, e, trg) {\n\n\t\t\t// hide our popup before we trigger any other possible UI animation: (like .edit)\n\t\t\t// NOTE: if the UI is animating another component, and we do .hide()\n\t\t\t// while it is in progress, the UI will glitch and give the user whiplash.\n\t\t\t$$(ids.menu).hide();\n\n\t\t\tvar selectedApp = App.actions.getSelectedApplication();\n\n\t\t\tswitch (trg.textContent.trim()) {\n\t\t\t\tcase labels.common.edit:\n\t\t\t\t\tApp.actions.transitionApplicationForm(selectedApp);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase labels.common.delete:\n\t\t\t\t\tOP.Dialog.ConfirmDelete({\n\t\t\t\t\t\ttitle: labels.component.confirmDeleteTitle,\n\t\t\t\t\t\ttext: labels.component.confirmDeleteMessage.replace('{0}', selectedApp.label),\n\t\t\t\t\t\tcallback: function (result) {\n\n\t\t\t\t\t\t\tif (!result) return;\n\n\t\t\t\t\t\t\tApp.actions.deleteApplication(selectedApp);\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase labels.common.export:\n\t\t\t\t\t// Download the JSON file to disk\n\t\t\t\t\twindow.location.assign('/app_builder/appJSON/' + selectedApp.id + '?download=1');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t}\n\n\t}\n\n\n\n\treturn {\n\t\tui: _ui,\n\t\tinit: _init,\n\n\t\t_logic:_logic\t// exposed for Unit Testing\n\t}\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_choose_list_menu.js","\n/*\n * ab_work\n *\n * Display the component for working with an ABApplication.\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\nimport \"./ab_work_object\"\nimport \"./ab_work_interface\"\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tapplication: {\n\n\t\t// formHeader: L('ab.application.form.header', \"*Application Info\"),\n\t\tbackToApplication: L('ab.application.backToApplication', \"*Back to Applications page\"),\n\t\tsynchronize: L('ab.application.synchronize', \"*Synchronize\"),\n\t\tobjectTitle: L('ab.object.title', \"*Objects\"),\n\t\tinterfaceTitle: L('ab.interface.title', \"*Interface\")\n\t}\n}\n\n\n\nOP.Component.extend('ab_work', function(App) {\n\n\tlabels.common = App.labels;\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique('ab_work_component'),\n\t\ttoolBar: App.unique('ab_work_toolbar'),\n\t\tbuttonSync: App.unique('ab_work_button_sync'),\n\t\tlabelAppName: App.unique('ab_work_label_appname'),\n\t\ttabbar: App.unique('ab_work_tabbar'),\n\t\ttab_object: App.unique('ab_work_tab_object'),\n\t\ttab_interface: App.unique('ab_work_tab_interface'),\n\t\tworkspace: App.unique('ab_work_workspace'),\n\t}\n\n\n\tvar AppObjectWorkspace = OP.Component['ab_work_object'](App);\n\tvar AppInterfaceWorkspace = OP.Component['ab_work_interface'](App);\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tid: ids.component,\n\t\trows: [\n\t\t\t{\n\t\t\t\tview: \"toolbar\",\n\t\t\t\tid: ids.toolBar,\n\t\t\t\tautowidth: true,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\tlabel: labels.application.backToApplication,\n\t\t\t\t\t\twidth: 200,\n\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\ticon: \"arrow-left\",\n\t\t\t\t\t\talign: \"left\",\n\n\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\tApp.actions.transitionApplicationChooser();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"label\",\n\t\t\t\t\t\tid: ids.labelAppName,\n\t\t\t\t\t\talign: \"center\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"spacer\",\n\t\t\t\t\t\twidth: 200,\n\t\t\t\t\t\talrign: \"right\"\n\t\t\t\t\t}\n\t\t\t\t\t// {\n\t\t\t\t\t// \tid: ids.buttonSync,\n\t\t\t\t\t// \tview: \"button\",\n\t\t\t\t\t// \ttype: \"icon\",\n\t\t\t\t\t// \ticon: \"refresh\",\n\t\t\t\t\t// \tlabel: labels.application.synchronize,\n\t\t\t\t\t// \tautowidth: true,\n\t\t\t\t\t// \talign: \"right\",\n\t\t\t\t\t// \tclick: function () {\n\t\t\t\t\t// \t\t_logic.synchronize();\n\t\t\t\t\t// \t}\n\t\t\t\t\t// }\n\t\t\t\t]\n\t\t\t},\n\t\t\t//{ height: App.config.mediumSpacer },\n\t\t\t// {\n\t\t\t// \tview:\"segmented\",\n\t\t\t// \tid: ids.tabbar,\n\t\t\t// \tvalue: ids.tab_object,\n\t\t\t// \tmultiview: true,\n\t\t\t// \talign: \"center\",\n\t\t\t// \toptions:[\n\t\t\t// \t\t{\n\t\t\t// \t\t\tid: ids.tab_object,\n\t\t\t// \t\t\tvalue: labels.application.objectTitle,\n\t\t\t// \t\t\twidth: App.config.tabWidthMedium\n\t\t\t// \t\t},\n\t\t\t// \t\t{\n\t\t\t// \t\t\tid: ids.tab_interface,\n\t\t\t// \t\t\tvalue: labels.application.interfaceTitle,\n\t\t\t// \t\t\twidth: App.config.tabWidthMedium\n\t\t\t// \t\t}\n\t\t\t// \t],\n\t\t\t// \ton: {\n\t\t\t// \t\tonChange: function (idNew, idOld) {\n\t\t\t// \t\t\tif (idNew != idOld) {\n\t\t\t// \t\t\t\t_logic.tabSwitch(idNew, idOld);\n\t\t\t// \t\t\t}\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// },\n\t\t\t{ height: App.config.mediumSpacer },\n\t\t\t{\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: App.config.mediumSpacer\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"tabbar\",\n\t\t\t\t\t\t\t\tid: ids.tabbar,\n\t\t\t\t\t\t\t\tvalue: ids.tab_object,\n\t\t\t\t\t\t\t\tmultiview: true,\n\t\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tid: ids.tab_object,\n\t\t\t\t\t\t\t\t\t\tvalue: labels.application.objectTitle,\n\t\t\t\t\t\t\t\t\t\twidth: App.config.tabWidthMedium\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tid: ids.tab_interface,\n\t\t\t\t\t\t\t\t\t\tvalue: labels.application.interfaceTitle,\n\t\t\t\t\t\t\t\t\t\twidth: App.config.tabWidthMedium\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonChange: function (idNew, idOld) {\n\t\t\t\t\t\t\t\t\t\tif (idNew != idOld) {\n\t\t\t\t\t\t\t\t\t\t\t_logic.tabSwitch(idNew, idOld);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: ids.workspace,\n\t\t\t\t\t\t\t\tcells: [\n\t\t\t\t\t\t\t\t\tAppObjectWorkspace.ui,\n\t\t\t\t\t\t\t\t\tAppInterfaceWorkspace.ui\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: App.config.mediumSpacer\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{ height: App.config.mediumSpacer }\n\t\t]\n\t};\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function() {\n\n\t\tAppObjectWorkspace.init();\n\t\tAppInterfaceWorkspace.init();\n\n\t\t// initialize the Object Workspace to show first.\n\t\t_logic.tabSwitch(ids.tab_object);\n\t}\n\n\n\n\t// our internal business logic\n\tvar _logic = {\n\n\n\t\tapplicationInit:function(application) {\n\n\t\t\t// setup Application Label:\n\t\t\t$$(ids.labelAppName).define('label', application.label);\n\t\t\t$$(ids.labelAppName).refresh();\n\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\t$$(ids.component).show();\n\t\t},\n\n\n\t\t/**\n\t\t * @function synchronize\n\t\t *\n\t\t * Kick off the Synchronization process.\n\t\t */\n\t\tsynchronize:function() {\n\n// self.element.trigger(self.options.synchronizeEvent, {\n// \tappID: AD.classes.AppBuilder.currApp.id\n// });\n//// Question: where should this logic go?  Here or in ab.js ?\n\nconsole.error('TODO: ab_work.logic.synchronize()!');\n\t\t},\n\n\n\t\t/**\n\t\t * @function tabSwitch\n\t\t *\n\t\t * Every time a tab switch happens, decide which workspace to show.\n\t\t *\n\t\t * @param {string} idTab\tthe id of the tab that was changed to.\n\t\t * @param {string} idOld\tthe previous tab id\n\t\t */\n\t\ttabSwitch:function(idTab, idOld) {\n\n\t\t\tswitch( idTab ) {\n\n\t\t\t\t// Object Workspace Tab\n\t\t\t\tcase ids.tab_object:\n\n\t\t\t\t\t// $$(ids.buttonSync).show();\n\t\t\t\t\tAppObjectWorkspace.show();\n\t\t\t\t\tbreak;\n\n\t\t\t\t// Interface Workspace Tab\n\t\t\t\tcase ids.tab_interface:\n\n\t\t\t\t\t// $$(ids.buttonSync).hide();\n\t\t\t\t\tAppInterfaceWorkspace.show();\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t\t/**\n\t\t * @function transitionWorkspace\n\t\t *\n\t\t * Switch the UI to view the App Workspace screen.\n\t\t *\n\t\t * @param {ABApplication} application\n\t\t */\n\t\ttransitionWorkspace:function(application){\n\n\t\t\t_logic.applicationInit(application);\n\t\t\tAppObjectWorkspace.applicationLoad(application);\n\t\t\tAppInterfaceWorkspace.applicationLoad(application);\n\n\n\t\t\t_logic.show();\t\n\t\t}\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work.js","\n/*\n * ab_work_interface\n *\n * Display the Interface for designing Pages and Views in the App Builder.\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\t// formHeader: L('ab.application.form.header', \"*Application Info\"),\n\n\t}\n}\n\n\nvar idBase = 'ab_work_interface';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\n\t}\n\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tid: ids.component,\n\t\t//scroll: true,\n\t\trows: [\n\t\t\t{\n\t\t\t\tview: \"label\",\n\t\t\t\tlabel:\"interface workspace\",\n\t\t\t},\n\t\t]\n\t};\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function() {\n\t\t// webix.extend($$(ids.form), webix.ProgressBar);\n\n\t}\n\n\n\n\t// our internal business logic\n\tvar _logic = {\n\n\n\t\t\n\t\t/**\n\t\t * @function applicationLoad\n\t\t *\n\t\t * Initialize the Object Workspace with the given ABApplication.\n\t\t *\n\t\t * @param {ABApplication} application \n\t\t */\n\t\tapplicationLoad:function(application) {\nconsole.error('TODO: ab_work_interface.applicationLoad()');\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\t$$(ids.component).show();\n\t\t}\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\t\tapplicationLoad:_logic.applicationLoad,\n\t\tshow: _logic.show,\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_interface.js","\n/*\n * ab_work_object\n *\n * Display the Object Tab UI:\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\nimport \"./ab_work_object_list\"\nimport \"./ab_work_object_workspace\"\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\t// formHeader: L('ab.application.form.header', \"*Application Info\"),\n\n\t}\n}\n\n\nvar idBase = 'ab_work_object';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\n\t}\n\n\tvar ObjectList = OP.Component['ab_work_object_list'](App);\n\tvar ObjectWorkspace = OP.Component['ab_work_object_workspace'](App);\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tid: ids.component,\n\t\tmargin: 10,\n\t\tcols: [\n\t\t\tObjectList.ui,\n\t\t\t{ view: \"resizer\"},\n\t\t\tObjectWorkspace.ui\n\t\t]\n\t};\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function() {\n\n\t\tObjectWorkspace.init();\n\t\tObjectList.init();\n\n\t}\n\n\n\n\t// our internal business logic\n\tvar _logic = {\n\n\t\t/**\n\t\t * @function applicationLoad\n\t\t *\n\t\t * Initialize the Object Workspace with the given ABApplication.\n\t\t *\n\t\t * @param {ABApplication} application\n\t\t */\n\t\tapplicationLoad: function(application) {\n\t\t\tObjectList.applicationLoad(application);\n\t\t\tApp.actions.clearObjectWorkspace();\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\t$$(ids.component).show();\n\t\t}\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\n\t\tapplicationLoad: _logic.applicationLoad,\n\t\tshow: _logic.show,\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object.js","\n/*\n * ab_work_object_list\n *\n * Manage the Object List\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\nimport \"./ab_work_object_list_newObject\"\nimport \"./ab_work_object_list_popupEditMenu\"\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\t// formHeader: L('ab.application.form.header', \"*Application Info\"),\n\t\taddNew: L('ab.object.addNew', '*Add new object'),\n\n\t\tconfirmDeleteTitle: L('ab.object.delete.title', \"*Delete object\"),\n\t\tconfirmDeleteMessage: L('ab.object.delete.message', \"*Do you want to delete <b>{0}</b>?\")\n\n\t}\n}\n\n\nvar idBase = 'ab_work_object_list';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique(idBase+ '_component'),\n\n\t\tlist: App.unique(idBase+ '_editlist'),\n\t\tbuttonNew: App.unique(idBase+ '_buttonNew'),\n\n\t}\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tid:ids.component,\n\t\trows: [\n\t\t\t{\n\t\t\t\tview: App.custom.editlist.view,  // \"editlist\",\n\t\t\t\tid: ids.list,\n\t\t\t\twidth: 250,\n\n//height:800, // #Hack!\n\n\t\t\t\tselect: true,\n\t\t\t\teditaction: 'custom',\n\t\t\t\teditable: true,\n\t\t\t\teditor: \"text\",\n\t\t\t\teditValue: \"label\",\n\t\t\t\ttemplate: function(obj, common) {\n\t\t\t\t\treturn _logic.templateListItem(obj, common);\n\t\t\t\t},\n\t\t\t\ttype: {\n\t\t\t\t\theight: 35,\n\t\t\t\t\ticonGear: \"<div class='ab-object-list-edit'><span class='webix_icon fa-cog'></span></div>\"\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tonAfterRender: function () {\n\t\t\t\t\t\t_logic.onAfterRender();\n\t\t\t\t\t},\n\t\t\t\t\tonAfterSelect: function (id) {\n\t\t\t\t\t\t_logic.selectObject(id);\n\t\t\t\t\t},\n\t\t\t\t\tonBeforeEditStop: function (state, editor) {\n\t\t\t\t\t\t_logic.onBeforeEditStop(state, editor);\n\t\t\t\t\t},\n\t\t\t\t\tonAfterEditStop: function (state, editor, ignoreUpdate) {\n\t\t\t\t\t\t_logic.onAfterEditStop(state, editor, ignoreUpdate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonClick: {\n\t\t\t\t\t\"ab-object-list-edit\": function (e, id, trg) {\n\t\t\t\t\t\t_logic.clickEditMenu(e, id, trg);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: 'button',\n\t\t\t\tid: ids.buttonNew,\n\t\t\t\tvalue: labels.component.addNew,\n\t\t\t\tclick: function () {\n\t\t\t\t\t_logic.clickNewObject();\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t};\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function() {\n\n\t\tif ($$(ids.component))\n\t\t\t$$(ids.component).adjust();\n\n\t\tif ($$(ids.list)) {\n\t\t\twebix.extend($$(ids.list), webix.ProgressBar);\n\t\t\t$$(ids.list).adjust();\n\t\t}\n\n\t\tPopupNewObjectComponent.init({\n\t\t\tonDone: _logic.callbackNewObject\n\t\t});\n\n\t\tPopupEditObjectComponent.init({\n\t\t\tonClick: _logic.callbackObjectEditorMenu\n\t\t})\n\t}\n\n\n\n\t// our internal business logic\n\tvar _logic = {\n\n\n\t\t/**\n\t\t * @function applicationLoad\n\t\t *\n\t\t * Initialize the Object List from the provided ABApplication\n\t\t *\n\t\t * If no ABApplication is provided, then show an empty form. (create operation)\n\t\t *\n\t\t * @param {ABApplication} application  \t[optional] The current ABApplication\n\t\t *\t\t\t\t\t\t\t\t\t\twe are working with.\n\t\t */\n\t\tapplicationLoad : function(application){\n\t\t\t_logic.listBusy();\n\n\t\t\tCurrentApplication = application;\n\n\t\t\t// get a DataCollection of all our objects\n\t\t\tobjectList = new webix.DataCollection({\n\t\t\t\tdata: application.objects(),\n\t\t\t});\n\n\t\t\t// clear our list and display our objects:\n\t\t\tvar List = $$(ids.list);\n\t\t\tList.clearAll();\n\t\t\tList.data.unsync();\n\t\t\tList.data.sync(objectList);\n\t\t\tList.refresh();\n\t\t\tList.unselectAll();\n\n\n\n\t\t\t//\n\t\t\t_logic.listReady();\n\n\n\t\t\t// prepare our Popup with the current Application\n\t\t\tPopupNewObjectComponent.applicationLoad(application);\n\n\t\t},\n\n\n\t\tclickEditMenu: function(e, id, trg) {\n\t\t\t// Show menu\n\t\t\tPopupEditObjectComponent.show(trg);\n\n\t\t\treturn false;\n\t\t},\n\n\n\t\tlistBusy:function() {\n\t\t\t$$(ids.list).showProgress({ type: \"icon\" });\n\t\t},\n\n\t\tlistReady:function() {\n\t\t\t$$(ids.list).hideProgress();\n\t\t},\n\n\t\tonAfterRender: function() {\nconsole.error('!! todo: onAfterRender() editing');\n\t\t\t// webix.once(function () {\n\t\t\t// \t$$(self.webixUiId.objectList).data.each(function (d) {\n\t\t\t// \t\t$($$(self.webixUiId.objectList).getItemNode(d.id)).find('.ab-object-unsync-number').html(99);\n\t\t\t// \t});\n\t\t\t// });\n\n\t\t\t// // Show gear icon\n\t\t\t// if (this.getSelectedId(true).length > 0) {\n\t\t\t// \t$(this.getItemNode(this.getSelectedId(false))).find('.ab-object-list-edit').show();\n\t\t\t// \tself.refreshUnsyncNumber();\n\t\t\t// }\n\t\t},\n\n\t\tonAfterEditStop: function(state, editor, ignoreUpdate) {\n\n\t\t\t_logic.showGear(editor.id);\n\n\t\t\tif (state.value != state.old) {\n\t\t\t\t_logic.listBusy();\n\n\t\t\t\tvar selectedObject = $$(ids.list).getSelectedItem(false);\n\t\t\t\tselectedObject.label = state.value;\n\n\t\t\t\t// Call server to rename\n\t\t\t\tselectedObject.save()\n\t\t\t\t\t.catch(function () {\n\t\t\t\t\t\t_logic.listReady();\n\n\t\t\t\t\t\tOP.Dialog.Alert({\n\t\t\t\t\t\t\ttext: labels.common.renameErrorMessage.replace(\"{0}\", state.old)\n\t\t\t\t\t\t});\n\n\t\t\t\t\t})\n\t\t\t\t\t.then(function () {\n\t\t\t\t\t\t_logic.listReady();\n\n\t\t\t\t\t\t// TODO : should use message box\n\t\t\t\t\t\tOP.Dialog.Alert({\n\t\t\t\t\t\t\ttext: labels.common.renameSuccessMessage.replace(\"{0}\", state.value)\n\t\t\t\t\t\t});\n\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tonBeforeEditStop: function(state, editor) {\nconsole.error('!! todo: onBeforeEditStop() editing');\n\t\t\t// if (!inputValidator.validateFormat(state.value)) {\n\t\t\t// \treturn false;\n\t\t\t// }\n\n\t\t\t// // Validation - check duplicate\n\t\t\t// if (!inputValidator.rules.preventDuplicateObjectName(state.value, editor.id) && state.value != state.old) {\n\t\t\t// \twebix.alert({\n\t\t\t// \t\ttitle: self.labels.object.invalidName,\n\t\t\t// \t\tok: self.labels.common.ok,\n\t\t\t// \t\ttext: self.labels.object.duplicateName.replace(\"{0}\", state.value)\n\t\t\t// \t});\n\n\t\t\t// \treturn false;\n\t\t\t// }\n\t\t},\n\n\n\t\t/**\n\t\t * @function selectObject()\n\t\t *\n\t\t * Perform these actions when an Object is selected in the List.\n\t\t */\n\t\tselectObject: function (id) {\n\n\t\t\tvar object = $$(ids.list).getItem(id);\n\t\t\tApp.actions.populateObjectWorkspace(object);\n\n//// TODO: do we need these?\n\n\t\t\t// // Refresh unsync number\n\t\t\t// self.refreshUnsyncNumber();\n\n\t\t\t_logic.showGear(id);\n\t\t},\n\n\t\tshowGear: function(id) {\n\t\t\tvar gearIcon = $$(ids.list).getItemNode(id).querySelector('.ab-object-list-edit');\n\t\t\tgearIcon.style.visibility = \"visible\";\n\t\t\tgearIcon.style.display = \"block\";\n\t\t},\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\t$$(ids.component).show();\n\t\t},\n\n\n\n\t\t/**\n\t\t * @function templateListItem\n\t\t *\n\t\t * Defines the template for each row of our ObjectList.\n\t\t *\n\t\t * @param {obj} obj the current instance of ABObject for the row.\n\t\t * @param {?} common the webix.common icon data structure\n\t\t * @return {string}\n\t\t */\n\t\ttemplateListItem: function(obj, common) {\n\t\t\treturn _templateListItem\n\t\t\t\t.replace('#label#', obj.label || '??label??')\n\t\t\t\t.replace('{common.iconGear}', common.iconGear);\n\t\t},\n\n\n\t\t/**\n\t\t * @function callbackNewObject\n\t\t *\n\t\t * Once a New Object was created in the Popup, follow up with it here.\n\t\t */\n\t\tcallbackNewObject:function(err, object){\n\n\t\t\tif (err) {\n\t\t\t\tOP.Error.log('Error creating New Object', {error: err});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tobjectList.add(object, objectList.count());\n\t\t\t$$(ids.list).select(object.id);\n\t\t},\n\n\n\t\t/**\n\t\t * @function clickNewObject\n\t\t *\n\t\t * Manages initiating the transition to the new Object Popup window\n\t\t */\n\t\tclickNewObject:function() {\n\n\t\t\t// show the new popup\n\t\t\tPopupNewObjectComponent.show();\n\t\t},\n\n\t\trename: function () {\n\t\t\tvar objectId = $$(ids.list).getSelectedId(false);\n\t\t\t$$(ids.list).edit(objectId);\n\t\t},\n\n\t\tremove: function () {\n\n\t\t\tvar selectedObject = $$(ids.list).getSelectedItem(false);\n\n\t\t\t// verify they mean to do this:\n\t\t\tOP.Dialog.Confirm({\n\t\t\t\ttitle: labels.component.confirmDeleteTitle,\n\t\t\t\tmessage: labels.component.confirmDeleteMessage.replace('{0}', selectedObject.label),\n\t\t\t\tcallback: (isOK) => {\n\n\t\t\t\t\tif (isOK) {\n\t\t\t\t\t\t_logic.listBusy();\n\n\t\t\t\t\t\tselectedObject.destroy()\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t_logic.listReady();\n\n\t\t\t\t\t\t\t\t$$(ids.list).remove(selectedObject.id);\n\t\t\t\t\t\t\t\tApp.actions.clearObjectWorkspace();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\tcallbackObjectEditorMenu: function (action) {\n\t\t\tswitch (action) {\n\t\t\t\tcase 'rename':\n\t\t\t\t\t_logic.rename();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete':\n\t\t\t\t\t_logic.remove();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\n\t/*\n\t * _templateListItem\n\t *\n\t * The Object Row template definition.\n\t */\n\tvar _templateListItem = [\n\t\t\"<div class='ab-object-list-item'>\",\n\t\t\t\"#label#\",\n\t\t\t// \"{common.unsyncNumber}\",\n\t\t\t\"{common.iconGear}\",\n\t\t\"</div>\",\n\t].join('');\n\n\n\t// Note: put these here so _logic is defined:\n\t// There is a Popup for adding a new Object:\n\tvar PopupNewObjectComponent = OP.Component['ab_work_object_list_newObject'](App);\n\tvar PopupEditObjectComponent = OP.Component['ab_work_object_list_popupEditMenu'](App);\n\n\n\n\tvar CurrentApplication = null;\n\tvar objectList = null;\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t\t/**\n\t\t * @function getSelectedObject\n\t\t *\n\t\t * returns which ABObject is currently selected.\n\t\t * @return {ABObject}  or {null} if nothing selected.\n\t\t */\n\t\tgetSelectedObject:function() {\n\t\t\treturn $$(ids.list).getSelectedItem();\n\t\t},\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\t\t// interface methods for parent component:\n\t\tapplicationLoad:_logic.applicationLoad,\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_list.js","\n/*\n * ab_work_object_list_newObject\n *\n * Display the form for creating a new Object.  This Popup will manage several\n * different sub components for gathering Object data for saving.\n *\n * The sub components will gather the data for the object and do basic form\n * validations on their interface.\n *\n * when ready, the sub component will call onSave(values, cb)  to allow this\n * component to manage the actual final object validation, and saving to this\n * application.  On success, cb(null) will be called.  on error cb(err) will\n * be called.\n *\n */\n\nimport \"./ab_work_object_list_newObject_blank\"\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\t// formHeader: L('ab.application.form.header', \"*Application Info\"),\n\t\taddNew: L('ab.object.addNew', '*Add new object'),\n\n\t}\n}\n\n\nvar idBase = 'ab_work_object_list_newObject';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\t}\n\n\n\tvar BlankTab = OP.Component['ab_work_object_list_newObject_blank'](App);\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview: \"window\",\n\t\tid: ids.component,\n\t\t// width: 400,\n\t\tposition: \"center\",\n\t\tmodal: true,\n\t\thead: labels.component.addNew,\n\t\tselectNewObject: true,\n\t\tbody: {\n\t\t\tview: \"tabview\",\n\t\t\tcells: [\n\t\t\t\tBlankTab.ui,\n\t\t\t\t// importObjectCreator.getCreateView(),\n\t\t\t\t// importCsvCreator.getCreateView()\n\t\t\t]\n\t\t}\n\t};\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function(options) {\n\t\twebix.ui(_ui);\n\n\t\t// register our callbacks:\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n\n\t\tvar ourCBs = {\n\t\t\tonCancel: _logic.hide,\n\t\t\tonSave: _logic.save\n\t\t}\n\n\t\tBlankTab.init(ourCBs);\n\n\t}\n\n\n\n\t// our internal business logic\n\tvar _logic = {\n\n\n\n\n\t\t/**\n\t\t * @function applicationLoad()\n\t\t *\n\t\t * prepare ourself with the current application\n\t\t */\n\t\tapplicationLoad:function(application) {\n\t\t\t// _logic.show();\n\t\t\tcurrentApplication = application;\t// remember our current Application.\n\t\t},\n\n\n\t\tcallbacks:{\n\t\t\tonDone:function(){}\n\t\t},\n\n\n\t\t/**\n\t\t * @function hide()\n\t\t *\n\t\t * remove the busy indicator from the form.\n\t\t */\n\t\thide: function() {\n\t\t\tif ($$(ids.component))\n\t\t\t\t$$(ids.component).hide();\n\t\t},\n\n\n\t\t/**\n\t\t * @function save\n\t\t *\n\t\t * take the data gathered by our child creation tabs, and\n\t\t * add it to our current application.\n\t\t *\n\t\t * @param {obj} values  key=>value hash of model values.\n\t\t * @param {fn}  cb \t\tnode style callback to indicate success/failure\n\t\t */\n\t\tsave:function (values, cb) {\n\n\t\t\t// must have an application set.\n\t\t\tif (!currentApplication) {\n\t\t\t\tOP.Dialog.Alert({\n\t\t\t\t\ttitle:'Shoot!',\n\t\t\t\t\ttest:'No Application Set!  Why?'\n\t\t\t\t});\n\t\t\t\tcb(true);\t// there was an error.\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// create a new (unsaved) instance of our object:\n\t\t\tvar newObject = currentApplication.objectNew(values);\n\n\n\t\t\t// have newObject validate it's values.\n\t\t\tvar validator = newObject.isValid();\n\t\t\tif (validator.fail()) {\n\t\t\t\tcb(validator);\t\t\t\t\t\t\t// tell current Tab component the errors\n\t\t\t\treturn false;\t\t\t\t\t\t\t// stop here.\n\t\t\t}\n\n\n\t\t\t// if we get here, save the new Object\n\t\t\tnewObject.save()\n\t\t\t\t.then(function(obj){\n\n\t\t\t\t\t// successfully done:\n\t\t\t\t\tcb();\t\t\t\t\t\t\t\t\t// tell current tab component save successful\n\t\t\t\t\t_logic.hide();\t\t\t\t\t\t\t// hide our popup\n\t\t\t\t\t_logic.callbacks.onDone(null, obj);\t\t// tell parent component we're done\n\t\t\t\t})\n\t\t\t\t.catch(function(err){\n\t\t\t\t\tcb(err);\t\t\t\t\t\t\t\t// tell current Tab component there was an error\n\t\t\t\t})\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\tif ($$(ids.component))\n\t\t\t\t$$(ids.component).show();\n\t\t}\n\t}\n\n\n\tvar currentApplication = null;\n\t// var currentCallBack = null;\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\t\t// interface methods for parent component:\n\t\tapplicationLoad:_logic.applicationLoad,\n\t\tshow: _logic.show,\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_list_newObject.js","\n/*\n * ab_work_object_list_newObject_blank\n *\n * Display the form for creating a new Application.\n *\n */\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\t\tplaceholderName: L('ab.object.form.placeholderName', \"*Object name\"),\n\t\taddNewObject: L('ab.object.form.addNewObject', \"*Add Object\"),\n\t}\n}\n\n\nvar idBase = 'ab_work_object_list_newObject_blank';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\n\t\tform: App.unique(idBase + '_blank'),\n\t\tbuttonSave: App.unique(idBase + '_save'),\n\t\tbuttonCancel: App.unique(idBase + '_cancel')\n\t}\n\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tid: ids.component,\n\t\theader: labels.common.create,\n\t\tbody: {\n\t\t\tview: \"form\",\n\t\t\tid: ids.form,\n\t\t\twidth: 400,\n\t\t\trules: {\n\n// TODO:\n// name: inputValidator.rules.validateObjectName\n\t\t\t},\n\t\t\telements: [\n\t\t\t\t{ view: \"text\", label: labels.common.formName, name: \"name\", required: true, placeholder: labels.component.placeholderName, labelWidth: 70 },\n\t\t\t\t{\n\t\t\t\t\tmargin: 5,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{ fillspace: true },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\tid: ids.buttonCancel,\n\t\t\t\t\t\t\tvalue: labels.common.cancel, \n\t\t\t\t\t\t\tcss: \"ab-cancel-button\",\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t_logic.cancel();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\tid: ids.buttonSave,\n\t\t\t\t\t\t\tvalue: labels.component.addNewObject,\n\t\t\t\t\t\t\tautowidth: true, \n\t\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\treturn _logic.save();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t};\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function( options ) {\n\t\t// webix.extend($$(ids.form), webix.ProgressBar);\n\n\t\t// load up our callbacks.\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n\t}\n\n\n\n\t// our internal business logic \n\tvar _logic = {\n\n\t\tcallbacks:{\n\t\t\tonCancel: function() { console.warn('NO onCancel()!') },\n\t\t\tonSave  : function(values, cb) { console.warn('NO onSave()!') },\n\t\t},\n\n\t\t\n\t\tcancel:function() {\n\n\t\t\t_logic.formClear();\n\t\t\t_logic.callbacks.onCancel();\n\t\t},\n\n\n\t\tformClear:function() {\n\t\t\t$$(ids.form).clearValidation();\n\t\t\t$$(ids.form).clear();\n\t\t},\n\n\n\t\t/**\n\t\t * @function hide()\n\t\t *\n\t\t * hide this component.\n\t\t */\n\t\thide:function() {\n\n\t\t\t$$(ids.component).hide();\n\t\t},\n\n\n\t\t/**\n\t\t * @function save\n\t\t *\n\t\t * verify the current info is ok, package it, and return it to be \n\t\t * added to the application.createModel() method.\n\t\t */\n\t\tsave:function() {\n\t\t\tvar saveButton = $$(ids.buttonSave);\n\t\t\tsaveButton.disable();\n\n\t\t\tvar Form = $$(ids.form);\n\n\t\t\tForm.clearValidation();\n\n\t\t\t// if it doesn't pass the basic form validation, return:\n\t\t\tif (!Form.validate()) {\n\t\t\t\tsaveButton.enable();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar values = Form.getValues();\n\n\n\t\t\t// now send data back to be added:\n\t\t\t_logic.callbacks.onSave(values, function(validator) {\n\n\t\t\t\tif (validator) {\n\t\t\t\t\tvalidator.updateForm(Form);\n\n\t\t\t\t\t// get notified if there was an error saving.\n\t\t\t\t\tsaveButton.enable();\n\t\t\t\t\treturn false;\n\t\t\t\t} \n\n\t\t\t\t// if there was no error, clear the form for the next\n\t\t\t\t// entry:\n\t\t\t\t_logic.formClear();\n\t\t\t\tsaveButton.enable();\n\t\t\t});\n\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\t$$(ids.component).show();\n\t\t}\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t\t/**\n\t\t * @function populateApplicationForm()\n\t\t *\n\t\t * Initialze the Form with the values from the provided ABApplication.\n\t\t *\n\t\t * If no ABApplication is provided, then show an empty form. (create operation)\n\t\t *\n\t\t * @param {ABApplication} Application  \t[optional] The current ABApplication \n\t\t *\t\t\t\t\t\t\t\t\t\twe are working with.\n\t\t */\n\t\t// populateApplicationForm:function(Application){\n\t\t\t\n\t\t// \t_logic.formReset();\n\t\t// \tif (Application) {\n\t\t// \t\t// populate Form here:\n\t\t// \t\t_logic.formPopulate(Application);\n\t\t// \t}\n\t\t// \t_logic.permissionPopulate(Application);\n\t\t// \t_logic.show();\n\t\t// }\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component  \n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_list_newObject_blank.js","/*\n * Edit object popup \n *\n * .\n *\n */\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\n\nvar labels = {\n\n\tcomponent: {\n\t\tmenu: L('ab.application.menu', \"*Application Menu\"),\n\t\tconfirmDeleteTitle: L('ab.application.delete.title', \"*Delete application\"),\n\t\tconfirmDeleteMessage: L('ab.application.delete.message', \"*Do you want to delete <b>{0}</b>?\")\n\t}\n}\n\n\nvar idBase = 'ab_work_object_list_popupEditMenu';\nOP.Component.extend(idBase, function (App) {\n\n\tlabels.common = App.labels;\n\n\n\tvar ids = {\n\t\tmenu: App.unique(idBase + '_menu')\n\t}\n\n\n\n\tvar _ui = {\n\t\tview: \"popup\",\n\t\tid: ids.menu,\n\t\thead: labels.component.menu,\n\t\twidth: 120,\n\t\tbody: {\n\t\t\tview: \"list\",\n\t\t\tborderless: true,\n\t\t\tdata: [\n\t\t\t\t{ command: labels.common.rename, icon: \"fa-pencil-square-o\" },\n\t\t\t\t{ command: labels.common.delete, icon: \"fa-trash\" }\n\t\t\t],\n\t\t\tdatatype: \"json\",\n\t\t\ttemplate: \"<i class='fa #icon#' aria-hidden='true'></i> #command#\",\n\t\t\tautoheight: true,\n\t\t\tselect: false,\n\t\t\ton: {\n\t\t\t\t'onItemClick': function (timestamp, e, trg) {\n\t\t\t\t\treturn _logic.onItemClick(trg);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\n\tvar _data = {};\n\n\n\tvar _init = function (options) {\n\t\twebix.ui(_ui);\n\n\t\t_logic.hide();\n\n\t\t// register our callbacks:\n\t\tfor (var c in _logic.callbacks) {\n\t\t\tif (options && options[c]) {\n\t\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t\t}\n\t\t}\n\n\t}\n\n\n\tvar _logic = {\n\n\t\tcallbacks: {\n\t\t\tonClick: function (action) {\n\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @function onItemClick\n\t\t * process which item in our popup was selected.\n\t\t */\n\t\tonItemClick: function (itemNode) {\n\n\t\t\t// hide our popup before we trigger any other possible UI animation: (like .edit)\n\t\t\t// NOTE: if the UI is animating another component, and we do .hide()\n\t\t\t// while it is in progress, the UI will glitch and give the user whiplash.\n\n\t\t\tswitch (itemNode.textContent.trim()) {\n\t\t\t\tcase labels.common.rename:\n\t\t\t\t\tthis.callbacks.onClick('rename');\n\t\t\t\t\tbreak;\n\t\t\t\tcase labels.common['delete']:\n\t\t\t\t\tthis.callbacks.onClick('delete');\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.hide();\n\n\t\t\treturn false;\n\t\t},\n\n\t\tshow: function (itemNode) {\n\t\t\tif ($$(ids.menu) && itemNode)\n\t\t\t\t$$(ids.menu).show(itemNode);\n\t\t},\n\n\t\thide: function () {\n\t\t\tif ($$(ids.menu))\n\t\t\t\t$$(ids.menu).hide();\n\t\t}\n\n\t}\n\n\n\n\treturn {\n\t\tui: _ui,\n\t\tinit: _init,\n\n\t\tshow: _logic.show,\n\n\t\t_logic: _logic\t// exposed for Unit Testing\n\t}\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_list_popupEditMenu.js","\n/*\n * ab_work_object_workspace\n *\n * Manage the Object Workspace area.\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\nimport \"./ab_work_object_workspace_datatable\"\nimport \"./ab_work_object_workspace_popupDefineLabel\"\nimport \"./ab_work_object_workspace_popupFrozenColumns\"\nimport \"./ab_work_object_workspace_popupHideFields\"\nimport \"./ab_work_object_workspace_popupNewDataField\"\nimport \"./ab_work_object_workspace_popupSortFields\"\n\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\taddNewRow: L('ab.object.addNewRow', \"*Add new row\"),\n\n\t\tselectObject: L('ab.object.selectObject', \"*Select an object to work with.\"),\n\n\t\t// formHeader: L('ab.application.form.header', \"*Application Info\"),\n\n\t\t// Toolbar:\n\t\thideFields: L('ab.object.toolbar.hideFields', \"*Hide fields\"),\n\t\tfilterFields: L('ab.object.toolbar.filterFields', \"*Add filters\"),\n\t\tsortFields: L('ab.object.toolbar.sortFields', \"*Apply sort\"),\n\t\tfrozenColumns: L('ab.object.toolbar.frozenColumns', \"*Frozen columns\"),\n\t\tdefineLabel: L('ab.object.toolbar.defineLabel', \"*Define label\"),\n\t\tpermission: L('ab.object.toolbar.permission', \"*Permission\"),\n\t\taddFields: L('ab.object.toolbar.addFields', \"*Add new column\"),\n\t\t\"export\": L('ab.object.toolbar.export', \"*Export\"),\n\n\t\tconfirmDeleteTitle : L('ab.object.delete.title', \"*Delete data field\"),\n\t\tconfirmDeleteMessage : L('ab.object.delete.message', \"*Do you want to delete <b>{0}</b>?\")\n\t}\n}\n\n\nvar idBase = 'ab_work_object_workspace';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\n\t\tbuttonAddField: App.unique(idBase + '_buttonAddField'),\n\t\tbuttonExport: App.unique(idBase + '_buttonExport'),\n\t\tbuttonFieldsVisible: App.unique(idBase + '_buttonFieldsVisible'),\n\t\tbuttonFilter: App.unique(idBase + '_buttonFilter'),\n\t\tbuttonFrozen: App.unique(idBase + '_buttonFrozen'),\n\t\tbuttonLabel: App.unique(idBase + '_buttonLabel'),\n\t\tbuttonRowNew: App.unique(idBase + '_buttonRowNew'),\n\t\tbuttonSort: App.unique(idBase + '_buttonSort'),\n\n\n\t\tdatatable: App.unique(idBase + '_datatable'),\n\n\n\t\t// Toolbar:\n\t\ttoolbar: App.unique(idBase + '_toolbar'),\n\n\n\n\t\tnoSelection: App.unique(idBase + '_noSelection'),\n\t\tselectedObject: App.unique(idBase + '_selectedObject'),\n\n\t}\n\n\n\n\t// The DataTable that displays our object:\n\tvar DataTable = OP.Component['ab_work_object_workspace_datatable'](App);\n\n\n\t// Various Popups on our page:\n\tvar PopupDefineLabelComponent = OP.Component['ab_work_object_workspace_popupDefineLabel'](App);\n\tvar PopupDefineLabel = webix.ui(PopupDefineLabelComponent.ui);\n\n\tvar PopupFrozenColumnsComponent = OP.Component['ab_work_object_workspace_popupFrozenColumns'](App);\n\tvar PopupFrozenColumns = webix.ui(PopupFrozenColumnsComponent.ui);\n\n\tvar PopupHideFieldComponent = OP.Component['ab_work_object_workspace_popupHideFields'](App);\n\tvar PopupHideField = webix.ui(PopupHideFieldComponent.ui);\n\n\tvar PopupNewDataFieldComponent = OP.Component['ab_work_object_workspace_popupNewDataField'](App);\n\t// var PopupNewDataField = webix.ui(PopupNewDataFieldComponent.ui);\n\twebix.ui(PopupNewDataFieldComponent.ui);\n\n\tvar PopupSortFieldComponent = OP.Component['ab_work_object_workspace_popupSortFields'](App);\n\tvar PopupSortField = webix.ui(PopupSortFieldComponent.ui);\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview:'multiview',\n\t\tid: ids.component,\n\t\trows:[\n\t\t\t{\n\t\t\t\tid: ids.noSelection,\n\t\t\t\trows:[\n\t\t\t\t\t{\n\t\t\t\t\t\tmaxHeight: App.config.xxxLargeSpacer,\n\t\t\t\t\t\thidden: App.config.hideMobile\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:'label',\n\t\t\t\t\t\talign: \"center\",\n\t\t\t\t\t\tlabel:labels.component.selectObject\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tmaxHeight: App.config.xxxLargeSpacer,\n\t\t\t\t\t\thidden: App.config.hideMobile\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: ids.selectedObject,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: 'toolbar',\n\t\t\t\t\t\tid: ids.toolbar,\n\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\tcss: \"ab-data-toolbar\",\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tid: ids.buttonFieldsVisible,\n\t\t\t\t\t\t\t\tlabel: labels.component.hideFields,\n// popup: 'self.webixUiId.visibleFieldsPopup',\n\t\t\t\t\t\t\t\ticon: \"eye-slash\",\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\t// width: 120,\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tbadge: 0,\n\t\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t\t_logic.toolbarFieldsVisible(this.$view);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: 'button',\n\t\t\t\t\t\t\t\tid: ids.buttonFilter,\n\t\t\t\t\t\t\t\tlabel: labels.component.filterFields,\n\t\t\t\t\t\t\t\ticon: \"filter\",\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\t// width: 120,\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tbadge: 0,\n\t\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t\t_logic.toolbarFilter(this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: 'button',\n\t\t\t\t\t\t\t\tid: ids.buttonSort,\n\t\t\t\t\t\t\t\tlabel: labels.component.sortFields,\n\t\t\t\t\t\t\t\ticon: \"sort\",\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\t// width: 120,\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tbadge: 0,\n\t\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t\t_logic.toolbarSort(this.$view);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: 'button',\n\t\t\t\t\t\t\t\tid: ids.buttonFrozen,\n\t\t\t\t\t\t\t\tlabel: labels.component.frozenColumns,\n\t\t\t\t\t\t\t\ticon: \"thumb-tack\",\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tbadge: 0,\n\t\t\t\t\t\t\t\tclick: function(){\n\t\t\t\t\t\t\t\t\t_logic.toolbarFrozen(this.$view);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: 'button',\n\t\t\t\t\t\t\t\tid: ids.buttonLabel,\n\t\t\t\t\t\t\t\tlabel: labels.component.defineLabel,\n\t\t\t\t\t\t\t\ticon: \"crosshairs\",\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\t// width: 130,\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t\t_logic.toolbarDefineLabel(this.$view);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: 'button',\n\t\t\t\t\t\t\t\tlabel: labels.component.permission,\n\t\t\t\t\t\t\t\ticon: \"lock\",\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\t\t_logic.toolbarPermission(this.$view);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: 'button',\n\t\t\t\t\t\t\t\tid: ids.buttonAddField,\n\t\t\t\t\t\t\t\tlabel: labels.component.addFields,\n\t\t\t\t\t\t\t\ticon: \"plus\",\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\t// width: 150,\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tclick:function() {\n\t\t\t\t\t\t\t\t\t_logic.toolbarAddFields(this.$view);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: 'button',\n\t\t\t\t\t\t\t\tid: ids.buttonExport,\n\t\t\t\t\t\t\t\tlabel: labels.component.export,\n\t\t\t\t\t\t\t\ticon: \"download\",\n\t\t\t\t\t\t\t\ttype: \"icon\",\n\t\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\t\t\t_logic.toolbarButtonExport(this.$view);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\tDataTable.ui,\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tid: ids.buttonRowNew,\n\t\t\t\t\t\t\t\tvalue: labels.component.addNewRow,\n\t\t\t\t\t\t\t\tclick: function () {\n// TODO:\n\t\t\t\t\t\t\t\t\t_logic.rowAdd();\n\t\t\t\t\t\t\t\t\t// self.addNewRow({});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\n\t\t\t}\n\t\t]\n\t}\n\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function() {\n\t\t// webix.extend($$(ids.form), webix.ProgressBar);\n\n\t\tDataTable.init({\n\t\t\tonEditorMenu:_logic.callbackHeaderEditorMenu\n\t\t});\n\n\t\tPopupDefineLabelComponent.init({\n\t\t\tonChange:_logic.callbackDefineLabel\t\t// be notified when there is a change in the label\n\t\t});\n\n\t\tPopupFrozenColumnsComponent.init({\n\t\t\tonChange:_logic.callbackFrozenColumns\t\t// be notified when there is a change in the frozen columns\n\t\t});\n\n\t\tPopupHideFieldComponent.init({\n\t\t\tonChange:_logic.callbackFieldsVisible\t\t// be notified when there is a change in the hidden fields\n\t\t});\n\n\t\tPopupNewDataFieldComponent.init({\n\t\t\tonSave:_logic.callbackAddFields\t\t\t// be notified when a new Field is created & saved\n\t\t});\n\n\t\tvar fieldList = DataTable.getFieldList();\n\n\t\tPopupSortFieldComponent.init({\n\t\t\tonChange:_logic.callbackSortFields\t\t// be notified when there is a change in the sort fields\n\t\t});\n\n\n\t\t$$(ids.noSelection).show();\n\t}\n\n\n\tvar CurrentObject = null;\n\n\t// our internal business logic\n\tvar _logic = {\n\n\n\t\t/**\n\t\t * @function callbackDefineLabel\n\t\t *\n\t\t * call back for when the Define Label popup is finished.\n\t\t */\n\t\tcallbackAddFields:function(field) {\n\t\t\tDataTable.refresh();\n\t\t},\n\n\n\t\t/**\n\t\t * @function callbackDefineLabel\n\t\t *\n\t\t * call back for when the Define Label popup is finished.\n\t\t */\n\t\tcallbackDefineLabel: function() {\n\n\t\t},\n\n\t\t/**\n\t\t * @function callbackFrozenColumns\n\t\t *\n\t\t * call back for when the hidden fields have changed.\n\t\t */\n\t\tcallbackFrozenColumns: function() {\n\n\t\t\tvar frozenID = CurrentObject.workspaceFrozenColumnID;\n\n\t\t\tif (typeof(frozenID) != \"undefined\") {\n\t\t\t\tvar badgeNumber = DataTable.getColumnIndex(frozenID) + 1;\n\n\t\t\t\t$$(ids.buttonFrozen).define('badge', badgeNumber);\n\t\t\t\t$$(ids.buttonFrozen).refresh();\n\t\t\t}\n\n\t\t\tDataTable.refresh();\n\t\t},\n\n\t\t/**\n\t\t * @function callbackFieldsVisible\n\t\t *\n\t\t * call back for when the hidden fields have changed.\n\t\t */\n\t\tcallbackFieldsVisible: function() {\n\n\t\t\tvar hiddenFields = CurrentObject.workspaceHiddenFields;\n\n\t\t\tif (typeof(hiddenFields) != \"undefined\") {\n\t\t\t\t$$(ids.buttonFieldsVisible).define('badge', hiddenFields.length);\n\t\t\t\t$$(ids.buttonFieldsVisible).refresh();\n\n\t\t\t}\n\t\t\tDataTable.refresh();\n\n\t\t\t// if you unhide a field it may fall inside the frozen columns range so lets check\n\t\t\t_logic.callbackFrozenColumns();\n\t\t},\n\n\n\t\t/**\n\t\t * @function callbackHeaderEditorMenu\n\t\t *\n\t\t * call back for when an editor menu action has been selected.\n\t\t * @param {string} action [ 'hide', 'filter', 'sort', 'edit', 'delete' ]\n\t\t */\n\t\tcallbackHeaderEditorMenu: function(action, field, node) {\n\n\t\t\tswitch(action) {\n\n\t\t\t\tcase 'hide':\n\t\t\t\tcase 'filter':\n\t\t\t\tcase 'sort':\nconsole.error('!! TODO: callbackHeaderEditorMenu():  unimplemented action:'+action);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'edit':\n\t\t\t\t\t// pass control on to our Popup:\n\t\t\t\t\tPopupNewDataFieldComponent.show(node, field);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'delete':\n\n\t\t\t\t\t// verify they mean to do this:\n\t\t\t\t\tOP.Dialog.Confirm({\n\t\t\t\t\t\ttitle: labels.component.confirmDeleteTitle,\n\t\t\t\t\t\tmessage: labels.component.confirmDeleteMessage.replace('{0}', field.label),\n\t\t\t\t\t\tcallback:function( isOK ) {\n\n\t\t\t\t\t\t\tif (isOK) {\n\n\t\t\t\t\t\t\t\tfield.destroy()\n\t\t\t\t\t\t\t\t.then(()=>{\n\t\t\t\t\t\t\t\t\tDataTable.refresh();\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t},\n\n\t\t/**\n\t\t * @function callbackSortFields\n\t\t *\n\t\t * call back for when the sort fields popup changes\n\t\t */\n\t\tcallbackSortFields: function() {\n\n\t\t\tvar sortFields = CurrentObject.workspaceSortFields;\n\n\t\t\tif (typeof(sortFields) != \"undefined\") {\n\t\t\t\t$$(ids.buttonSort).define('badge', sortFields.length);\n\t\t\t\t$$(ids.buttonSort).refresh();\n\t\t\t}\n\n\t\t\tDataTable.sortTable();\n\t\t},\n\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\t$$(ids.component).show();\n\t\t},\n\n\n\t\t/**\n\t\t * @function toolbarAddFields\n\t\t *\n\t\t * Show the popup to allow the user to create new fields for\n\t\t * this object.\n\t\t */\n\t\ttoolbarAddFields: function($view) {\n\t\t\tPopupNewDataFieldComponent.show($view);\n\t\t},\n\n\n\t\ttoolbarButtonExport: function($view) {\nconsole.error('TODO: Button Export()');\n\t\t},\n\n\n\t\t/**\n\t\t * @function toolbarDefineLabel\n\t\t *\n\t\t * Show the popup to allow the user to define the default label for\n\t\t * this object.\n\t\t */\n\t\ttoolbarDefineLabel: function($view) {\n\t\t\tPopupDefineLabel.show($view);\n\t\t},\n\n\n\t\t/**\n\t\t * @function toolbarFieldsVisible\n\t\t *\n\t\t * Show the popup to allow the user to hide columns for this view.\n\t\t */\n\t\ttoolbarFieldsVisible: function($view) {\n\t\t\tPopupHideField.show($view);\n\t\t},\n\n\n\t\t/**\n\t\t * @function toolbarFilter\n\t\t *\n\t\t * show the popup to add a filter to the datatable\n\t\t */\n\t\ttoolbarFilter: function($view) {\n// self.refreshPopupData();\n// $$(self.webixUiId.filterFieldsPopup).show($view);\nconsole.error('TODO: button filterFields()');\n\t\t},\n\n\n\t\t/**\n\t\t * @function toolbarFrozen\n\t\t *\n\t\t * show the popup to freeze columns for the datatable\n\t\t */\n\t\ttoolbarFrozen: function ($view) {\n\t\t\tPopupFrozenColumns.show($view);\n\t\t},\n\n\n\t\ttoolbarPermission: function ($view) {\nconsole.error('TODO: toolbarPermission()');\n\t\t},\n\n\n\t\t/**\n\t\t * @function toolbarSort\n\t\t *\n\t\t * show the popup to sort the datatable\n\t\t */\n\t\ttoolbarSort:function($view) {\n\t\t\tPopupSortField.show($view);\n// self.refreshPopupData();\n// $$(self.webixUiId.sortFieldsPopup).show($view);\n//console.error('TODO: toolbarSort()');\n\t\t}\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\n\t\t/**\n\t\t * @function clearObjectWorkspace()\n\t\t *\n\t\t * Clear the object workspace.\n\t\t */\n\t\tclearObjectWorkspace:function(){\n\n\t\t\t// NOTE: to clear a visual glitch when multiple views are updating\n\t\t\t// at one time ... stop the animation on this one:\n\t\t\t$$(ids.noSelection).show(false, false);\n\t\t},\n\n\n\t\t/**\n\t\t * @function populateObjectWorkspace()\n\t\t *\n\t\t * Initialize the Object Workspace with the provided ABObject.\n\t\t *\n\t\t * @param {ABObject} object  \tcurrent ABObject instance we are working with.\n\t\t */\n\t\tpopulateObjectWorkspace: function(object) {\n\n\t\t\t$$(ids.toolbar).show();\n\t\t\t$$(ids.selectedObject).show();\n\n\t\t\tCurrentObject = object;\n\n\t\t\tApp.actions.populateObjectPopupAddDataField(object);\n\n\t\t\tDataTable.objectLoad(object);\n\n\t\t\t// update hiddenFields\n\n\t\t\tPopupDefineLabelComponent.objectLoad(object);\n\t\t\tPopupFrozenColumnsComponent.objectLoad(object);\n\t\t\tPopupHideFieldComponent.objectLoad(object);\n\t\t\tPopupSortFieldComponent.objectLoad(object);\n\n\t\t\t_logic.callbackFieldsVisible();\n\t\t\t_logic.callbackFrozenColumns();\n\t\t\t_logic.callbackSortFields();\n\n\t\t}\n\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_workspace.js","\n/*\n * ab_work_object_workspace\n *\n * Manage the Object Workspace area.\n *\n */\n\nimport \"./ab_work_object_workspace_popupHeaderEditMenu\"\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t}\n}\n\n\nvar idBase = 'ab_work_object_workspace_datatable';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique(idBase+'_component'),\n\n\t}\n\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview: \"datatable\",\n\t\tid: ids.component,\n\t\tresizeColumn: true,\n\t\tresizeRow: true,\n\t\tprerender: false,\n\t\teditable: true,\n\t\tfixedRowHeight: false,\n\t\teditaction: \"custom\",\n\t\tselect: \"cell\",\n\t\tdragColumn: true,\n//height:800,  // #hack!\n\t\ton: {\n\t\t\tonBeforeSelect: function (data, preserve) {\n\nconsole.error('!! ToDo: onBeforeSelect()');\n\t\t\t\t// var itemNode = this.getItemNode({ row: data.row, column: data.column });\n\n\t\t\t\t// var column = AD.classes.AppBuilder.currApp.currObj.columns.filter(function (col) { return col.name == data.column; });\n\t\t\t\t// if (!column || column.length < 1) {\n\t\t\t\t// \tconsole.log('System could not found this column data');\n\t\t\t\t// \treturn false;\n\t\t\t\t// } else\n\t\t\t\t// \tcolumn = column[0];\n\n\t\t\t\t// return dataFieldsManager.customEdit(AD.classes.AppBuilder.currApp, AD.classes.AppBuilder.currApp.currObj, column, data.row, itemNode);\n\t\t\t},\n\t\t\tonAfterSelect: function (data, prevent) {\n\t\t\t\t_logic.onAfterSelect(data, prevent);\n\t\t\t},\n\t\t\tonCheck: function (row, col, val) { // Update checkbox data\nconsole.error('!! ToDo: onCheck()');\n\t\t\t\t// var item = $$(self.webixUiId.objectDatatable).getItem(row);\n\n\t\t\t\t// self.updateRowData({ value: (val > 0 ? true : false) }, { row: row, column: col }, false)\n\t\t\t\t// \t.fail(function (err) {\n\t\t\t\t// \t\t// Rollback\n\t\t\t\t// \t\titem[col] = !val;\n\t\t\t\t// \t\t$$(self.webixUiId.objectDatatable).updateItem(row, item);\n\t\t\t\t// \t\t$$(self.webixUiId.objectDatatable).refresh(row);\n\n\t\t\t\t// \t\t$$(self.webixUiId.objectDatatable).hideProgress();\n\t\t\t\t// \t})\n\t\t\t\t// \t.then(function (result) {\n\t\t\t\t// \t\t$$(self.webixUiId.objectDatatable).hideProgress();\n\t\t\t\t// \t});\n\t\t\t},\n\t\t\tonBeforeEditStop: function (state, editor) {\nconsole.error('!! ToDo: onBeforeEditStop()');\n\t\t\t\t// var column = AD.classes.AppBuilder.currApp.currObj.columns.filter(function (col) { return col.name == editor.column; });\n\n\t\t\t\t// if (!column || column.length < 1) return true;\n\t\t\t\t// column = column[0];\n\n\t\t\t\t// var passValidate = dataFieldsManager.validate(column, state.value);\n\n\t\t\t\t// if (!passValidate) {\n\t\t\t\t// \t$$(self.webixUiId.objectDatatable).editCancel();\n\t\t\t\t// }\n\n\t\t\t\t// return passValidate;\n\t\t\t},\n\t\t\tonAfterEditStop: function (state, editor, ignoreUpdate) {\n\t\t\t\t_logic.onAfterEditStop(state, editor, ignoreUpdate);\n\t\t\t},\n\t\t\tonAfterLoad: function () {\n\t\t\t\t_logic.onAfterLoad();\n\t\t\t},\n\t\t\tonColumnResize: function (id, newWidth, oldWidth, user_action) {\nconsole.error('!! ToDo: onColumnResize()');\n\t\t\t\t// var columnConfig = $$(self.webixUiId.objectDatatable).getColumnConfig(id);\n\t\t\t\t// var column = self.data.columns.filter(function (col) { return col.id == columnConfig.dataId; });\n\t\t\t\t// if (column && column[0])\n\t\t\t\t// \tcolumn[0].setWidth(newWidth);\n\n\t\t\t\t// // if (typeof columnConfig.template !== 'undefined' && columnConfig.template !== null) {\n\t\t\t\t// // \t// For calculate/refresh row height\n\t\t\t\t// // \t$$(self.webixUiId.objectDatatable).render();\n\t\t\t\t// // }\n\t\t\t},\n\t\t\tonBeforeColumnDrag: function (sourceId, event) {\nconsole.error('!! ToDo: onBeforeColumnDrag()');\n\t\t\t\t// if (sourceId === 'appbuilder_trash') // Remove column\n\t\t\t\t// \treturn false;\n\t\t\t\t// else\n\t\t\t\t// \treturn true;\n\t\t\t},\n\t\t\tonBeforeColumnDrop: function (sourceId, targetId, event) {\nconsole.error('!! ToDo: onBeforeColumnDrag()');\n\t\t\t\t// if (targetId === 'appbuilder_trash') // Remove column\n\t\t\t\t// \treturn false;\n\n\t\t\t\t// if ($$(self.webixUiId.visibleButton).config.badge > 0) {\n\t\t\t\t// \twebix.alert({\n\t\t\t\t// \t\ttitle: self.labels.object.couldNotReorderField,\n\t\t\t\t// \t\tok: self.labels.common.ok,\n\t\t\t\t// \t\ttext: self.labels.object.couldNotReorderFieldDetail\n\t\t\t\t// \t});\n\n\t\t\t\t// \treturn false;\n\t\t\t\t// }\n\t\t\t},\n\t\t\tonAfterColumnDrop: function (sourceId, targetId, event) {\nconsole.error('!! ToDo: onAfterColumnDrop()');\n\t\t\t\t// self.reorderColumns();\n\t\t\t},\n\t\t\tonAfterColumnShow: function (id) {\nconsole.error('!! ToDo: onAfterColumnShow()');\n\t\t\t\t// $$(self.webixUiId.visibleFieldsPopup).showField(id);\n\t\t\t},\n\t\t\tonAfterColumnHide: function (id) {\nconsole.error('!! ToDo: onAfterColumnHide()');\n\t\t\t\t// $$(self.webixUiId.visibleFieldsPopup).hideField(id);\n\t\t\t},\n\n\t\t\tonHeaderClick: function (id, e, node) {\n\t\t\t\t_logic.onHeaderClick(id, e, node);\n\t\t\t}\n\t\t}\n\t}\n\n\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function(options) {\n\n\t\t// register our callbacks:\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n\t\t// webix.extend($$(ids.form), webix.ProgressBar);\n\n\t\t// NOTE: register the onAfterRender() here, so it only registers\n\t\t// one.\n\t\tvar DataTable = $$(ids.component);\n\t\tvar throttleOnAfterRender = null;\n\t\tDataTable.attachEvent(\"onAfterRender\", function(data){\n\n\t\t\tif (throttleOnAfterRender) clearTimeout(throttleOnAfterRender);\n\t\t\tthrottleOnAfterRender = setTimeout(()=>{\n\t\t\t\tif (CurrentObject) {\n\t\t\t\t\tCurrentObject.customDisplays(data, App, DataTable);\n\t\t\t\t}\n\t\t\t}, 150);\n\n\t\t});\n\n\t}\n\n\n\tvar CurrentObject = null;\t\t// current ABObject being displayed\n\tvar EditField\t= null;\t\t\t// which field (column header) is popup editor for\n\tvar EditNode\t= null;\t\t\t// which html node (column header) is popup editor for\n\n\t// our internal business logic\n\tvar _logic = {\n\n\n\t\tcallbacks:{\n\n\t\t\t/**\n\t\t\t * @function onEditorMenu\n\t\t\t * report back which menu action was clicked.\n\t\t\t * We get the info from our popupHeaderEditor component, but all the\n\t\t\t * logic to respond to those options are in our parent. So we pass it\n\t\t\t * on ...\n\t\t\t *\n\t\t\t * @param {string} action [ 'hide', 'filter', 'sort', 'edit', 'delete' ]\n\t\t\t * @param {ABField} field  the field to which the action is to be applied\n\t\t\t * @param {dom} node  the optional html node for this header item.\n\t\t\t */\n\t\t\tonEditorMenu: function(action, field) {  }\n\t\t},\n\n\n\t\t/**\n\t\t * @function callbackHeaderEdit\n\t\t *\n\t\t * call back for when an item in the Header Edit Menu has been selected.\n\t\t * @param {string} action the action requested for this field:\n\t\t */\n\t\tcallbackHeaderEdit: function(action) {\n\n\t\t\tPopupHeaderEdit.hide();\n\t\t\t_logic.callbacks.onEditorMenu(action, EditField, EditNode);\n\t\t},\n\n\t\t/**\n\t\t * @function getColumnIndex\n\t\t *\n\t\t * return the column index of a given column ID\n\t\t * @param {string} id column id you want the index of\n\t\t */\n\t\tgetColumnIndex: function(id) {\n\t\t\tvar DataTable = $$(ids.component);\n\n\t\t\treturn DataTable.getColumnIndex(id);\n\t\t},\n\n\t\t/**\n\t\t * @function getColumnConfig\n\t\t *\n\t\t * return the column config of a datagrid\n\t\t * @param {string} id datagrid id you want the column info from\n\t\t */\n\t\tgetFieldList: function() {\n\t\t\tvar DataTable = $$(ids.component);\n\n\t\t\treturn DataTable.fieldList;\n\t\t},\n\n\n\n\t\t/**\n\t\t * @function onAfterEditStop\n\t\t * When an editor is finished.\n\t\t * @param {json} state\n\t\t * @param {} editor\n\t\t * @param {} ignoreUpdate\n\t\t * @return\n\t\t */\n\t\tonAfterEditStop: function (state, editor, ignoreUpdate) {\n\n\t\t\t// state:   {value: \"new value\", old: \"old value\"}\n\t\t\t// editor:  { column:\"columnName\", row:ID, value:'value', getInputNode:fn(), config:{}, focus: fn(), getValue: fn(), setValue: function, getInputNode: function, render: function}\n\n\t\t\tvar DataTable = $$(ids.component);\n\n\t\t\tif (state.value != state.old) {\n\n\n//// LEFT OFF:\n// client side editor: ABFieldImage,\n\n\n\t\t\t\tvar item = DataTable.getItem(editor.row);\n\t\t\t\titem[editor.column] = state.value;\n\n\t\t\t\tDataTable.removeCellCss(item.id, editor.column, \"webix_invalid\");\n\t\t\t\tDataTable.removeCellCss(item.id, editor.column, \"webix_invalid_cell\");\n\n\t\t\t\tvar validator = CurrentObject.isValidData(item);\n\t\t\t\tif (validator.pass()) {\n\n\n//// Question: do we submit full item updates?  or just patches?\nvar patch = {};\npatch[editor.column] = item[editor.column];  // NOTE: isValidData() might also condition the data for sending.state.value;\n\n\t\t\t\t\tCurrentObject.model()\n\t\t\t\t\t.update(item.id, item)\n// .update(item.id, patch)\n\t\t\t\t\t.then(()=>{\n\n\t\t\t\t\t\tDataTable.updateItem(editor.row, item);\n\t\t\t\t\t\tDataTable.clearSelection();\n\t\t\t\t\t\tDataTable.refresh(editor.row);\n\n\t\t\t\t\t})\n\t\t\t\t\t.catch((err)=>{\n\n\t\t\t\t\t\tOP.Error.log('Error saving item:', {error:err});\n\n\t\t\t\t\t\tDataTable.clearSelection();\n\t\t\t\t\t\tif (OP.Validation.isGridValidationError(err, editor.row, DataTable)) {\n\n// Do we reset the value?\n// item[editor.column] = state.old;\n// DataTable.updateItem(editor.row, item);\n\n\t\t\t\t\t\t} else {\n\n// this was some other Error!\n\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t})\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvalidator.updateGrid(editor.row, DataTable);\n\t\t\t\t}\n\n\n\n\t\t\t} else {\n\n\t\t\t\tDataTable.clearSelection();\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t\t\t// var item = $$(self.webixUiId.objectDatatable).getItem(editor.row);\n\n\t\t\t\t// self.updateRowData(state, editor, ignoreUpdate)\n\t\t\t\t// \t.fail(function (err) { // Cached\n\t\t\t\t// \t\titem[editor.column] = state.old;\n\t\t\t\t// \t\t$$(self.webixUiId.objectDatatable).updateItem(editor.row, item);\n\t\t\t\t// \t\t$$(self.webixUiId.objectDatatable).refresh(editor.row);\n\n\t\t\t\t// \t\t// TODO : Message\n\n\t\t\t\t// \t\t$$(self.webixUiId.objectDatatable).hideProgress();\n\t\t\t\t// \t})\n\t\t\t\t// \t.then(function (result) {\n\t\t\t\t// \t\tif (item) {\n\t\t\t\t// \t\t\titem[editor.column] = state.value;\n\n\t\t\t\t// \t\t\tif (result && result.constructor.name === 'Cached' && result.isUnsync())\n\t\t\t\t// \t\t\t\titem.isUnsync = true;\n\n\t\t\t\t// \t\t\t$$(self.webixUiId.objectDatatable).updateItem(editor.row, item);\n\t\t\t\t// \t\t}\n\n\t\t\t\t// \t\t// TODO : Message\n\n\t\t\t\t// \t\t$$(self.webixUiId.objectDatatable).hideProgress();\n\t\t\t\t// \t});\n\t\t},\n\n\t\tonAfterLoad: function() {\n\t\t\t_logic.sortTable();\n\t\t},\n\n\n\n\t\t/**\n\t\t * @function onAfterSelect\n\t\t * This is when a user clicks on a cell.  We use the onAfterSelect to\n\t\t * trigger a normal .editCell() if there isn't a custom editor for this field.\n\t\t * @param {json} data webix cell data\n\t\t * @return\n\t\t */\n\t\tonAfterSelect: function (data, prevent) {\n\t\t\t// data: {row: 1, column: \"name\", id: \"1_name\", toString: function}\n\t\t\t// data.row: .model.id\n\t\t\t// data.column => columnName of the field\n\n\n\t\t\t// Normal update data\n\t\t\t$$(ids.component).editCell(data.row, data.column);\n\n\n\t\t\t\t// var columnConfig = $$(self.webixUiId.objectDatatable).getColumnConfig(data.column),\n\t\t\t\t// \tfieldData = AD.classes.AppBuilder.currApp.currObj.columns.filter(function (col) { return col.name == data.column; });\n\n\t\t\t\t// if (!fieldData || fieldData.length < 1) {\n\t\t\t\t// \tconsole.log('System could not found this column data');\n\t\t\t\t// \treturn false;\n\t\t\t\t// } else\n\t\t\t\t// \tfieldData = fieldData[0];\n\n\t\t\t\t// // Custom update data\n\t\t\t\t// if (dataFieldsManager.hasCustomEdit(columnConfig.fieldName, fieldData))\n\t\t\t\t// \treturn false;\n\n\t\t\t\t// // Normal update data\n\t\t\t\t// this.editCell(data.row, data.column);\n\t\t},\n\n\n\t\t/**\n\t\t * @function onHeaderClick\n\t\t *\n\t\t * process the user clicking on the header for one of our columns.\n\t\t */\n\t\tonHeaderClick: function (id, e, node) {\n\n\t\t\t// Ignore system columns\n\t\t\tif (id.column == 'appbuilder_trash')\n\t\t\t\treturn false;\n\n\t\t\t// save our EditNode & EditField:\n\t\t\tEditNode = node;\n\n\t\t\tEditField = CurrentObject.fields(function(f){ return f.id == id.column; })[0];\n\t\t\tif (EditField) {\n\n\t\t\t\t// show the popup\n\t\t\t\tPopupHeaderEdit.show(node);\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\n\t\tobjectLoad:function(object) {\n\n\t\t\tCurrentObject = object;\n\n\t\t\tPopupHeaderEditComponent.objectLoad(object);\n\n\t\t\t_logic.refresh();\n\t\t},\n\n\n\n\t\t// rebuild the data table view:\n\t\trefresh: function() {\n\n\t\t\t// wait until we have an Object defined:\n\t\t\tif (CurrentObject) {\n\n\t\t\t\tvar DataTable = $$(ids.component);\n\t\t\t\tDataTable.clearAll();\n\n\n\t\t\t\t//// update DataTable structure:\n\t\t\t\tvar columnHeaders = CurrentObject.columnHeaders(true);\n\t\t\t\tDataTable.refreshColumns(columnHeaders)\n\t\t\t\t// freeze columns:\n\t\t\t\tif (CurrentObject.workspaceFrozenColumnID != \"\") {\n\t\t\t\t\tDataTable.define('leftSplit', DataTable.getColumnIndex(CurrentObject.workspaceFrozenColumnID) + 1);\n\t\t\t\t\tDataTable.refreshColumns()\n\t\t\t\t}\n\n\n\t\t\t\t// render custom displays:\n// \t\t\t\tvar throttleOnAfterRender = null;\n// \t\t\t\tDataTable.attachEvent(\"onAfterRender\", function(data){\n// webix.message('onAfterRender check')\n// \t\t\t\t\tif (throttleOnAfterRender) clearTimeout(throttleOnAfterRender);\n// \t\t\t\t\tthrottleOnAfterRender = setTimeout(()=>{\n// webix.message(\"onAfterRender()\");\n// \t\t\t\t\t\tCurrentObject.onAfterRender(data, App);\n// \t\t\t\t\t}, 150);\n// \t\t\t\t});\n\n\t\t\t\t//// update DataTable Content\n\n\t\t\t\t// Set the Model object with a condition / skip / limit, then\n\t\t\t\t// use it to load the DataTable:\n\t\t\t\t//// NOTE: this should take advantage of Webix dynamic data loading on\n\t\t\t\t//// larger data sets.\n\t\t\t\tCurrentObject.model()\n\t\t\t\t.where({})\n\t\t\t\t.skip(0)\n\t\t\t\t.limit(30)\n\t\t\t\t.loadInto(DataTable);\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t */\n\t\tshow:function() {\n\n\t\t\t$$(ids.component).show();\n\t\t},\n\n\t\t/**\n\t\t * @function sort(dir, a, b)\n\t\t *\n\t\t * Sort this component.\n\t\t */\n\t\tsort:function(dir, aValue, bValue) {\n\t\t\tvar result = false;\n\n\t\t\tif (dir == 'asc') {\n\t\t\t\tresult = aValue > bValue ? 1 : -1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresult = aValue < bValue ? 1 : -1;\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\n\t\tsortNext:function(dir, a, b, sorts, index) {\n\t\t\tvar index = index+1,\n\t\t\t\ta = a,\n\t\t\t\tb = b,\n\t\t\t\taValue = a[sorts[index].by],\n\t\t\t\tbValue = b[sorts[index].by],\n\t\t\t\tresult = false;\n\n\t\t\tif (aValue == bValue && sorts.length > index+1) {\n\t\t\t\tresult = _logic.sortNext(sorts[index].dir, a, b, sorts, index)\n\t\t\t} else {\n\t\t\t\tresult = _logic.sort(sorts[index].dir, aValue, bValue);\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\n\t\tsortTable:function() {\n\t\t\tvar DataTable = $$(ids.component);\n\n\t\t\tif (CurrentObject) {\n\t\t\t\tvar sorts = CurrentObject.workspaceSortFields;\n\n\t\t\t\tif (sorts.length > 0) {\n\t\t\t\t\tvar columnOrders = [];\n\n\t\t\t\t\tDataTable.sort(function (a, b) {\n\t\t\t\t\t\tvar result = false,\n\t\t\t\t\t\t\tindex = 0,\n\t\t\t\t\t\t\taValue = a[sorts[index].by],\n\t\t\t\t\t\t\tbValue = b[sorts[index].by];\n\n\t\t\t\t\t\tif (aValue == bValue && sorts.length > index+1) {\n\t\t\t\t\t\t\tresult = _logic.sortNext(sorts[index].dir, a, b, sorts, index);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult = _logic.sort(sorts[index].dir, aValue, bValue);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t}\n\n\n\n\t//// NOTE: declare these after _logic  for the callbacks:\n\n\tvar PopupHeaderEditComponent = OP.Component['ab_work_object_workspace_popupHeaderEditMenu'](App);\n\tvar PopupHeaderEdit = webix.ui(PopupHeaderEditComponent.ui);\n\tPopupHeaderEditComponent.init({\n\t\tonClick:_logic.callbackHeaderEdit\t\t// be notified when there is a change in the hidden fields\n\t})\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\t\t// interface methods for parent component:\n\t\tobjectLoad: _logic.objectLoad,\n\t\trefresh: _logic.refresh,\n\n\t\t// expose data for badge on frozen button\n\t\tgetColumnIndex: _logic.getColumnIndex,\n\n\t\t// expose data for column sort UI\n\t\tgetFieldList: _logic.getFieldList,\n\t\tsortTable: _logic.sortTable,\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_workspace_datatable.js","\n/*\n * ab_work_object_workspace_popupDefineLabel\n *\n * Manage the Add New Data Field popup.\n *\n */\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\tlabelFormat: L('ab.define_label.labelFormat', \"*Label format\"),\n\t\tselectFieldToGenerate: L('ab.define_label.selectFieldToGenerate', \"*Select field item to generate format.\"),\n\t\tlabelFields: L('ab.define_label.labelFields', \"*Fields\"),\n\t}\n}\n\n\nvar idBase = 'ab_work_object_workspace_popupDefineLabel';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\t// internal list of Webix IDs to reference our UI components.\n\t\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\t\tformat: App.unique(idBase + '_format'),\n\t\tlist: App.unique(idBase + '_list'),\n\n\t\tbuttonSave: App.unique(idBase + '_buttonSave'),\n\t}\n\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview:\"popup\",\n\t\tid: ids.component,\n\t\tmodal: true,\n\t\tautoheight:true,\n\t\t// maxHeight: 420,\n\n\t\twidth: 500,\n\t\tbody: {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: \"<b>{0}</b>\".replace(\"{0}\", labels.component.labelFormat)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\tid: ids.format,\n\t\t\t\t\theight: 100\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: labels.component.selectFieldToGenerate\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"label\",\n\t\t\t\t\tlabel: \"<b>{0}</b>\".replace(\"{0}\", labels.component.labelFields)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: 'list',\n\t\t\t\t\tid: ids.list,\n\t\t\t\t\twidth: 500,\n\t\t\t\t\tmaxHeight: 180,\n\t\t\t\t\tselect: false,\n\t\t\t\t\ttemplate: '#label#',\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: function (id, e, node) {\n\t\t\t\t\t\t\t_logic.onItemClick(id, e, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\theight: 10\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\", value: labels.common.cancel, width: 100, \n\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t_logic.buttonCancel(); \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\", id: ids.buttonSave, label: labels.common.save, type: \"form\", width: 120, \n\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t_logic.buttonSave();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\ton: {\n\t\t\tonShow: function () {\n\t\t\t\t_logic.onShow();\n\t\t\t}\n\t\t}\n\t}\n\n\n\tvar _currentObject = null;\n\n\t// Our init() function for setting up our UI\n\tvar _init = function(options) {\n\n\t\t// register our callbacks:\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n\t\twebix.extend($$(ids.list), webix.ProgressBar);\n\n\t}\n\n\n\n\t// our internal business logic \n\tvar _logic = {\n\n\t\t\n\t\tbuttonCancel:function() {\n\t\t\t$$(ids.component).hide();\n\t\t},\n\n\n\t\tbuttonSave:function() {\n\n\t\t\t// disable our save button\n\t\t\tvar ButtonSave = $$(ids.buttonSave);\n\t\t\tButtonSave.disable();\n\n\t\t\t// get our current labelFormt\n\t\t\tvar labelFormat = $$(ids.format).getValue();\n\n\t\t\t// start our spinner\n\t\t\tvar List = $$(ids.list);\n\t\t\tList.showProgress({ type: 'icon' });\n\n\t\t\t// convert from our User Friendly {Label} format to our \n\t\t\t// object friendly {Name} format\n\t\t\tList.data.each(function (d) {\n\t\t\t\tlabelFormat = labelFormat.replace(new RegExp('{' + d.label + '}', 'g'), '{' + d.id + '}');\n\t\t\t});\n\n\t\t\t// save the value\n\t\t\t_currentObject.labelFormat = labelFormat;\n\t\t\t_currentObject.save()\n\t\t\t.then(function(){\n\n\t\t\t\t// all good, so\n\t\t\t\tList.hideProgress();\t// hide the spinner\n\t\t\t\tButtonSave.enable();\t// enable the save button\n\t\t\t\t_logic.hide();\t\t\t// hide the popup\n\n\t\t\t\t// alert our parent component we are done with our changes:\n\t\t\t\t_logic.callbacks.onSave();\n\t\t\t})\n\t\t\t.catch(function(err){\n\t\t\t\tList.hideProgress();\t// hide the spinner\n\t\t\t\tButtonSave.enable();\t// enable the save button\n\n\t\t\t\t// display some error to the user:\n\t\t\t\tOP.Error.log('Error trying to save our Object', {error:err});\n\t\t\t})\n\t\t},\n\n\n\t\tcallbacks:{\n\t\t\tonCancel: function() { console.warn('NO onCancel()!') },\n\t\t\tonSave  : function(field) { console.warn('NO onSave()!') },\n\t\t},\n\n\n\t\thide:function() {\n\t\t\t$$(ids.component).hide();\n\t\t},\n\n\n\t\tobjectLoad: function(object) {\n\t\t\t_currentObject = object;\n\n\t\t\t// clear our list\n\t\t\tvar List = $$(ids.list);\n\t\t\tList.clearAll();\n\n\n\t\t\t// refresh list with new set of fields\n\t\t\tvar allFields = _currentObject.fields();\n\t\t\tvar listFields = [];\n\t\t\tallFields.forEach((f) => {\n\t\t\t\tlistFields.push({\n\t\t\t\t\tid: f.name,\n\t\t\t\t\tlabel: f.label\n\t\t\t\t})\n\t\t\t})\n\n\t\t\tList.parse(allFields);\n\t\t},\n\n\n\t\tonItemClick: function(id, e, node) {\n\n\t\t\tvar selectedItem = $$(ids.list).getItem(id);\n\n\t\t\tvar labelFormat = $$(ids.format).getValue();\n\t\t\tlabelFormat += '{{0}}'.replace('{0}', selectedItem.label);\n\n\t\t\t$$(ids.format).setValue(labelFormat);\n\t\t},\n\n\n\t\tonShow: function() {\n\n\t\t\t\tvar labelFormat = _currentObject.labelFormat;\n\n\t\t\t\tvar Format = $$(ids.format);\n\t\t\t\tvar List = $$(ids.list);\n\n\t\t\t\tFormat.setValue('');\n\n\t\t\t\tFormat.enable();\n\t\t\t\tList.enable();\n\t\t\t\t$$(ids.buttonSave).enable();\n\n\n\t\t\t\t// our labelFormat should be in a computer friendly {name} format\n\t\t\t\t// here we want to convert it to a user friendly {label} format\n\t\t\t\t// to use in our popup:\n\t\t\t\tif (labelFormat) {\n\t\t\t\t\tif (List.data && List.data.count() > 0) {\n\t\t\t\t\t\tList.data.each(function (d) {\n\t\t\t\t\t\t\tlabelFormat = labelFormat.replace('{' + d.id + '}', '{' + d.label + '}');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { \n\t\t\t\t\t// no label format:\n\t\t\t\t\t// Default to first field\n\t\t\t\t\tif (List.data && List.data.count() > 0) {\n\t\t\t\t\t\tvar field = List.getItem(List.getFirstId());\n\t\t\t\t\t\tlabelFormat = '{' + field.label + '}';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tFormat.setValue(labelFormat || '');\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t * @param {obj} $view  the webix.$view to hover the popup around.\n\t\t */\n\t\tshow:function($view) {\n\n\t\t\t$$(ids.component).show($view);\n\t\t}\n\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component  \n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\n\t\t// interface methods for parent component:\n\t\tobjectLoad: _logic.objectLoad,\n\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupDefineLabel.js","\n/*\n * ab_work_object_workspace_popupFrozenColumns\n *\n * Manage the Frozen Columns popup.\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\n\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\t\tclearAll: L('ab.frozen_fields.clearAll', \"*Clear All\"),\n\t\t// hideAll: L('ab.visible_fields.hideAll', \"*Hide All\"),\n\t}\n}\n\n\nvar idBase = 'ab_work_object_workspace_popupFrozenColumns';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\t// internal list of Webix IDs to reference our UI components\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\t\tlist: App.unique(idBase + \"_list\"),\n\t}\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview:\"popup\",\n\t\tid: ids.component,\n\t\t// modal: true,\n\t\tautoheight:true,\n\t\twidth: 500,\n\t\tbody: {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: 'button', value: labels.component.clearAll, click: function (id, e, node) {\n\t\t\t\t\t\t_logic.clickClearAll(id, e, node);\n\n\t\t\t\t\t\t// dataTable.define('leftSplit', 0);\n\t\t\t\t\t\t// dataTable.refreshColumns();\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// $$(ids.component).refreshShowIcons();\n\t\t\t\t\t\t// $$(ids.component).callChangeEvent();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: 'list',\n\t\t\t\t\tid: ids.list,\n\t\t\t\t\twidth: 250,\n\t\t\t\t\tautoheight: true,\n\t\t\t\t\tselect: false,\n\t\t\t\t\ttemplate: '<span style=\"min-width: 18px; display: inline-block;\"><i class=\"fa fa-circle-o ab-frozen-field-icon\"></i>&nbsp;</span> #label#',\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonItemClick: function (id, e, node) {\n\t\t\t\t\t\t\t_logic.clickListItem(id, e, node);\n\n\t\t\t\t\t\t\t// dataTable.define('leftSplit', dataTable.getColumnIndex(id) + 1);\n\t\t\t\t\t\t\t// dataTable.refreshColumns();\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t// $$(ids.component).refreshShowIcons();\n\t\t\t\t\t\t\t// $$(ids.component).callChangeEvent();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\ton: {\n\t\t\tonShow: function () {\n\t\t\t\t_logic.onShow();\n\t\t\t\t_logic.iconsReset();\n\t\t\t}\n\t\t}\n    }\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function(options) {\n\n\t\t// register our callbacks:\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n\t}\n\n\n\tvar CurrentObject = null;\n\n\t// our internal business logic\n\tvar _logic = {\n\n\t\tcallbacks:{\n\n\t\t\t/**\n\t\t\t * @function onChange\n\t\t\t * called when we have made changes to the hidden field settings\n\t\t\t * of our Current Object.\n\t\t\t *\n\t\t\t * this is meant to alert our parent component to respond to the\n\t\t\t * change.\n\t\t\t */\n\t\t\tonChange:function(){}\n\t\t},\n\n\n\t\t/**\n\t\t * @function clickClearAll\n\t\t * the user clicked the [clear all] option.  So show unfreeze all our columns.\n\t\t */\n\t\tclickClearAll: function () {\n\t\t\t// store empty string to not freeze any columns\n\t\t\tCurrentObject.workspaceFrozenColumnID = \"\";\n\t\t\tCurrentObject.save()\n\t\t\t.then(function(){\n\t\t\t\t_logic.iconsReset();\n\t\t\t\t_logic.callbacks.onChange();\n\t\t\t})\n\t\t\t.catch(function(err){\n\t\t\t\tOP.Error.log('Error trying to save workspaceFrozenColumnID', {error:err, fields:\"\" });\n\t\t\t})\n\t\t},\n\n\n\t\t/**\n\t\t * @function clickListItem\n\t\t * update the list to show which columns are frozen by showing an icon next to the column name\n\t\t */\n\t\tclickListItem: function(id, e, node) {\n\t\t\t// update our Object with current frozen column id\n\t\t\tvar List = $$(ids.list);\n\t\t\tvar recordClicked = List.getItem(id);\n\t\t\tvar label = recordClicked.label;\n\t\t\tCurrentObject.workspaceFrozenColumnID = label;\n\t\t\tCurrentObject.save()\n\t\t\t.then(function(){\n\t\t\t\t_logic.iconsReset();\n\t\t\t\t_logic.callbacks.onChange()\n\t\t\t})\n\t\t\t.catch(function(err){\n\t\t\t\tOP.Error.log('Error trying to save workspaceFrozenColumnID', {error:err, fields:label });\n\t\t\t})\n\t\t},\n\n\t\t/**\n\t\t * @function iconDefault\n\t\t * Hide the icon for the given node\n\t\t * @param {DOM} node  the html dom node of the element that contains our icon\n\t\t */\n\t\ticonDefault: function(node) {\n\t\t\tif (node) {\n\t\t\t\tnode.querySelector('.ab-frozen-field-icon').classList.remove(\"fa-circle\");\n\t\t\t\tnode.querySelector('.ab-frozen-field-icon').classList.add(\"fa-circle-o\");\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * @function iconFreeze\n\t\t * Show the icon for the given node\n\t\t * @param {DOM} node  the html dom node of the element that contains our icon\n\t\t */\n\t\ticonFreeze: function(node) {\n\t\t\tif (node) {\n\t\t\t\tnode.querySelector('.ab-frozen-field-icon').classList.remove(\"fa-circle-o\");\n\t\t\t\tnode.querySelector('.ab-frozen-field-icon').classList.add(\"fa-circle\");\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @function iconsReset\n\t\t * Reset the icon displays according to the current values in our Object\n\t\t */\n\t\ticonsReset: function() {\n\t\t\tvar List = $$(ids.list);\n\t\t\tvar isFrozen = false;\n\n\t\t\t// for each item in the List\n\t\t\tvar id = List.getFirstId();\n\t\t\twhile(id) {\n\t\t\t\tvar record = List.getItem(id);\n\t\t\t\tvar label = record.label;\n\n\t\t\t\t// find it's HTML Node\n\t\t\t\tvar node = List.getItemNode(id);\n\n\t\t\t\tif (CurrentObject.workspaceFrozenColumnID == \"\") {\n\t\t\t\t\t// if there isn't any frozen columns just use the plain icon\n\t\t\t\t\t_logic.iconDefault(node);\n\t\t\t\t} else if (isFrozen == false) {\n\t\t\t\t\t// if this item is not the frozen id it is frozen until we reach the frozen id\n\t\t\t\t\t_logic.iconFreeze(node);\n\t\t\t\t} else {\n\t\t\t\t\t// else just show default icon\n\t\t\t\t\t_logic.iconDefault(node);\n\t\t\t\t}\n\n\t\t\t\tif (CurrentObject.workspaceFrozenColumnID == label) {\n\t\t\t\t\tisFrozen = true;\n\t\t\t\t}\n\n\t\t\t\tif (CurrentObject.workspaceHiddenFields.indexOf(label) != -1) {\n\t\t\t\t\tnode.style.display = \"none\";\n\t\t\t\t} else {\n\t\t\t\t\tnode.style.display = \"\";\n\t\t\t\t}\n\n\t\t\t\t// next item\n\t\t\t\tid = List.getNextId(id);\n\t\t\t}\n\n\t\t},\n\n\n\t\t/**\n\t\t * @function objectLoad\n\t\t * Ready the Popup according to the current object\n\t\t * @param {ABObject} object  the currently selected object.\n\t\t */\n\t\tobjectLoad: function(object) {\n\t\t\tCurrentObject = object;\n\t\t},\n\n\t\tonShow: function() {\n\t\t\t// refresh list\n\t\t\tvar allFields = CurrentObject.fields();\n\t\t\tvar listFields = [];\n\t\t\tallFields.forEach((f) => {\n\t\t\t\tlistFields.push({\n\t\t\t\t\tid: f.id,\n\t\t\t\t\tlabel: f.label,\n\t\t\t\t\t$css:\"hidden_fields_\"+f.id\n\t\t\t\t})\n\t\t\t})\n\n\t\t\t$$(ids.list).parse(listFields);\n\t\t}\n\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t}\n\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\n\t\t// interface methods for parent component:\n\t\tobjectLoad: _logic.objectLoad,\n\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupFrozenColumns.js","\n/*\n * ab_work_object_workspace_popupHeaderEditMenu\n *\n * Manage the Add New Data Field popup.\n *\n */\n\n// import ABApplication from \"../classes/ABApplication\"\n// import ABFieldManager from \"../classes/ABFieldManager\"\n\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\thideField: L('ab.object.hideField', \"*Hide field\"),\n\t\tfilterField: L('ab.object.filterField', \"*Filter field\"),\n\t\tsortField: L('ab.object.sortField', \"*Sort field\"),\n\t\teditField: L('ab.object.editField', \"*Edit field\"),\n\t\tdeleteField: L('ab.object.deleteField', \"*Delete field\")\n\t}\n}\n\n\nvar idBase = 'ab_work_object_workspace_popupHeaderEditMenu';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\t// internal list of Webix IDs to reference our UI components.\n\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\t\t\n\t\tlist: App.unique(idBase + '_list')\n\t}\n\n\n\t// the list of options shown in the popup menu:\n\tvar menuItems = {\n\n\t\t// Normally all items are available\n\t\t'default': [\n\t\t\t{ command: labels.component.hideField, icon: \"fa-columns\" },\n\t\t\t{ command: labels.component.filterField, icon: \"fa-filter\" },\n\t\t\t{ command: labels.component.sortField, icon: \"fa-sort\" },\n\t\t\t{ command: labels.component.editField, icon: \"fa-pencil-square-o\" },\n\t\t\t{ command: labels.component.deleteField, icon: \"fa-trash\" }\n\t\t],\n\t\t// But for imported objects, edit & delete are disabled\n\t\t'imported': [\n\t\t\t{ command: labels.component.hideField, icon: \"fa-columns\" },\n\t\t\t{ command: labels.component.filterField, icon: \"fa-filter\" },\n\t\t\t{ command: labels.component.sortField, icon: \"fa-sort\" },\n\t\t\t//{ command: labels.editField, icon: \"fa-pencil-square-o\" },\n\t\t]\n\t};\n\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview:\"popup\",\n\t\tid: ids.component,\n\t\tmodal: false,\n\t\tautoheight:true,\n\n\n\t\twidth: 180,\n\t\tbody: {\n\t\t\tid: ids.list,\n\t\t\tview: 'list',\n\t\t\tdatatype: \"json\",\n\t\t\tautoheight: true,\n\t\t\tselect: false,\n\t\t\ttemplate: \"<i class='fa #icon#' aria-hidden='true'></i> #command#\",\n\t\t\tdata: menuItems['default'],\t// start with the default set:\n\t\t\ton: {\n\t\t\t\t'onItemClick': function (timestamp, e, node) {\n\t\t\t\t\t_logic.onItemClick(timestamp, e, node);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tvar CurrentObject = null;\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function(options) {\n\n\t\t// register our callbacks:\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n// $$(ids.editDefinitions).cells() // define the edit Definitions here.\n\t}\n\n\n\n\t// our internal business logic\n\tvar _logic = {\n\n\n\n\t\tcallbacks:{\n\t\t\t/**\n\t\t\t * @function onClick\n\t\t\t * report back which menu action was clicked.\n\t\t\t * possible actions: [ 'hide', 'filter', 'sort', 'edit', 'delete' ]\n\t\t\t */\n\t\t\tonClick: function(action) {  }\n\t\t},\n\n\n\n\t\thide:function() {\n\t\t\t$$(ids.component).hide();\n\t\t},\n\n\n\t\t/**\n\t\t * @function objectLoad\n\t\t * Ready the Popup according to the current object\n\t\t * @param {ABObject} object  the currently selected object.\n\t\t */\n\t\tobjectLoad: function(object) {\n\t\t\tCurrentObject = object;\n\n// TODO:\n// check if object is imported, if so, then switch the shown fields to the imported menu:\n\n\t\t\tvar listItems = menuItems['default'];\n// if (object.isImported) {\n// \tlistItems = menuItems['imported'];\n// }\n\t\t\tvar List = $$(ids.list);\n\t\t\tList.clearAll();\n\t\t\tList.parse(listItems);\n\t\t},\n\n\n\t\t/**\n\t\t * @function onItemClick\n\t\t * when an entry in our popup menu is selected, make sure our parent component is\n\t\t * alerted to the action requested.\n\t\t *\n\t\t * possible return action values: [ 'hide', 'filter', 'sort', 'edit', 'delete' ]\n\t\t *\n\t\t */\n\t\tonItemClick: function(timestamp, e, node) {\n\n\t\t\tvar action = null;\n\t\t\tvar menu = node.textContent.trim();\n\t\t\tswitch(menu) {\n\t\t\t\tcase labels.component.hideField:\n\t\t\t\t\taction = 'hide';\n\t\t\t\t\tbreak;\n\t\t\t\tcase labels.component.filterField:\n\t\t\t\t\taction = 'filter';\n\t\t\t\t\tbreak;\n\t\t\t\tcase labels.component.sortField:\n\t\t\t\t\taction = 'sort';\n\t\t\t\t\tbreak;\n\t\t\t\tcase labels.component.editField:\n\t\t\t\t\taction = 'edit';\n\t\t\t\t\tbreak;\n\t\t\t\tcase labels.component.deleteField:\n\t\t\t\t\taction = 'delete';\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t_logic.callbacks.onClick(action);\n\t\t},\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t * @param {obj} $view  the webix.$view to hover the popup around.\n\t\t */\n\t\tshow:function($view) {\n\n\t\t\t$$(ids.component).show($view);\n\t\t}\n\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\t\t// populateObjectPopupAddDataField: function(object) {\n\t\t// \t_currentObject = object;\n\t\t// }\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\n\t\thide: _logic.hide,\n\t\tobjectLoad: _logic.objectLoad, \n\t\tshow:_logic.show,\t\t// function($view, field_id) \n\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupHeaderEditMenu.js","\n/*\n * ab_work_object_workspace_popupHideFields\n *\n * Manage the Hide Fields popup.\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\n\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\tshowAll: L('ab.visible_fields.showAll', \"*Show All\"),\n\t\thideAll: L('ab.visible_fields.hideAll', \"*Hide All\"),\n\t\terrorFrozen: L('ab.visible_fields.errorFrozen', \"*Sorry, you cannot hide your last frozen column.\"),\n\t}\n}\n\n\nvar idBase = 'ab_work_object_workspace_popupHideFields';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\t// internal list of Webix IDs to reference our UI components\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\t\tlist: App.unique(idBase + \"_list\"),\n\t}\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview:\"popup\",\n\t\tid: ids.component,\n\t\t// modal: true,\n\t\tautoheight:true,\n        body: {\n            rows: [\n                {\n                    cols: [\n                        {\n                            view: 'button',\n                            value: labels.component.showAll,\n                            click: function () {\n\t\t\t\t\t\t\t\t_logic.clickShowAll();\n                            }\n                        },\n                        {\n                            view: 'button',\n                            value: labels.component.hideAll,\n                            click: function () {\n\t\t\t\t\t\t\t\t_logic.clickHideAll()\n                            }\n                        }\n                    ]\n                },\n                {\n                    view: 'list',\n                    id: ids.list,\n                    autoheight: true,\n                    select: false,\n                    template: '<span style=\"min-width: 18px; display: inline-block;\"><i class=\"fa fa-circle ab-visible-field-icon\"></i>&nbsp;</span> #label#',\n                    on: {\n                        onItemClick: function (id, e, node) {\n\t\t\t\t\t\t\t_logic.clickListItem(id, e, node);\n                        }\n                    }\n                }\n            ]\n        },\n        on: {\n            onShow: function () {\n\t\t\t\t_logic.onShow();\n                _logic.iconsReset();\n            }\n        }\n    }\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function(options) {\n\n\t\t// register our callbacks:\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n\t}\n\n\n\tvar CurrentObject = null;\n\n\t// our internal business logic\n\tvar _logic = {\n\n\t\tcallbacks:{\n\n\t\t\t/**\n\t\t\t * @function onChange\n\t\t\t * called when we have made changes to the hidden field settings\n\t\t\t * of our Current Object.\n\t\t\t *\n\t\t\t * this is meant to alert our parent component to respond to the\n\t\t\t * change.\n\t\t\t */\n\t\t\tonChange:function(){}\n\t\t},\n\n\n\t\t/**\n\t\t * @function clickHideAll\n\t\t * the user clicked the [hide all] option.  So hide all our fields.\n\t\t */\n\t\tclickHideAll: function () {\n\n\t\t\t// create an array of all our field.id's:\n\t\t\tvar allFields = CurrentObject.fields();\n\t\t\tvar newHidden = [];\n\t\t\tallFields.forEach(function(f){\n\t\t\t\tnewHidden.push(f.columnName);\n\t\t\t})\n\n\t\t\t// store that\n\t\t\tCurrentObject.workspaceHiddenFields = newHidden;\n\t\t\tCurrentObject.save()\n\t\t\t.then(function(){\n\t\t\t\t_logic.iconsReset()\n\t\t\t\t_logic.callbacks.onChange()\n\t\t\t})\n\t\t\t.catch(function(err){\n\t\t\t\tOP.Error.log('Error trying to save workspaceHiddenFields', {error:err, fields:newHidden });\n\t\t\t})\n\t\t},\n\n\n\t\t/**\n\t\t * @function clickShowAll\n\t\t * the user clicked the [show all] option.  So show all our fields.\n\t\t */\n\t\tclickShowAll: function () {\n\n\t\t\t// store an empty array of hidden fields\n\t\t\tCurrentObject.workspaceHiddenFields = [];\n\t\t\tCurrentObject.save()\n\t\t\t.then(function(){\n\t\t\t\t_logic.iconsReset();\n\t\t\t\t_logic.callbacks.onChange()\n\t\t\t})\n\t\t\t.catch(function(err){\n\t\t\t\tOP.Error.log('Error trying to save workspaceHiddenFields', {error:err, fields:newHidden });\n\t\t\t})\n\t\t},\n\n\n\t\t/**\n\t\t * @function clickListItem\n\t\t * update the clicked field setting.\n\t\t */\n\t\tclickListItem: function(id, e, node) {\n\t\t\tvar List = $$(ids.list);\n\t\t\tvar item = List.getItem(id);\n\t\t\tif (CurrentObject.workspaceFrozenColumnID == item.columnName) {\n\t\t\t\tOP.Dialog.Alert({\n\t\t\t\t\ttext: labels.component.errorFrozen\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar newFields = [];\n\t\t\tvar isHidden = CurrentObject.workspaceHiddenFields.filter((fID) => { return fID == item.columnName;}).length>0;\n\t\t\tif (isHidden) {\n\t\t\t\t// unhide this field\n\n\t\t\t\t// get remaining fields\n\t\t\t\tnewFields = CurrentObject.workspaceHiddenFields.filter((fID)=>{ return fID != item.columnName;});\n\n\t\t\t\t// find the icon and display it:\n\t\t\t\t_logic.iconShow(node);\n\n\t\t\t} else {\n\t\t\t\tnewFields = CurrentObject.workspaceHiddenFields;\n\t\t\t\tnewFields.push(item.columnName);\n\n\t\t\t\t_logic.iconHide(node);\n\t\t\t}\n\n\t\t\t// update our Object with current hidden fields\n\t\t\tCurrentObject.workspaceHiddenFields = newFields;\n\t\t\tCurrentObject.save()\n\t\t\t.then(function(){\n\t\t\t\t_logic.callbacks.onChange()\n\t\t\t})\n\t\t\t.catch(function(err){\n\t\t\t\tOP.Error.log('Error trying to save workspaceHiddenFields', {error:err, fields:newFields });\n\t\t\t})\n\t\t},\n\n\t\t/**\n\t\t * @function iconFreezeOff\n\t\t * Remove thumb tack if the field is not the choosen frozen column field\n\t\t * @param {DOM} node  the html dom node of the element that contains our icon\n\t\t */\n\t\ticonFreezeOff: function(node) {\n\t\t\tif (node) {\n\t\t\t\tnode.querySelector('.ab-visible-field-icon').classList.remove(\"fa-thumb-tack\");\n\t\t\t\tnode.querySelector('.ab-visible-field-icon').classList.add(\"fa-circle\");\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @function iconFreezeOn\n\t\t * Show a thumb tack if the field is the choosen frozen column field\n\t\t * @param {DOM} node  the html dom node of the element that contains our icon\n\t\t */\n\t\ticonFreezeOn: function(node) {\n\t\t\tif (node) {\n\t\t\t\tnode.querySelector('.ab-visible-field-icon').classList.remove(\"fa-circle\");\n\t\t\t\tnode.querySelector('.ab-visible-field-icon').classList.add(\"fa-thumb-tack\");\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * @function iconHide\n\t\t * Hide the icon for the given node\n\t\t * @param {DOM} node  the html dom node of the element that contains our icon\n\t\t */\n\t\ticonHide: function(node) {\n\t\t\tif (node) {\n\t\t\t\tnode.querySelector('.ab-visible-field-icon').style.visibility = \"hidden\";\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * @function iconShow\n\t\t * Show the icon for the given node\n\t\t * @param {DOM} node  the html dom node of the element that contains our icon\n\t\t */\n\t\ticonShow: function(node) {\n\t\t\tif (node) {\n\t\t\t\tnode.querySelector('.ab-visible-field-icon').style.visibility = \"visible\";\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * @function iconsReset\n\t\t * Reset the icon displays according to the current values in our Object\n\t\t */\n\t\ticonsReset: function() {\n\n\t\t\tvar List = $$(ids.list);\n\n\t\t\t// for each item in the List\n\t\t\tvar id = List.getFirstId();\n\t\t\twhile(id) {\n\t\t\t\tvar item = List.getItem(id);\n\n\t\t\t\t// find it's HTML Node\n\t\t\t\tvar node = List.getItemNode(id);\n\n\t\t\t\tif (CurrentObject.workspaceFrozenColumnID == item.columnName) {\n\t\t\t\t\t_logic.iconFreezeOn(node);\n\t\t\t\t} else {\n\t\t\t\t\t_logic.iconFreezeOff(node);\n\t\t\t\t}\n\n\t\t\t\t// if this item is not hidden, show it.\n\t\t\t\tif (CurrentObject.workspaceHiddenFields.indexOf(item.columnName) == -1) {\n\t\t\t\t\t_logic.iconShow(node);\n\t\t\t\t} else {\n\t\t\t\t\t// else hide it\n\t\t\t\t\t_logic.iconHide(node);\n\t\t\t\t}\n\n\t\t\t\t// next item\n\t\t\t\tid = List.getNextId(id);\n\t\t\t}\n\n\t\t},\n\n\n\t\t/**\n\t\t * @function objectLoad\n\t\t * Ready the Popup according to the current object\n\t\t * @param {ABObject} object  the currently selected object.\n\t\t */\n\t\tobjectLoad: function(object) {\n\t\t\tCurrentObject = object;\n\t\t},\n\n\t\t/**\n\t\t * @function onShow\n\t\t * Ready the Popup according to the current object each time it is shown (perhaps a field was created or delted)\n\t\t */\n\t\tonShow: function() {\n\t\t\t// refresh list\n\t\t\tvar allFields = CurrentObject.fields();\n\t\t\tvar listFields = [];\n\t\t\tallFields.forEach((f) => {\n\t\t\t\tlistFields.push({\n\t\t\t\t\tid: f.id,\n\t\t\t\t\tlabel: f.label,\n\t\t\t\t\tcolumnName: f.columnName\n\t\t\t\t})\n\t\t\t})\n\n\t\t\t$$(ids.list).parse(allFields);\n\t\t}\n\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t}\n\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\n\t\t// interface methods for parent component:\n\t\tobjectLoad: _logic.objectLoad,\n\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupHideFields.js","\n/*\n * ab_work_object_workspace_popupNewDataField\n *\n * Manage the Add New Data Field popup.\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\nimport ABFieldManager from \"../classes/ABFieldManager\"\n\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\n\t\tfieldType: L('ab.add_fields.fieldType', \"*Field type\"),\n\t\tlabel: L('ab.add_fields.label', \"*Label\"),\n\t\taddNewField: L('ab.add_fields.addNewField', \"*Add Column\"),\n\n\n\t}\n}\n\n\nvar idBase = 'ab_work_object_workspace_popupNewDataField';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\t// internal list of Webix IDs to reference our UI components.\n\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\t\ttypes: App.unique(idBase + '_types'),\n\t\teditDefinitions: App.unique(idBase+'_editDefinitions'),\n\n\t\tbuttonSave: App.unique(idBase+'_buttonSave'),\n\t\tbuttonCancel: App.unique(idBase+'_buttonCancel')\n\t}\n\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview:\"popup\",\n\t\tid: ids.component,\n\t\tmodal: true,\n\t\tautoheight:true,\n\t\t// maxHeight: 420,\n\n// ready: function () {\n// \tconsole.error('ready() called!!!')\n// \t_logic.resetState();\n// },\n\n\t\tbody: {\n\t\t\tcss: 'ab-add-fields-popup',\n\t\t\tborderless: true,\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"richselect\",\n\t\t\t\t\tid: ids.types,\n\t\t\t\t\tlabel: labels.component.fieldType,\n\t\t\t\t\tlabelWidth: App.config.labelWidthLarge,\n\t\t\t\t\toptions: [\n\t\t\t\t\t\t//We will add these later\n\t\t\t\t\t\t{ id:'temporary', view:'temporary' }\n\t\t\t\t\t],\n\t\t\t\t\ton: {\n\t\t\t\t\t\tonChange: function (id, ev, node) {\n\t\t\t\t\t\t\t_logic.onChange(id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\theight: 10,\n\t\t\t\t\ttype: \"line\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview:'multiview',\n\t\t\t\t\tid: ids.editDefinitions,\n\t\t\t\t\t// NOTE: can't leave this an empty []. We redefine this value later.\n\t\t\t\t\tcells: [ { id:'del_me', view:'label', label:'edit definition here' } ]\n\t\t\t\t},\n\t\t\t\t{ height: 10 },\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{ fillspace: true },\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\tvalue: labels.common.cancel,\n\t\t\t\t\t\t\tcss: \"ab-cancel-button\",\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t_logic.buttonCancel();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\tid: ids.buttonSave,\n\t\t\t\t\t\t\tlabel: labels.component.addNewField,\n\t\t\t\t\t\t\tautowidth: true,\n\t\t\t\t\t\t\ttype: \"form\",\n\t\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t\t_logic.buttonSave();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\ton: {\n\t\t\tonBeforeShow: function () {\n\t\t\t\t_logic.resetState();\n\t\t\t},\n\t\t\tonShow: function () {\n\t\t\t\t_logic.onShow();\n\t\t\t},\n\t\t\tonHide: function () {\n\t\t\t\t_logic.resetState();\n\t\t\t}\n\t\t}\n\t}\n\n\n\tvar _objectHash = {};\t\t// 'name' => ABFieldXXX object\n\tvar _componentHash = {};\t// 'name' => ABFieldXXX ui component\n\tvar _componentsByType = {}; // 'type' => ABFieldXXX ui component\n\tvar _currentEditor = null;\n\tvar _currentObject = null;\n\n\tvar defaultEditorComponent = null;\t// the default editor.\n\tvar defaultEditorID = null;\t// the default editor id.\n\tvar submenus = [];\t// Create the submenus for our Data Fields:\n\n\tvar _editField = null;\t\t// field instance being edited\n\n\t// Our init() function for setting up our UI\n\tvar _init = function(options) {\n\n\t\t// register our callbacks:\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n\n\t\tvar Fields = ABFieldManager.allFields();\n\n\n\t\t//// we need to load a submenu entry and an editor definition for each\n\t\t//// of our Fields\n\n\n\n\t\tvar newEditorList = {\n\t\t\tview:'multiview',\n\t\t\tid:ids.editDefinitions,\n\t\t\trows:[]\n\t\t}\n\n\t\tFields.forEach(function(F){\n\n\t\t\tvar menuName = F.defaults().menuName ;\n\t\t\tvar key = F.defaults().key;\n\n\t\t\t// add a submenu for the fields multilingual key\n\t\t\tsubmenus.push( {\"id\":menuName, \"value\":menuName} );\n\n\n\t\t\t// Add the Field's definition editor here:\n\t\t\tvar editorComponent = F.propertiesComponent(App);\n\t\t\tif (!defaultEditorComponent) {\n\t\t\t\tdefaultEditorComponent = editorComponent;\n\t\t\t\tdefaultEditorID = menuName;\n\t\t\t}\n\t\t\tnewEditorList.rows.push(editorComponent.ui);\n\n\n\t\t\t_objectHash[ menuName ] = F;\n\t\t\t_componentHash[ menuName ] = editorComponent;\n\t\t\t_componentsByType[ key ]  = editorComponent;\n\n\t\t})\n\n\n\t\t// the submenu button has a placeholder we need to remove and update\n\t\t// with one that has all our submenus in it.\n\t\t// var firstID = $$(ids.types).getFirstId();\n\t\t// $$(ids.types).updateItem(firstID, {\n\t\t// \tvalue: labels.component.chooseType,\n\t\t// \tsubmenu: submenus\n\t\t// })\n\t\t$$(ids.types).define(\"options\",submenus);\n\t\t$$(ids.types).refresh\n\n\t\t// now remove the 'del_me' definition editor placeholder.\n\t\twebix.ui(newEditorList, $$(ids.editDefinitions));\n\n\t\t// hide all the unused editors:\n\t\tfor (var c in _componentHash){\n\t\t\t_componentHash[c].hide();\n\t\t}\n\n\t\tdefaultEditorComponent.show(); // show the default editor\n\t\t_currentEditor = defaultEditorComponent;\n\n\t\t// set the richselect to the first option by default.\n\t\t$$(ids.types).setValue(submenus[0].id);\n\n\t\t// $$(ids.editDefinitions).show();\n\n// $$(ids.editDefinitions).cells() // define the edit Definitions here.\n\t}\n\n\n\n\t// our internal business logic\n\tvar _logic = {\n\n\n\t\tbuttonCancel:function() {\n\n\t\t\t_logic.resetState();\n\n\t\t\t// clear all editors:\n\t\t\tfor (var c in _componentHash) {\n\t\t\t\t_componentHash[c].clear();\n\t\t\t}\n\n\t\t\t// hide this popup.\n\t\t\t$$(ids.component).hide();\n\t\t},\n\n\n\t\tbuttonSave:function() {\n\n\t\t\t$$(ids.buttonSave).disable();\n\n\n\t\t\tvar editor = _currentEditor;\n\t\t\tif (editor) {\n\n\t\t\t\t// the editor can define some basic form validations.\n\t\t\t\tif (editor.isValid()) {\n\n\t\t\t\t\tvar values = editor.values();\n\n\t\t\t\t\tvar field = null;\n\t\t\t\t\tvar oldData = null;\n\n\t\t\t\t\t// if this is an ADD operation, (_editField will be undefined)\n\t\t\t\t\tif (!_editField) {\n\n\t\t\t\t\t\t// get a new instance of a field:\n\t\t\t\t\t\tfield = _currentObject.fieldNew(values);\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// use our _editField, backup our oldData\n\t\t\t\t\t\toldData = _editField.toObj();\n\t\t\t\t\t\t_editField.fromValues(values);\n\n\t\t\t\t\t\tfield = _editField;\n\t\t\t\t\t}\n\n\n\t\t\t\t\tvar validator = field.isValid();\n\t\t\t\t\tif (validator.fail()) {\n\t\t\t\t\t\tvalidator.updateForm($$(editor.ui.id))\n// OP.Form.isValidationError(errors, $$(editor.ui.id));\n\n\t\t\t\t\t\t// keep our old data\n\t\t\t\t\t\tif (oldData) {\n\t\t\t\t\t\t\tfield.fromValues(oldData);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$$(ids.buttonSave).enable();\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tfield.save()\n\t\t\t\t\t\t.then(()=>{\n\n\t\t\t\t\t\t\t$$(ids.buttonSave).enable();\n\t\t\t\t\t\t\t_logic.hide();\n\t\t\t\t\t\t\t_currentEditor.clear();\n\t\t\t\t\t\t\t_logic.callbacks.onSave(field)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\tOP.Validation.isFormValidationError(err, $$(editor.ui.id));\n\t\t\t\t\t\t\t$$(ids.buttonSave).enable();\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\n\n\t\t\t\t} else {\n\t\t\t\t\t$$(ids.buttonSave).enable();\n\t\t\t\t}\n\n\t\t\t}  else {\n\n\t\t\t\tOP.Dialog.Alert({\n\t\t\t\t\ttitle: '! Could not find the current editor.',\n\t\t\t\t\ttext: 'go tell a developer about this.'\n\t\t\t\t})\n\t\t\t\t$$(ids.buttonSave).enable();\n\t\t\t}\n\n// if (!inputValidator.validateFormat(fieldInfo.name)) {\n// \tself.enable();\n// \treturn;\n// }\n\n// // Validate duplicate field name\n// var existsColumn = $.grep(dataTable.config.columns, function (c) { return c.id == fieldInfo.name.replace(/ /g, '_'); });\n// if (existsColumn && existsColumn.length > 0 && !data.editFieldId) {\n// \twebix.alert({\n// \t\ttitle: labels.add_fields.duplicateFieldTitle,\n// \t\ttext: labels.add_fields.duplicateFieldDescription,\n// \t\tok: labels.common.ok\n// \t});\n// \tthis.enable();\n// \treturn;\n// }\n\n// if (fieldInfo.weight == null)\n// \tfieldInfo.weight = dataTable.config.columns.length;\n\n// // Call callback function\n// if (base.saveFieldCallback && base.fieldName) {\n// \tbase.saveFieldCallback(base.fieldName, fieldInfo)\n// \t\t.then(function () {\n// \t\t\tself.enable();\n// \t\t\tbase.resetState();\n// \t\t\tbase.hide();\n// \t\t});\n// }\n\n\n\t\t},\n\n\n\t\tcallbacks:{\n\t\t\tonCancel: function() { console.warn('NO onCancel()!') },\n\t\t\tonSave  : function(field) { console.warn('NO onSave()!') },\n\t\t},\n\n\n\n\t\thide:function() {\n\t\t\t$$(ids.component).hide();\n\t\t},\n\n\n\n\t\tmodeAdd:function() {\n\n\t\t\t// show default editor:\n\t\t\tdefaultEditorComponent.show(false, false);\n\t\t\t_currentEditor = defaultEditorComponent;\n\n\t\t\t// show the ability to switch data types\n\t\t\t$$(ids.types).show();\n\n\t\t\t// change button text to 'add'\n\t\t\t$$(ids.buttonSave).define('label', labels.component.addNewField);\n\t\t\t$$(ids.buttonSave).refresh();\n\t\t},\n\n\n\t\tmodeEdit: function(field) {\n\n\t\t\tif (_currentEditor) _currentEditor.hide();\n\n\t\t\t// switch to this field's editor:\n\t\t\t// hide the rest\n\t\t\tfor(var c in _componentsByType) {\n\t\t\t\tif (c == field.key) {\n\t\t\t\t\t_componentsByType[c].populate(field);\n\t\t\t\t\t_componentsByType[c].show(false, false);\n\t\t\t\t\t_currentEditor = _componentsByType[c];\n\t\t\t\t} else {\n\t\t\t\t\t_componentsByType[c].hide();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// hide the ability to switch data types\n\t\t\t$$(ids.types).hide();\n\n\t\t\t// change button text to 'save'\n\t\t\t$$(ids.buttonSave).define('label', labels.common.save);\n\t\t\t$$(ids.buttonSave).refresh();\n\t\t},\n\n\n\t\t/**\n\t\t * @function onChange\n\t\t * swap the editor view to match the data field selected in the menu.\n\t\t *\n\t\t * @param {string} name  the menuName() of the submenu that was selected.\n\t\t */\n\t\tonChange: function (name) {\n\t\t\t// note, the submenu returns the Field.menuName() values.\n\t\t\t// we use that to lookup the Field here:\n\t\t\tvar editor = _componentHash[name];\n\t\t\tif (editor) {\n\t\t\t\teditor.show();\n\t\t\t\t_currentEditor = editor;\n\t\t\t\t$$(ids.types).blur();\n\t\t\t} else {\n\n\t\t\t\t// most likely they clicked on the menu button itself.\n\t\t\t\t// do nothing.\n\n\t\t\t\t// OP.Error.log(\"App Builder:Workspace:Object:NewDataField: could not find editor for submenu item:\"+name, { name:name });\n\t\t\t}\n\n\t\t},\n\n\n\n\t\tonShow: function() {\n\t\t\t// if (!AD.comm.isServerReady()) {\n\t\t\t// \tthis.getTopParentView().hide();\n\n\t\t\t// \twebix.alert({\n\t\t\t// \t\ttitle: labels.add_fields.cannotUpdateFields,\n\t\t\t// \t\ttext: labels.add_fields.waitRestructureObjects,\n\t\t\t// \t\tok: labels.common.ok\n\t\t\t// \t});\n\t\t\t// }\n\t\t\t// else { // Set default field type\n\t\t\t// \tthis.showFieldData('string');\n\t\t\t// }\nconsole.error('TODO: onShow();')\n\t\t},\n\n\n\n\t\tresetState: function() {\n\t\t\tdefaultEditorComponent.show(); // show the default editor\n\t\t\t_currentEditor = defaultEditorComponent;\n\n\t\t\t// set the richselect to the first option by default.\n\t\t\t$$(ids.types).setValue(submenus[0].id);\n\n\t\t\t// add mode :  change button text to 'Add'\n\t\t\t// show the default editor\nconsole.error('TODO: resetState()');\n\t\t},\n\n\n\n\t\t/**\n\t\t * @function show()\n\t\t *\n\t\t * Show this component.\n\t\t * @param {obj} $view  the webix.$view to hover the popup around.\n\t\t * @param {ABField} field the ABField to edit.  If not provided, then\n\t\t *\t\t\t\t\t\t  this is an ADD operation.\n\t\t */\n\t\tshow:function($view, field) {\n\n\t\t\t_editField = field;\n\n\t\t\tif (_editField) {\n\n\t\t\t\t_logic.modeEdit(field);\n\n\t\t\t} else {\n\n\t\t\t\t_logic.modeAdd();\n\n\t\t\t}\n\n\t\t\t$$(ids.component).show($view);\n\t\t},\n\n\n\n\t\ttypeClick:function() {\n\t\t\t// NOTE: for functional testing we need a way to display the submenu\n\t\t\t// (functional tests don't do .hover very well)\n\t\t\t// so this routine is to enable .click() to show the submenu.\n\n\t\t\tvar subMenuId = $$(ids.types).config.data[0].submenu;\n\n\t\t\t// #HACK Sub-menu popup does not render on initial\n\t\t\t// Force it to render popup by use .getSubMenu()\n\t\t\tif (typeof subMenuId != 'string') {\n\t\t\t\t$$(ids.types).getSubMenu($$(ids.types).config.data[0].id);\n\t\t\t\tsubMenuId = $$(ids.types).config.data[0].submenu;\n\t\t\t}\n\n\t\t\tif ($$(subMenuId))\n\t\t\t\t$$(subMenuId).show();\n\t\t}\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\t\tpopulateObjectPopupAddDataField: function(object) {\n\t\t\t_currentObject = object;\n\t\t}\n\n\t}\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\n\t\tshow:_logic.show,\t\t// {fn} \tfn(node, ABField)\n\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupNewDataField.js","\n/*\n * ab_work_object_workspace_popupSortFields\n *\n * Manage the Sort Fields popup.\n *\n */\n\nimport ABApplication from \"../classes/ABApplication\"\n\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\t\taddNewSort: \tL('ab.sort_fields.addNewSort', \t\"*Add new sort\"),\n\t\tselectField:\tL('ab.sort_fields.selectField', \"*Please select field\"),\n\t\ttextAsc:\t\tL('ab.sort_fields.textAsc', \t\"*A -> Z\"),\n\t\ttextDesc: \t\tL('ab.sort_fields.textDesc', \t\"*Z -> A\"),\n\t\tdateAsc: \t\tL('ab.sort_fields.dateAsc', \t\"*Before -> After\"),\n\t\tdateDesc: \t\tL('ab.sort_fields.dateDesc', \t\"*After -> Before\"),\n\t\tnumberAsc: \t\tL('ab.sort_fields.numberAsc', \t\"*1 -> 9\"),\n\t\tnumberDesc: \tL('ab.sort_fields.numberDesc', \t\"*9 -> 1\"),\n\t\tbooleanAsc: \tL('ab.sort_fields.booleanAsc', \t\"*Checked -> Unchecked\"),\n\t\tbooleanDesc: \tL('ab.sort_fields.booleanDesc', \"*Unchecked -> Checked\")\n\t}\n}\n\nvar idBase = 'ab_work_object_workspace_popupSortFields';\nOP.Component.extend(idBase, function(App) {\n\n\tlabels.common = App.labels;\n\n\n\t// internal list of Webix IDs to reference our UI components\n\tvar ids = {\n\t\tcomponent: App.unique(idBase + '_component'),\n\t\tlist: App.unique(idBase + \"_list\"),\n\t\tform: App.unique(idBase + \"_form\"),\n\t}\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n\t\tview:\"popup\",\n\t\tid: ids.component,\n\t\tautoheight:true,\n\t\twidth: 500,\n\t\tbody: {\n\t\t\tview: \"form\",\n\t\t\tid: ids.form,\n\t\t\tautoheight: true,\n\t\t\tborderless: true,\n\t\t\telements: [{\n\t\t\t\tview: \"button\", value: labels.component.addNewSort, click: function (id, e, node) {\n\t\t\t\t\t_logic.clickAddNewSort();\n\t\t\t\t}\n\t\t\t}]\n\t\t},\n\t\ton: {\n\t\t\tonShow: function () {\n\t\t\t\t_logic.onShow();\n\t\t\t}\n\t\t}\n    }\n\n\n\n\t// Our init() function for setting up our UI\n\tvar _init = function(options) {\n\t\t// register our callbacks:\n\t\tfor(var c in _logic.callbacks) {\n\t\t\t_logic.callbacks[c] = options[c] || _logic.callbacks[c];\n\t\t}\n\n\t}\n\n\n\tvar CurrentObject = null;\n\n\t// our internal business logic\n\tvar _logic = {\n\n\t\tcallbacks:{\n\n\t\t\t/**\n\t\t\t * @function onChange\n\t\t\t * called when we have made changes to the hidden field settings\n\t\t\t * of our Current Object.\n\t\t\t *\n\t\t\t * this is meant to alert our parent component to respond to the\n\t\t\t * change.\n\t\t\t */\n\t\t\tonChange:function(){}\n\t\t},\n\n\t\t/**\n\t\t * @function clickAddNewSort\n\t\t * the user clicked the add new sort buttton. I don't know what it does...will update later\n\t\t */\n\t\tclickAddNewSort: function(by, dir, as, id) {\n\t\t\t// Prevent duplicate fields\n\t\t\tvar sort_popup = $$(ids.component),\n\t\t\t\tsort_form = $$(ids.form);\n\n\t\t\tvar viewIndex = sort_form.getChildViews().length - 1;\n\t\t\tvar listFields = _logic.getFieldList(true);\n\t\t\tsort_form.addView({\n\t\t\t\tid: 'sort' + webix.uid(),\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"combo\",\n\t\t\t\t\t\twidth: 220,\n\t\t\t\t\t\toptions: listFields,\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\"onChange\": function (columnId) {\n\t\t\t\t\t\t\t\tvar allFields = CurrentObject.fields();\n\t\t\t\t\t\t\t\tvar columnConfig = \"\",\n\t\t\t\t\t\t\t\t\tsortDir = this.getParentView().getChildViews()[1],\n\t\t\t\t\t\t\t\t\tsortAs = this.getParentView().getChildViews()[2],\n\t\t\t\t\t\t\t\t\tdefaultAs = null,\n\t\t\t\t\t\t\t\t\toptions = null;\n\n\t\t\t\t\t\t\t\tallFields.forEach((f) => {\n\t\t\t\t\t\t\t\t\tif (f.columnName == columnId) {\n\t\t\t\t\t\t\t\t\t\tcolumnConfig = f\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tif (!columnConfig)\n\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\tswitch (columnConfig.key) {\n\t\t\t\t\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\t\t\t\t\toptions = [\n\t\t\t\t\t\t\t\t\t\t\t{ id: 'asc', value: labels.component.textAsc },\n\t\t\t\t\t\t\t\t\t\t\t{ id: 'desc', value: labels.component.textDesc }];\n\t\t\t\t\t\t\t\t\t\tdefaultAs = \"string\";\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\toptions = [\n\t\t\t\t\t\t\t\t\t\t\t{ id: 'asc', value: labels.component.dateAsc },\n\t\t\t\t\t\t\t\t\t\t\t{ id: 'desc', value: labels.component.dateDesc }];\n\t\t\t\t\t\t\t\t\t\tdefaultAs = \"date\";\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase \"number\":\n\t\t\t\t\t\t\t\t\t\toptions = [\n\t\t\t\t\t\t\t\t\t\t\t{ id: 'asc', value: labels.component.numberAsc },\n\t\t\t\t\t\t\t\t\t\t\t{ id: 'desc', value: labels.component.numberDesc }];\n\t\t\t\t\t\t\t\t\t\tdefaultAs = \"int\";\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tsortDir.define('options', options);\n\t\t\t\t\t\t\t\tsortDir.refresh();\n\n\t\t\t\t\t\t\t\tsortAs.setValue(defaultAs);\n\n\t\t\t\t\t\t\t\t_logic.refreshFieldList();\n\n\t\t\t\t\t\t\t\t_logic.saveSorts();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"segmented\", width: 200, options: [{ id: '', value: labels.component.selectField }],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function (newv, oldv) { // 'asc' or 'desc' values\n\t\t\t\t\t\t\t\t_logic.saveSorts();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"text\", width: 20, hidden: true, value: \"\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"button\", icon: \"trash\", type: \"icon\", width: 30, click: function () {\n\t\t\t\t\t\t\tsort_form.removeView(this.getParentView());\n\t\t\t\t\t\t\t_logic.refreshFieldList(true);\n\t\t\t\t\t\t\t_logic.saveSorts();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}, viewIndex);\n\n\t\t\t// Select field\n\t\t\tif (by) {\n\t\t\t\tvar fieldsCombo = sort_form.getChildViews()[viewIndex].getChildViews()[0];\n\t\t\t\tfieldsCombo.setValue(by);\n\t\t\t}\n\t\t\tif (dir) {\n\t\t\t\tvar segmentButton = sort_form.getChildViews()[viewIndex].getChildViews()[1];\n\t\t\t\tsegmentButton.setValue(dir);\n\t\t\t}\n\t\t\tif (as) {\n\t\t\t\tvar asField = sort_form.getChildViews()[viewIndex].getChildViews()[2];\n\t\t\t\tasField.setValue(as);\n\t\t\t}\n\t\t\t_logic.callbacks.onChange();\n\t\t},\n\n\t\t/**\n\t\t * @function getFieldList\n\t\t * return field list so we can present a custom UI for view\n\t\t */\n\t\tgetFieldList: function (excludeSelected) {\n\t\t\tvar sort_popup = $$(ids.component),\n\t\t\t\tsort_form = $$(ids.form),\n\t\t\t\tlistFields = [];\n\n\t\t\tif (!CurrentObject.fields())\n\t\t\t\treturn listFields;\n\n\t\t\t// Get all fields include hidden fields\n\t\t\tvar allFields = CurrentObject.fields();\n\t\t\tallFields.forEach((f) => {\n\t\t\t\tlistFields.push({\n\t\t\t\t\tid: f.columnName,\n\t\t\t\t\tlabel: f.label\n\t\t\t\t});\n\t\t\t})\n\n\t\t\t// Remove selected field\n\t\t\tif (excludeSelected) {\n\t\t\t\tvar childViews = sort_form.getChildViews();\n\t\t\t\tif (childViews.length > 1) { // Ignore 'Add new sort' button\n\t\t\t\t\tchildViews.forEach(function (cView, index) {\n\t\t\t\t\t\tif (childViews.length - 1 <= index)\n\t\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t\tvar selectedValue = cView.getChildViews()[0].getValue();\n\t\t\t\t\t\tif (selectedValue) {\n\t\t\t\t\t\t\tvar removeIndex = null;\n\t\t\t\t\t\t\tvar removeItem = $.grep(listFields, function (f, index) {\n\t\t\t\t\t\t\t\tif (f.id == selectedValue) {\n\t\t\t\t\t\t\t\t\tremoveIndex = index;\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tlistFields.splice(removeIndex, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn listFields;\n\t\t},\n\n\t\t// /**\n\t\t//  * @function sort\n\t\t//  * this preforms the sort on the datagrid (this may move to the datagrid once I read further)\n\t\t//  */\n\t\t// sort: function () {\n\t\t// \tvar sort_popup = $$(ids.component),\n\t\t// \t\tsort_form = $$(ids.form),\n\t\t// \t\tcolumnOrders = [];\n\t\t//\n\t\t// \tsort_form.getChildViews().forEach(function (cView, index) {\n\t\t// \t\tif (sort_form.getChildViews().length - 1 <= index) // Ignore 'Add a sort' button\n\t\t// \t\t\treturn;\n\t\t//\n\t\t// \t\tvar columnId = cView.getChildViews()[0].getValue();\n\t\t// \t\tvar order = cView.getChildViews()[1].getValue();\n\t\t//\n\t\t// \t\tif (columnId) {\n\t\t// \t\t\tvar columnConfig = sort_popup.dataTable.getColumnConfig(columnId);\n\t\t//\n\t\t// \t\t\tif (columnConfig) {\n\t\t// \t\t\t\tcolumnOrders.push({\n\t\t// \t\t\t\t\tname: columnConfig.id,\n\t\t// \t\t\t\t\torder: order\n\t\t// \t\t\t\t});\n\t\t// \t\t\t}\n\t\t// \t\t}\n\t\t// \t});\n\t\t//\n\t\t// \tsort_popup.dataTable.sort(function (a, b) {\n\t\t// \t\tvar result = false;\n\t\t//\n\t\t// \t\tfor (var i = 0; i < columnOrders.length; i++) {\n\t\t// \t\t\tvar column = columnOrders[i],\n\t\t// \t\t\t\taValue = a[column.name],\n\t\t// \t\t\t\tbValue = b[column.name];\n\t\t//\n\t\t// \t\t\tif ($.isArray(aValue)) {\n\t\t// \t\t\t\taValue = $.map(aValue, function (item) { return item.text }).join(' ');\n\t\t// \t\t\t}\n\t\t//\n\t\t// \t\t\tif ($.isArray(bValue)) {\n\t\t// \t\t\t\tbValue = $.map(bValue, function (item) { return item.text }).join(' ');\n\t\t// \t\t\t}\n\t\t//\n\t\t// \t\t\tif (aValue != bValue) {\n\t\t// \t\t\t\tif (column.order == 'asc') {\n\t\t// \t\t\t\t\tresult = aValue > bValue ? 1 : -1;\n\t\t// \t\t\t\t}\n\t\t// \t\t\t\telse {\n\t\t// \t\t\t\t\tresult = aValue < bValue ? 1 : -1;\n\t\t// \t\t\t\t}\n\t\t// \t\t\t\tbreak;\n\t\t// \t\t\t}\n\t\t// \t\t}\n\t\t//\n\t\t// \t\treturn result;\n\t\t// \t});\n\t\t// },\n\n\t\t/**\n\t\t * @function objectLoad\n\t\t * Ready the Popup according to the current object\n\t\t * @param {ABObject} object  the currently selected object.\n\t\t */\n\t\tobjectLoad: function(object) {\n\t\t\tCurrentObject = object;\n\n\t\t\t// // refresh list\n\t\t\t// var allFields = CurrentObject.fields();\n\t\t\t// allFields.forEach((f) => {\n\t\t\t// \talert(f.label);\n\t\t\t// \tlistFields.push({\n\t\t\t// \t\tid: f.id,\n\t\t\t// \t\tlabel: f.label,\n\t\t\t// \t\t$css:\"hidden_fields_\"+f.id\n\t\t\t// \t})\n\t\t\t// })\n\n\t\t\t//$$(ids.list).parse(listFields);\n\t\t},\n\n\t\t/**\n\t\t * @function objectLoad\n\t\t * Ready the Popup according to the current object\n\t\t * @param {ABObject} object  the currently selected object.\n\t\t */\n\t\tonShow: function() {\n\t\t\tvar sort_popup = $$(ids.component),\n\t\t\t\tsort_form = $$(ids.form);\n\n\t\t\tvar childViews = sort_form.getChildViews();\n\t\t\tif (childViews.length == 1) {\n\t\t\t\tvar sorts = CurrentObject.workspaceSortFields;\n\t\t\t\tsorts.forEach((s) => {\n\t\t\t\t\t_logic.clickAddNewSort(s.by, s.dir, s.as);\n\t\t\t\t});\n\n\t\t\t\tif (sorts.length == 0) {\n\t\t\t\t\t_logic.clickAddNewSort();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @function refreshFieldList\n\t\t * return an updated field list so you cannot duplicate a sort\n\t\t */\n\t\trefreshFieldList: function (ignoreRemoveViews) {\n\t\t\tvar sort_popup = $$(ids.component),\n\t\t\t\tsort_form = $$(ids.form),\n\t\t\t\tlistFields = _logic.getFieldList(false),\n\t\t\t\tselectedFields = [],\n\t\t\t\tremoveChildViews = [];\n\n\t\t\tvar childViews = sort_form.getChildViews();\n\t\t\tif (childViews.length > 1) { // Ignore 'Add new sort' button\n\t\t\t\tchildViews.forEach(function (cView, index) {\n\t\t\t\t\tif (childViews.length - 1 <= index)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tvar fieldId = cView.getChildViews()[0].getValue(),\n\t\t\t\t\t\tfieldObj = $.grep(listFields, function (f) { return f.id == fieldId });\n\n\t\t\t\t\tif (fieldObj.length > 0) {\n\t\t\t\t\t\t// Add selected field to list\n\t\t\t\t\t\tselectedFields.push(fieldObj[0]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Add condition to remove\n\t\t\t\t\t\tremoveChildViews.push(cView);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Remove filter conditions when column is deleted\n\t\t\tif (!ignoreRemoveViews) {\n\t\t\t\tremoveChildViews.forEach(function (cView, index) {\n\t\t\t\t\tsort_form.removeView(cView);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Field list should not duplicate field items\n\t\t\tchildViews = sort_form.getChildViews();\n\t\t\tif (childViews.length > 1) { // Ignore 'Add new sort' button\n\t\t\t\tchildViews.forEach(function (cView, index) {\n\t\t\t\t\tif (childViews.length - 1 <= index)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tvar fieldId = cView.getChildViews()[0].getValue(),\n\t\t\t\t\t\tfieldObj = $.grep(listFields, function (f) { return f.id == fieldId });\n\n\t\t\t\t\tvar selectedFieldsExcludeCurField = $(selectedFields).not(fieldObj);\n\n\t\t\t\t\tvar enableFields = $(listFields).not(selectedFieldsExcludeCurField).get();\n\n\t\t\t\t\t// Update field list\n\t\t\t\t\tcView.getChildViews()[0].define('options', enableFields);\n\t\t\t\t\tcView.getChildViews()[0].refresh();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * @function saveSorts\n\t\t * This parses the sort form to build in order the sorts then saves to the application object workspace\n\t\t */\n\t\tsaveSorts: function() {\n\t\t\t// Prevent duplicate fields\n\t\t\tvar sort_popup = $$(ids.component),\n\t\t\t\tsort_form = $$(ids.form),\n\t\t\t\tsortFields = [];\n\n\t\t\tvar childViews = sort_form.getChildViews();\n\t\t\tif (childViews.length > 1) { // Ignore 'Add new sort' button\n\t\t\t\tchildViews.forEach(function (cView, index) {\n\t\t\t\t\tif (childViews.length - 1 <= index)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tvar by = cView.getChildViews()[0].getValue();\n\t\t\t\t\tvar dir = cView.getChildViews()[1].getValue();\n\t\t\t\t\tvar as = cView.getChildViews()[2].getValue();\n\t\t\t\t\tsortFields.push({\"by\":by, \"dir\":dir, \"as\":as})\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tCurrentObject.workspaceSortFields = sortFields;\n\t\t\tCurrentObject.save()\n\t\t\t.then(function(){\n\t\t\t\t_logic.callbacks.onChange();\n\t\t\t})\n\t\t\t.catch(function(err){\n\t\t\t\tOP.Error.log('Error trying to save workspaceSortFields', {error:err, fields:sortFields });\n\t\t\t});\n\t\t},\n\n\n\t}\n\n\n\n\t// Expose any globally accessible Actions:\n\tvar _actions = {\n\n\n\t}\n\n\n\n\t// return the current instance of this component:\n\treturn {\n\t\tui:_ui,\t\t\t\t\t// {obj} \tthe webix ui definition for this component\n\t\tinit:_init,\t\t\t\t// {fn} \tinit() to setup this component\n\t\tactions:_actions,\t\t// {ob}\t\thash of fn() to expose so other components can access.\n\n\n\t\t// interface methods for parent component:\n\t\tobjectLoad: _logic.objectLoad,\n\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/components/ab_work_object_workspace_popupSortFields.js","//\n// REFACTORING:\n//\n// Our goal here is to create a Model object that will interact with Sails' blueprints and \n// return native Webix DataCollections.\n//\n// We also want to listen for updates on Sails Sockets and notify the DataCollections.\n//\n// Until we have the refactoring in place, we will reuse the AD.Model.extent() objects,\n// and convert the results to DataCollections.\n//\n\n\n\n// Namespacing conventions:\n// OP.Model.extend('[application].[Model]', {static}, {instance} );  --> Object\nOP.Model.extend('opstools.BuildApp.ABApplication',\n\t{\n\t\tuseSockets: true,\n\t\trestURL: '/app_builder/abapplication'\n\t},\n\t{\n\t\t// instance Methods\n\t}\n);\n\t\t\n\t\t\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/data/ABApplication.js","\n/*\n * custom_editlist\n *\n * Create a custom webix component.\n *\n */\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\t\t// formHeader: L('ab.application.form.header', \"*Application Info\"),\n\t}\n}\n\n\nvar ComponentKey = 'ab_custom_editlist';\nOP.CustomComponent.extend(ComponentKey, function(App, componentKey ) {\n\t// App \t{obj}\tour application instance object.\n\t// componentKey {string}\tthe destination key in App.custom[componentKey] for the instance of this component:\n\n\tlabels.common = App.labels;\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique('custom_editlist_component'),\n\t}\n\n\n\n\t// Our webix UI definition:\n\tvar _ui = {\n        name: App.unique(\"custom_editlist\")\t// keep this unique for this App instance.\n    };\n\n\n\n\n\n\t// our internal business logic \n\tvar _logic = {\n\n\t}\n\n\n\n\t// Tell Webix to create an INSTANCE of our custom component:\n    webix.protoUI(_ui, webix.EditAbility, webix.ui.list);\n\n\n    // current definition of our Component \n    var Component = {\n\t\tview: _ui.name,\t\t\t// {string} the webix.view value for this custom component\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n\n\t// Save our definition into App.custom.[key]\n    App.custom = App.custom || {};\n    App.custom[componentKey] = Component;\n\n\n\t// return the current definition of this component:\n\treturn Component;\n\n})\n\n\n// After importing this custom component, you get back the .key to use to \n// lookup the OP.Component[] to create an application instance of \nexport default { key: ComponentKey };\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/webix_custom_components/editlist.js","\n/*\n * custom_edittree\n *\n * Create a custom webix component.\n *\n */\n\n\nfunction L(key, altText) {\n\treturn AD.lang.label.getLabel(key) || altText;\n}\n\n\nvar labels = {\n\n\tcomponent: {\n\t\t// formHeader: L('ab.application.form.header', \"*Application Info\"),\n\t}\n}\n\n\nvar ComponentKey = 'ab_custom_edittree';\nOP.CustomComponent.extend(ComponentKey, function(App, componentKey ) {\n\t// App \t{obj}\tour application instance object.\n\t// componentKey {string}\tthe destination key in App.custom[componentKey] for the instance of this component:\n\n\n\tlabels.common = App.labels;\n\n\t// internal list of Webix IDs to reference our UI components.\n\tvar ids = {\n\t\tcomponent: App.unique('custom_edittree_component'),\n\n\t}\n\n\n\n\t// Our webix Prototype definition:\n\tvar _ui = {\n        name: App.unique(\"custom_edittree\")\t// keep this unique for this App instance.\n    };\n\n\n\n\t// our internal business logic \n\tvar _logic = {\n\n\t}\n\n\n\n\t// Tell Webix to create an INSTANCE of our custom component:\n    webix.protoUI(_ui, webix.EditAbility, webix.ui.tree);\n\n\n    // current definition of our Component \n    var Component = {\n\t\tview: _ui.name,\t\t\t// {string} the webix.view value for this custom component\n\n\t\t_logic: _logic\t\t\t// {obj} \tUnit Testing\n\t}\n\n\n\t// Save our definition into App.custom.[key]\n    App.custom = App.custom || {};\n    App.custom[componentKey] = Component;\n\n\n\t// return the current definition of this component:\n\treturn Component;\n\n})\n\n\n// After importing this custom component, you get back the .key to use to \n// lookup the OP.Component[] to create an application instance of \nexport default { key: ComponentKey };\n\n\n// WEBPACK FOOTER //\n// ./assets/opstools/AppBuilder/webix_custom_components/edittree.js","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/css-loader/lib/css-base.js","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./~/style-loader/fixUrls.js","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".webix_view, .webix_el_colorpicker input, .webix_el_combo input, .webix_el_datepicker input, .webix_el_search input, .webix_el_text input, .webix_control button, .webix_control input, .webix_control textarea, .webix_el_label, .webix_inp_bottom_label, .webix_inp_label, .webix_inp_top_label {\\n\\tfont-family: \\\"Helvetica Neue\\\",Helvetica,Arial,sans-serif !important;\\n}\\n.ab-generated-page {\\n\\toverflow-y: auto;\\n}\\n.ab-main-container {\\n\\tposition: relative;\\n\\tdisplay: block;\\n\\twidth: 100%;\\n\\tbackground: -moz-linear-gradient(top, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0) 100%); /* FF3.6-15 */\\n\\tbackground: -webkit-linear-gradient(top, rgba(0,0,0,0.2) 0%,rgba(0,0,0,0) 100%); /* Chrome10-25,Safari5.1-6 */\\n\\tbackground: linear-gradient(to bottom, rgba(0,0,0,0.2) 0%,rgba(0,0,0,0) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\\n}\\n.ab-main-container .pointer {\\n\\tcursor: pointer;\\n}\\n.ab-main-container .right {\\n\\ttext-align: right;\\n}\\n.ab-main-container .center {\\n\\ttext-align: center;\\n}\\n.ab-main-container .left {\\n\\ttext-align: left;\\n}\\n.ab-text-bold {\\n\\tfont-weight: bold !important;\\n}\\n.ab-scroll-y {\\n\\toverflow-y: auto !important;\\n}\\n.ab-ellipses-text, .ab-ellipses-text > div {\\n\\toverflow: hidden;\\n\\twhite-space: nowrap;\\n\\ttext-overflow: ellipsis;\\n}\\n.float-left {\\n\\tfloat: left;\\n}\\n.float-right {\\n\\tfloat: right;\\n}\\n\\n/* Webix icon */\\n.ab-main-container .webix_icon {\\n\\tline-height: inherit;\\n}\\n\\n/* Fix overflow-x */\\n.ab-generated-page .webix_scroll_cont {\\n\\toverflow: auto !important;\\n}\\n\\n/* == Webix datatable == */\\n/* Checkbox column */\\n.ab-main-container .webix_hcell.center input[type=checkbox] {\\n\\twidth:20px;\\n\\theight:20px;\\n\\tmargin-top:12px;\\n  }\\n.ab-main-container .webix_table_checkbox {\\n\\twidth:20px;\\n\\theight:20px;\\n\\tmargin-top:5px;\\n}\\n/* Last column */\\n.ab-main-container .webix_column.webix_last > div,\\n.ab-main-container .webix_hs_center td.webix_last,\\n.ab-main-container .ab-app-list-descriptionwebix_hs_right td.webix_last {\\n\\tborder-right-width: 1px !important;\\n}\\n/* No padding/margin column */\\n.ab-column-no-padding div {\\n\\tpadding: 0px !important;\\n\\tmargin: 0px !important;\\n}\\n.ab-main-container .ab-cell-warn {\\n\\tbackground-color: #F5AE0F !important;\\n}\\n\\n/* Webix selected item */\\n.webix_list_item.webix_selected,\\n.webix_column>div.webix_cell_select,\\n.webix_column>div.webix_column_select,\\n.webix_column>div.webix_row_select {\\n\\tbackground-color: #3498db !important;\\n}\\n\\n/* Webix message */\\n.webix_success {\\n  background-color: #BFF2BF;\\n}\\n.webix_success div {\\n  background-color: #BFF2BF;\\n  border: 1px solid #007A00;\\n  color: #000;\\n}\\n\\n/* Webix list */\\n.ab-main-container .webix_list_item .webix_selected,\\n.ab-main-container .webix_tree_item.webix_selected {\\n\\tcolor: #fff !important;\\n\\tbackground-color: #3498db !important;\\n}\\n.ab-app-form-permission .webix_selected {\\n\\tcolor: #333 !important;\\n\\tbackground-color: transparent !important;\\n}\\n\\n/* Webix toolbar */\\n.ab-toolbar-submenu, .ab-toolbar-submenu .webix_header>div {\\n\\tbackground: #EEE !important;\\n\\tcolor: #666 !important;\\n\\tfont-size: 15px !important;\\n\\tfont-weight: bold !important;\\n\\tborder-bottom: 0px !important;\\n}\\n\\n/* Webix segmented */\\n.ab-form-component-item .webix_segment_0.webix_selected,\\n.ab-form-component-item .webix_segment_1.webix_selected,\\n.ab-form-component-item .webix_segment_N.webix_selected,\\n.ab-component-view-edit-field .webix_segment_0.webix_selected,\\n.ab-component-view-edit-field .webix_segment_1.webix_selected,\\n.ab-component-view-edit-field .webix_segment_N.webix_selected {\\n\\tcolor: #fff !important;\\n\\tbackground-color: #3498db !important;\\n}\\n\\n.ab-form-component-item .webix_segment_0,\\n.ab-form-component-item .webix_segment_1,\\n.ab-form-component-item .webix_segment_N,\\n.ab-component-view-edit-field .webix_segment_0,\\n.ab-component-view-edit-field .webix_segment_1,\\n.ab-component-view-edit-field .webix_segment_N {\\n\\tcolor: #3498db;\\n\\tbackground: #fff;\\n}\\n\\n/* Add new columns popup */\\n.ab-add-fields-popup {\\n\\toverflow-y: auto;\\n}\\n\\n/* Application list */\\n.ab-app-list {\\n/*\\n\\tmin-height: 300px;\\n\\tpadding: 40px 100px;\\n*/\\n}\\n.ab-app-select-list .webix_selected {\\n\\tbackground-color: #FFF !important;\\n\\tcolor: #333 !important;\\n}\\n.ab-app-select-list .webix_list_item:hover {\\n\\tbackground: #ebebeb;\\n}\\n.ab-app-list-item {\\n\\tposition: relative;\\n\\theight: 100%;\\n\\tmargin: -2px -10px;\\n\\tpadding: 15px;\\n\\tline-height: 20px;\\n}\\ndiv[view_id='ab-app-list'] div.webix_list_item:hover,\\ndiv[view_id='ab-object-list'] div.webix_list_item:hover,\\ndiv[view_id='ab-object-list-menu'] div.webix_list_item:hover,\\ndiv[view_id='ab-new-connectObject-list-item'] div.webix_list_item:hover,\\ndiv[view_id='ab-edit-header-items'] div.webix_list_item:hover,\\ndiv[view_id='ab-frozen-field-list'] div.webix_list_item:hover {\\n\\tbackground-color: #eee;\\n}\\n.ab-app-list-name {\\n\\tfont-size: large;\\n}\\n.ab-app-list-description {\\n\\tcolor: #999;\\n\\tfont-size: small;\\n}\\n.ab-app-list-info {\\n\\twidth: 95%;\\n\\tdisplay: inline-block;\\n}\\n.ab-app-list-edit {\\n\\tposition: absolute;\\n\\ttop: 0;\\n\\tright: 10px;\\n\\topacity: 0.4;\\n\\tline-height: 70px;\\n\\theight: 70px;\\n}\\n.ab-app-list-edit:hover {\\n\\topacity: 1;\\n}\\n\\n/* Application workspace */\\n.ab-app-workspace {\\n\\t/*min-height: 100px;*/\\n}\\n.ab-unsync-data-warning {\\n\\tcursor: pointer;\\n    color: #fff;\\n    background-color: #F5962F;\\n    border: #fff dotted 1px !important;\\n    padding-left: 2px;\\n}\\n.ab-unsync-data-popup .webix_win_head {\\n\\tbackground-color: #F5962F;\\n}\\n.ab-unsync-data-popup .webix_win_head .header {\\n\\tpadding-left: 5px;\\n\\tfont-weight: bold;\\n    color: #fff;\\n}\\n.ab-unsync-data-status {\\n\\tpadding: 3px;\\n}\\n.ab-unsync-data-in-progress {\\n\\tbackground-color: #F5AE0F;\\n}\\n.ab-unsync-data-done {\\n\\tbackground-color: #3AB349;\\n}\\n.ab-unsync-data-error {\\n\\tbackground-color: #EC2F2F;\\n}\\n\\n/* Object list */\\n.ab-object-list-item {\\n\\tposition: relative;\\n\\theight: 100%;\\n}\\n.ab-object-list-edit {\\n\\tposition: absolute;\\n\\ttop: 0px;\\n\\tright: 5px;\\n\\tdisplay: none;\\n}\\n.ab-object-unsync {\\n\\tbackground-color: #d2e3ef;\\n\\tcolor: #4a4a4a;\\n\\tposition: absolute;\\n\\ttop: 4px;\\n\\tright: 30px;\\n\\tfont-size: 12px;\\n\\tborder-radius: 6px;\\n\\tpadding: 0px 4px;\\n\\theight: 20px;\\n\\tline-height: 20px;\\n\\tdisplay: none;\\n}\\n\\n/* Interface list */\\n.ab-page-list-item {\\n\\tposition: relative;\\n\\theight: 100%;\\n}\\n.ab-page-list-edit {\\n\\tposition: absolute;\\n\\ttop: 0px;\\n\\tright: 5px;\\n\\tdisplay: none;\\n\\tcursor: pointer;\\n}\\n\\n/* Object datatable */\\n.ab-object-data-header {\\n\\tposition: relative;\\n}\\n.ab-object-data-new-header {\\n\\tbackground-color: #cfd9e0;\\n}\\n\\n.ab-object-data-header-edit {\\n\\tdisplay: none;\\n\\tposition: absolute;\\n\\ttop: 15px;\\n\\tright: 10px;\\n}\\n.ab-object-data-header:hover .ab-object-data-header-edit {\\n\\tdisplay: block;\\n}\\n.ab-object-unsync-data {\\n\\tbackground-color: #dae6fb;\\n}\\n.ab-object-view-column {\\n\\tcolor: #3498db;\\n\\tfont-weight: bold;\\n\\ttext-align: center;\\n\\tcursor: pointer;\\n}\\n\\n/* Connect object data */\\n.ab-connect-data-info {\\n\\tdisplay: inline-block;\\n\\twidth: 90px;\\n\\twhite-space: nowrap;\\n\\toverflow: hidden;\\n\\ttext-overflow: ellipsis;\\n}\\n\\n.ab-connect-data-disable {\\n\\tbackground-color: #aaa;\\n}\\n\\n/* Custom selectivity */\\n.ab-main-container .selectivity-multiple-input-container {\\n\\tbackground: none !important;\\n\\tpadding: 0px !important;\\n\\toverflow: hidden !important;\\n\\tmax-height: 100% !important;\\n}\\n.ab-main-container .selectivity-multiple-selected-item {\\n\\tbackground: #3498db !important;\\n\\tpadding-right: 5px;\\n\\t/*max-width: 100px !important;*/\\n}\\n\\n/* Interface tree view */\\n.ab-main-container .webix_tree_item.webix_selected span {\\n\\tpadding: 0px;\\n\\tbackground: #3498db !important;\\n}\\n\\n/* Interface new page popup */\\n.ab-interface-new-quick-page {\\n    overflow: scroll !important;\\n\\toverflow-x: hidden !important;\\n\\toverflow-y: auto !important;\\n}\\n\\n.ab-interface-new-quick-page .webix_inp_checkbox_border label {\\n\\tfont-weight: normal; /* Override bootstrap*/\\n}\\n\\n/* Interface page layout */\\n.ab-component-drop-area {\\n\\tmargin-right: 2px;\\n\\tborder: 1px dashed #000 !important;\\n\\tbackground-color: #D3E9EF;\\n\\tbackground-image:url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='30px' width='90px'><text x='20' y='20' fill='#95CBEF' font-size='15'>Drop Here</text></svg>\\\");\\n}\\n\\ndiv[view_id='ab-interface-layout-page'] .webix_list_item,\\n.ab-component-in-page {\\n\\twidth: 100%;\\n\\tposition: relative;\\n\\tbackground-color: #fff;\\n\\tclear: both;\\n}\\n\\n.ab-component-item-name {\\n\\tfloat: left;\\n\\tfont-size: 18px;\\n\\tborder-right: 1px solid #ebebeb;\\n\\tvertical-align: top;\\n\\tpadding-top: 10px;\\n\\twidth: 90px;\\n\\tmargin-bottom: -500em; /* CSS hack: equal height of right float */\\n\\tpadding-bottom: 500em;\\n}\\n\\n.ab-component-item-display {\\n\\tfloat: right;\\n\\tvertical-align: top;\\n\\tpadding: 10px;\\n\\twidth: 87%;\\n\\tline-height: 100%;\\n\\toverflow-x: auto;\\n}\\n\\n.ab-component-remove {\\n\\tposition: absolute;\\n\\ttop: 5px;\\n\\tright: 1px;\\n}\\n\\n.ab-component-link {\\n\\tcolor: #003B7E;\\n\\ttext-decoration: underline;\\n\\tcursor: pointer;\\n}\\n\\n/* Interface component list */\\n.ab-component-item-drag {\\n\\tborder: 1px dotted #000 !important;\\n\\tfont-size: 35px;\\n\\tbackground-color: #fff;\\n}\\n\\n/* Header component */\\n.ab-component-header {\\n\\tfont-size: 25px;\\n\\tfont-weight: bold;\\n\\tmargin: 0px;\\n\\tpadding: 0px;\\n}\\n.ab-component-description {\\n\\tfont-size: 14px;\\n\\tpadding: 0px;\\n}\\n\\n/* Menu component */\\n.ab-page-list-item .webix_tree_checkbox {\\n\\tmargin: 0px !important;\\n}\\n\\n/* Object toolbar */\\n.ab-data-toolbar {\\n\\tbackground: #aaa !important;\\n}\\n.ab-data-toolbar button {\\n\\ttext-align: center;\\n\\tfont-size: 14px;\\n}\\n.ab-data-toolbar button:hover, .ab-data-toolbar button:active {\\n\\tbackground: #aaa !important;\\n}\\n.ab-data-toolbar button .webix_icon_btn {\\n\\topacity: 0.6;\\n\\tfont-size: 15px;\\n}\\n.ab-data-toolbar button:hover .webix_icon_btn {\\n\\topacity: 1;\\n}\\n\\n/* Grid component */\\n.ab-page-grid-column-item .column-checkbox {\\n\\tdisplay: inline-block;\\n\\tposition: relative;\\n\\ttop: -5px;\\n\\twidth: 30px;\\n}\\n\\n.ab-page-grid-column-item .column-empty-checkbox {\\n\\tposition: relative;\\n\\twidth: 50px;\\n\\theight: 38px;\\n}\\n\\n.ab-page-grid-column-item .column-name {\\n\\tdisplay: inline-block;\\n\\tposition: relative;\\n\\ttop: -18px;\\n}\\n\\n/* Form component */\\n.ab-standard-button button, .ab-standard-button button:hover, .ab-standard-button button:active, .ab-standard-button .webix_icon_btn {\\n\\tbackground: transparent !important;\\n\\tborder-color: transparent !important;\\n\\tcolor: #666 !important;\\n\\tbox-shadow: none !important;\\n}\\n.ab-cancel-button button {\\n\\tbackground: transparent !important;\\n\\tcolor: #AAA;\\n\\tborder-color: transparent;\\n}\\n.ab-cancel-button button:hover {\\n\\ttext-decoration: underline;\\n}\\n.ab-cancel-button button:active {\\n\\tbox-shadow: none;\\n}\\n.ab-form-connect-data {\\n\\tfloat: left;\\n\\tborder: #CCC solid 1px;\\n\\tpadding: 0px 5px;\\n\\tmin-width: 70%;\\n\\tborder-radius: 6px;\\n}\\n\\n.ab-main-container .webix_layout_form {\\n\\tbackground-color: #fff !important;\\n}\\n\\n/* Loading Screen */\\n.ab-loading-screen {\\n\\tbackground: #000;\\n\\topacity: 0.7;\\n\\tposition: absolute !important;\\n}\\n.ab-loading-body {\\n\\tbackground: #000;\\n\\tborder-width: 0px !important;\\n}\\n.ab-loading-message {\\n\\tcolor: #fff !important;\\n\\tbackground: #000 !important;\\n\\tfont-size: 30px !important;\\n\\ttext-align: center;\\n\\tvertical-align: middle;\\n\\tborder-width: 0px !important;\\n\\tpadding-top: 20% !important;\\n\\theight: 100px !important;\\n}\\n.ab-loading-button {\\n\\ttext-align: center;\\n}\\n.ab-loading-button button {\\n\\tbackground-color: #003B7E;\\n\\twidth: 200px;\\n}\\n.ab-loading-cancel-button {\\n\\ttext-align: center;\\n\\tbackground: transparent;\\n}\\n.ab-loading-cancel-button a {\\n\\tcolor: #fff !important;\\n}\\n.ab-loading-screen .webix_progress_bottom {\\n\\theight: 40px !important;\\n\\topacity: 1;\\n}\\n.ab-loading-screen .webix_progress_bottom .webix_progress_state {\\n\\theight: 40px !important;\\n}\\n\\n/* Dynamic DataTable */\\n.dynamic-datatable-view .webix_badge {\\n\\tmargin: 0 !important;\\n}\\n\\n/* Number data field */\\n.ab-number-format-show {\\n\\twhite-space: nowrap;\\n}\\n\\n/* Icon Picker */\\n.ab-main-container .iconpicker .iconpicker-items {\\n\\tcolor: #000;\\n}\\n\\n/* Webix Tabs */\\ndiv.webix_item_tab {\\n\\tfont-size: 16px;\\n}\\n\\n::-webkit-input-placeholder { /* Chrome/Opera/Safari */\\n  color: #CCC;\\n}\\n::-moz-placeholder { /* Firefox 19+ */\\n  color: #CCC;\\n}\\n:-ms-input-placeholder { /* IE 10+ */\\n  color: #CCC;\\n}\\n:-moz-placeholder { /* Firefox 18- */\\n  color: #CCC;\\n}\\n\\n/* Webix popup */\\n.webix_popup_text {\\n\\tpadding-right: 20px;\\n\\tpadding-left: 20px;\\n}\\n\\n/* Webix badge */\\n.webix_badge {\\n\\tline-height: 22px;\\n\\ttext-indent: -1px;\\n}\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./assets/opstools/AppBuilder/AppBuilder.css\n// module id = 47\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nvar stylesInDom = {},\n\tmemoize = function(fn) {\n\t\tvar memo;\n\t\treturn function () {\n\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\t\treturn memo;\n\t\t};\n\t},\n\tisOldIE = memoize(function() {\n\t\t// Test for IE <= 9 as proposed by Browserhacks\n\t\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t\t// Tests for existence of standard globals is to allow style-loader \n\t\t// to operate correctly into non-standard environments\n\t\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\t\treturn window && document && document.all && !window.atob;\n\t}),\n\tgetElement = (function(fn) {\n\t\tvar memo = {};\n\t\treturn function(selector) {\n\t\t\tif (typeof memo[selector] === \"undefined\") {\n\t\t\t\tmemo[selector] = fn.call(this, selector);\n\t\t\t}\n\t\t\treturn memo[selector]\n\t\t};\n\t})(function (styleTarget) {\n\t\treturn document.querySelector(styleTarget)\n\t}),\n\tsingletonElement = null,\n\tsingletonCounter = 0,\n\tstyleElementsInsertedAtTop = [],\n\tfixUrls = require(\"./fixUrls\");\n\nmodule.exports = function(list, options) {\n\tif(typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n\tif (typeof options.insertInto === \"undefined\") options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list);\n\taddStylesToDom(styles, options);\n\n\treturn function update(newList) {\n\t\tvar mayRemove = [];\n\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\t\tfor(var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\n\t\t\t\t\tdomStyle.parts[j]();\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom(styles, options) {\n\tfor(var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles(list) {\n\tvar styles = [];\n\tvar newStyles = {};\n\tfor(var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\t\tif(!newStyles[id])\n\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse\n\t\t\tnewStyles[id].parts.push(part);\n\t}\n\treturn styles;\n}\n\nfunction insertStyleElement(options, styleElement) {\n\tvar styleTarget = getElement(options.insertInto)\n\tif (!styleTarget) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\n\tif (options.insertAt === \"top\") {\n\t\tif(!lastStyleElementInsertedAtTop) {\n\t\t\tstyleTarget.insertBefore(styleElement, styleTarget.firstChild);\n\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\tstyleTarget.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\tstyleTarget.appendChild(styleElement);\n\t\t}\n\t\tstyleElementsInsertedAtTop.push(styleElement);\n\t} else if (options.insertAt === \"bottom\") {\n\t\tstyleTarget.appendChild(styleElement);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement(styleElement) {\n\tstyleElement.parentNode.removeChild(styleElement);\n\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\n\tif(idx >= 0) {\n\t\tstyleElementsInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement(options) {\n\tvar styleElement = document.createElement(\"style\");\n\toptions.attrs.type = \"text/css\";\n\n\tattachTagAttrs(styleElement, options.attrs);\n\tinsertStyleElement(options, styleElement);\n\treturn styleElement;\n}\n\nfunction createLinkElement(options) {\n\tvar linkElement = document.createElement(\"link\");\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\tattachTagAttrs(linkElement, options.attrs);\n\tinsertStyleElement(options, linkElement);\n\treturn linkElement;\n}\n\nfunction attachTagAttrs(element, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\telement.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle(obj, options) {\n\tvar styleElement, update, remove;\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\n\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\n\t} else if(obj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\") {\n\t\tstyleElement = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, styleElement, options);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t\tif(styleElement.href)\n\t\t\t\tURL.revokeObjectURL(styleElement.href);\n\t\t};\n\t} else {\n\t\tstyleElement = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, styleElement);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle(newObj) {\n\t\tif(newObj) {\n\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\n\t\t\t\treturn;\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag(styleElement, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = styleElement.childNodes;\n\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\n\t\tif (childNodes.length) {\n\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyleElement.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag(styleElement, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyleElement.setAttribute(\"media\", media)\n\t}\n\n\tif(styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = css;\n\t} else {\n\t\twhile(styleElement.firstChild) {\n\t\t\tstyleElement.removeChild(styleElement.firstChild);\n\t\t}\n\t\tstyleElement.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink(linkElement, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/* If convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls){\n\t\tcss = fixUrls(css);\n\t}\n\n\tif(sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = linkElement.href;\n\n\tlinkElement.href = URL.createObjectURL(blob);\n\n\tif(oldSrc)\n\t\tURL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/style-loader/addStyles.js\n// module id = 48\n// module chunks = 0","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js!./AppBuilder.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js!./AppBuilder.css\", function() {\n\t\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js!./AppBuilder.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./assets/opstools/AppBuilder/AppBuilder.css\n// module id = 49\n// module chunks = 0"],"sourceRoot":""}