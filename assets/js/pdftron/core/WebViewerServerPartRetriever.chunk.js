/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see core.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[15],{382:function(ia,ca,f){function ba(e,f,h){f.endsWith("/")||(f+="/");h=h||{};var r=h.disableWebsockets||!1;this.DV=h.singleServerMode||!1;null!=h.customQueryParameters&&Object(n.b)("wvsQueryParameters",h.customQueryParameters);f.endsWith("blackbox/")||(f+="blackbox/");this.qn=h.uploadData||null;this.Ow=h.uriData||null;this.pO=h.cacheKey||null;this.IS=h.officeLocale||null;this.fF=Object(w.a)(f,null,r);this.df=f;this.xF=e;this.yf=
null;this.Gj=y();this.jm=y();this.kz=!1;this.ng=this.Vd=this.ne=this.cf=null;this.Ef=[];this.Wz=[];this.cache={};this.timeStamp=0;this.Xf=[];this.lh=[];this.UF=null;this.oF=!1;this.vJ=this.id=null;this.VH=this.iR=ha;this.gC=0;this.ZG=!1;this.DS=1;this.wj={};this.Jp(!0)}function y(){var e={promise:null,resolve:null,reject:null,state:0,result:null,request:null,Hr:function(){return 1===(e.state&1)},D9:function(){return 2===(e.state&2)},ai:function(){return!e.D9()&&!e.Hr()},i9:function(){return 4===(e.state&
4)},XU:function(){e.state|=4}};e.promise=new Promise(function(f,h){e.resolve=function(){if(0===e.state||4===e.state)e.state=1,e.result=arguments[0],f.apply(null,arguments)};e.reject=function(){if(0===e.state||4===e.state)e.state=2,h.apply(null,arguments)}});return e}function ha(){return!1}function ea(e,f,h){if(!(f in fa))return!0;f=fa[f];for(var n=0;n<f.length;n++){var r=e;var w=f[n];var x=h;if(w.name in r){var y="",z=!1;r=r[w.name];switch(w.type){case "s":y="String";z=Object(da.isString)(r);break;
case "a":y="Array";z=Object(da.isArray)(r);break;case "n":y="Number";z=Object(da.isNumber)(r)&&Object(da.isFinite)(r);break;case "o":y="Object",z=Object(da.isObject)(r)&&!Object(da.isArray)(r)}z||x.reject('Expected response field "'+w.name+'" to have type '+y);w=z}else x.reject('Response missing field "'+w.name+'"'),w=!1;if(!w)return!1}return!0}f.r(ca);var da=f(0);f.n(da);var aa=f(2);ia=f(45);var x=f(27),w=f(399),h=f(83),r=f(338),e=f(103),n=f(38),z=f(147),fa={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",
type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],ApString2Xod:[{name:"url",type:"s"},{name:"rID",type:"s"}]};ba.prototype=Object(da.extend)(ba.prototype,{W2:function(){var e=this;return new Promise(function(f,
h){var n=new XMLHttpRequest;n.open("GET",e.df+"ck");n.withCredentials=e.Kk();n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?f():h())};n.send()})},$da:function(e,f){this.iR=e||ha;this.VH=f||ha},EO:function(){var e=this;this.jm=y();this.Gj=y();return this.fF.KF().then(function(){e.kz=!1;e.id=null;e.oF=!1;return e.W2()})},dJ:function(){this.iR();this.pH();this.cf&&(this.cf.ai()?this.zf(this.cf.request):this.cf.Hr()&&this.VH(this.cf.result.url,"pdf")&&(this.cf=null,
this.wU()));this.ng&&this.ng.ai()&&this.zf(this.ng.request);this.ne&&this.ne.ai()?this.zf(this.ne.request):this.Vd&&this.Vd.ai()&&this.YQ(this.Vd.request);var e;for(e=0;e<this.Xf.length;e++)this.Xf[e]&&this.Xf[e]&&(this.Xf[e].ai()?this.zf(this.Xf[e].request):this.Xf[e].Hr()&&this.VH(this.Xf[e].result.url,"image")&&(this.Xf[e]=null,this.dC(e)));for(e=0;e<this.lh.length;e++)this.lh[e]&&this.lh[e]&&this.lh[e].ai()&&!this.lh[e].i9()&&this.zf(this.lh[e].request);for(e=0;e<this.Ef.length;e++)this.Ef[e]&&
this.Ef[e].ai()&&this.zf(this.Ef[e].request)},pH:function(f){var h=this;this.kz||(this.timeStamp=Date.now(),this.fF.dK(function(e){h.T$(e)},function(){return null},function(){return null},!0).then(function(){clearInterval(h.WB);h.WB=null},function(n){h.kz=!1;if(!h.WB){var r=0;h.oF=!0;h.vJ=0;h.WB=setInterval(function(){2>r++?h.dJ():(clearInterval(h.WB),f&&f.reject(e.a),Object(aa.f)("WebViewerServer connection failed:"+n))},5E3)}}),this.kz=!0)},lga:function(){var e=this,f=createPromiseCapability();
if(this.qn){var h=new FormData;h.append("file",this.qn.fileHandle,this.qn.fileHandle.name);var n=this.qn.loadCallback;var r="upload";var w=this.qn.extension}else if(this.Ow){h={uri:this.Ow.uri,$ja:this.Ow.shareId};h=Object.keys(h).map(function(e){return e+"="+(h[e]?encodeURIComponent(h[e]):"")}).join("&");var y="application/x-www-form-urlencoded; charset=UTF-8";n=this.Ow.loadCallback;r="url";w=this.Ow.extension}else return Promise.resolve();var aa=new XMLHttpRequest,ba=Object(x.j)(e.df,"AuxUpload");
ba=Object(z.a)(ba)+"&type="+r+"&ext="+w;aa.open("POST",ba);aa.withCredentials=this.Kk();y&&aa.setRequestHeader("Content-Type",y);aa.addEventListener("load",function(){if(aa.readyState===aa.DONE&&200===aa.status){var h=JSON.parse(aa.response);e.xF=h.uri;n(h);f.resolve(h)}});aa.addEventListener("error",function(){f.reject(aa.statusText+" "+JSON.stringify(aa))});this.qn&&null!=this.qn.onProgress&&(aa.upload.onprogress=function(f){e.qn.onProgress(f)});aa.send(h);return f.promise},Gca:function(e){this.password=
e||null;this.Gj.Hr()||(this.Gj=y(),this.zf({t:"pages"}));return this.Gj.promise},fw:function(e){this.UF=e||null;this.Gj.Hr()||(this.pH(this.Gj),this.zf({t:"pages"}));return this.Gj.promise},dF:function(e){e=Object.assign(e,{uri:encodeURIComponent(this.xF)});this.UF&&(e.ext=this.UF);this.yf&&(e.c=this.yf);this.password&&(e.pswd=this.password);this.pO&&(e.cacheKey=this.pO);this.IS&&(e.locale=this.IS);return e},zf:function(e){e=this.dF(e);this.fF.send(e)},wk:function(e){return e},T$:function(e){var f=
this,r=e.data,w=e.err,x=e.t;switch(x){case "upload":w?f.mga.reject(w):f.mga.resolve("Success");break;case "pages":w?f.Gj.reject(w):ea(r,x,f.Gj)&&f.Gj.resolve(r);break;case "config":if(w)f.jm.reject(w);else if(ea(r,x,f.jm)){r.id&&(f.id=r.id);if(r.auth){var ba=Object(n.a)("wvsQueryParameters");ba.auth=r.auth;Object(n.b)("wvsQueryParameters",ba)}r.serverVersion&&(f.Hga=r.serverVersion,Object(aa.g)("[WebViewer Server] server version: "+f.Hga));r.serverID?(f.gC=r.serverID===f.vJ&&f.ZG?f.gC+1:0,f.vJ=r.serverID):
f.gC=0;f.ZG=!1;f.jm.resolve(r)}break;case "health":w?f.jm.reject(w):ea(r,x,f.jm)&&(r=r.unhealthy,f.DV&&r?Object(aa.i)("Server failed health check. Single server mode ignoring check."):!f.yia&&r&&1>=f.gC&&(f.ZG=!0,f.EO().then(function(){f.dJ()},function(){f.dJ()})));break;case "pdf":r.url=Object(z.a)(f.df+"../"+encodeURI(r.url));w?f.cf.reject(w):ea(r,x,f.cf)&&f.cf.resolve(r);break;case "ApString2Xod":r.url=Object(z.a)(f.df+"../data/"+encodeURI(r.url));w?f.wj[r.rID].reject(w):ea(r,x,f.wj[r.rID])&&f.wj[r.rID].resolve(r);
break;case "docmod":r.url=Object(z.a)(f.df+"../"+encodeURI(r.url));w?f.wj[r.rID].reject(w):ea(r,x,f.cf)&&f.wj[r.rID].resolve(r);break;case "xod":if(w)this.ne&&this.ne.ai()&&this.ne.reject(w),this.Vd&&this.Vd.ai()&&this.Vd.reject(w);else if(r.notFound)r.noCreate||this.ne&&this.ne.ai()&&this.ne.resolve(r),this.Vd&&this.Vd.ai()&&this.Vd.resolve(r);else{r.url&&(r.url=Object(z.a)(f.df+"../"+encodeURI(r.url)));if(!this.Vd||this.Vd.Hr())this.Vd=y(),this.Vd.request={t:"xod",noCreate:!0};this.ne||(this.ne=
y(),this.ne.request={t:"xod"});this.Vd.resolve(r);this.ne.resolve(r)}break;case "annots":if(w)f.ng.reject(w);else if(ea(r,x,f.ng)){f.ng.XU();var da=new XMLHttpRequest;ba=f.df+"../"+encodeURI(r.url);var fa=r.hasAppearance?Object(z.a)(ba+".xodapp"):null;da.open("GET",Object(z.a)(ba));da.responseType="text";da.withCredentials=this.Kk();da.addEventListener("load",function(){da.readyState===da.DONE&&200===da.status&&f.ng.resolve({AK:da.response,aO:fa})});da.addEventListener("error",function(){f.ng.reject(da.statusText+
" "+JSON.stringify(da))});da.send()}break;case "image":var ca=this.Xf[r.p];w?ca.promise.reject(w):ea(r,x,ca)&&(ca.result=r,ca.result.url=Object(z.a)(f.df+"../"+encodeURI(ca.result.url)),ca.resolve(ca.result));break;case "tiles":ca=r.rID;ba=this.Ef[ca];this.Ef[ca]=null;this.Wz.push(ca);if(w)ba.reject(w);else if(ea(r,x,ba)){for(w=0;w<r.tiles.length;w++)r.tiles[w]=Object(z.a)(f.df+"../"+encodeURI(r.tiles[w]));ba.resolve(r)}break;case "text":ca=this.lh[r.p];if(w)ca.reject(w);else if(ea(r,x,ca)){ca.XU();
var ha=new XMLHttpRequest;r=Object(z.a)(f.df+"../"+encodeURI(r.url));ha.open("GET",r);ha.withCredentials=this.Kk();ha.addEventListener("load",function(){ha.readyState===ha.DONE&&200===ha.status&&(ca.result=JSON.parse(ha.response),ca.resolve(ca.result))});ha.addEventListener("error",function(e){ca.reject(ha.statusText+" "+JSON.stringify(e))});ha.send()}break;case "progress":"loading"===r.t&&f.trigger(h.a.Events.DOCUMENT_LOADING_PROGRESS,[r.bytes,r.total])}!x&&e.echo&&e&&"apstring2xod"==e.echo.t&&(e=
e.echo.reqID)&&f.wj[e].reject("Message unhandled by server")},fQ:function(){this.pH(this.jm);return this.jm.promise},i6:function(e){var f=this,h=new XMLHttpRequest,n=Object(z.a)(this.df+"aul")+"&id="+this.id,r=new FormData,w={};e=tc(e.body);for(var x=e.next();!x.done;x=e.next())x=x.value,w[x.id]=x.DE.w+";"+x.DE.h,r.append(x.id,x.DE.dataString);w={t:"apstring2xod",reqID:this.DS++,parts:w};var aa=this.dF(w);r.append("msg",JSON.stringify(aa));f.wj[aa.reqID]=y();h.open("POST",n);h.withCredentials=f.Kk;
n=new Promise(function(e,f){h.onreadystatechange=function(){4===h.readyState&&(200===h.status?e():f("An error occurred while sending down appearance strings to the server"))}});h.send(r);return n.then(function(){return f.wj[aa.reqID].promise})},h6:function(){this.ng||(this.ng=y(),this.ng.request={t:"annots"},this.zf(this.ng.request));return this.ng.promise},dC:function(e){this.Xf[e]||(this.Xf[e]=y(),this.Xf[e].request={t:"image",p:e},this.zf(this.Xf[e].request));return this.Xf[e].promise},Hca:function(e){this.lh[e]||
(this.lh[e]=y(),this.lh[e].request={t:"text",p:e},this.zf(this.lh[e].request));return this.lh[e].promise},Ica:function(e,f,h,n){var r=this.Ef.length;this.Wz.length&&(r=this.Wz.pop());this.Ef[r]=y();this.Ef[r].request={t:"tiles",p:e,z:f,r:h,size:n,rID:r};this.zf(this.Ef[r].request);return this.Ef[r].promise},wU:function(){this.cf||(this.cf=y(),this.cf.request={t:"pdf"},this.oF?this.cf.resolve({url:this.xF}):this.zf(this.cf.request));return this.cf.promise},wQ:function(e){var f=this,h=new XMLHttpRequest,
n=Object(z.a)(this.df+"aul")+"&id="+this.id,r=new FormData,w={};e.annots&&(w.annots="xfdf");e.watermark&&(w.watermark="png");e.redactions&&(w.redactions="redact");w={t:"docmod",reqID:this.DS++,parts:w};e.print&&(w.print=!0);var x=this.dF(w);r.append("msg",JSON.stringify(x));return Promise.all([e.annots,e.watermark,e.redactions].map(function(e){return Promise.resolve(e)})).then(function(e){var w=e[0],z=e[1],aa=e[2];w&&r.append("annots",w);z&&r.append("watermark",e.watermark);aa&&r.append("redactions",
aa);f.wj[x.reqID]=y();h.open("POST",n);h.withCredentials=f.Kk;e=new Promise(function(e,f){h.onreadystatechange=function(){4===h.readyState&&(200===h.status?e():f("An error occurred while sending down annotation data to the server"))}});h.send(r);return e.then(function(){return f.wj[x.reqID].promise})})},YQ:function(){this.Vd||(this.Vd=y(),this.Vd.request={t:"xod",noCreate:!0},this.zf(this.Vd.request));return this.Vd.promise},Jca:function(){this.ne||(this.ne=y(),this.ne.request={t:"xod"},this.zf(this.ne.request));
return this.ne.promise},Zm:function(){return!0},request:function(){},RT:function(){},abort:function(){for(var e=0;e<this.Ef.length;e++)this.Ef[e]&&(this.Ef[e].resolve(null),this.Ef[e]=null,this.Wz.push(e));this.close()},pC:function(e){this.yf=this.yf||{};this.yf.headers=e},Via:function(){return this.yf?Object(da.omit)(this.yf.headers,["Cookie","cookie"]):null},Jp:function(e){this.yf=this.yf||{};this.yf.internal=this.yf.internal||{};this.yf.internal.withCredentials=e},Kk:function(){return this.yf&&
this.yf.internal?this.yf.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(ia.a)(ba);Object(r.a)(ba);Object(r.b)(ba);ca["default"]=ba},399:function(ia,ca,f){function ba(f,x,w){function h(e,f){function h(e){r().then(function(f){ca&&!ia?setTimeout(function(){h(e)},1):f.send(JSON.stringify(e))})}function n(e,f,n,r){var z=window.createPromiseCapability(),fa=!1,ja=z;y=e;aa=f;ba=n;x=null;r&&(e=Object(ea.a)("wvsQueryParameters"),e.bcid=Object(ha.k)(8),Object(ea.b)("wvsQueryParameters",
e));try{e=Ca?qa+"/"+Ca:qa+"/ws";e=Object(da.a)(e);var ka=new WebSocket(e);ka.onopen=function(){z.resolve();fa=!0;z=null;ca=!1;w.resolve(ka);aa&&aa()};ka.onerror=function(e){ca=ia=!0;z&&z.reject(e);x&&x.reject()};ka.onclose=function(){w=window.createPromiseCapability();ca=!0;x||(x=window.createPromiseCapability());x.resolve();ba&&ba();y&&fa&&y({t:"health",data:{unhealthy:!0,isDead:!0}})};ka.onmessage=function(e){e&&e.data&&(e=JSON.parse(e.data),e.hb?h({hb:!0}):e.end?close():y(e))}}catch(Fa){z.reject(Fa),
z=null}return ja.promise}function r(){ca&&y&&n(y);return w.promise}var w=window.createPromiseCapability(),x=null,y,aa,ba=null,ca=!1,ia=!1,Ca=f,qa=function(e){var f=e.indexOf("://"),h="ws://";0>f?f=0:(5===f&&(h="wss://"),f+=3);var n=e.lastIndexOf("/");0>n&&(n=e.length);return h+e.slice(f,n)}(e);return{send:h,dK:n,KF:function(){return x?x.promise:r().then(function(e){x=window.createPromiseCapability();y=null;e.close();return x.promise})}}}function r(e){var f=e.lastIndexOf("/");0>f&&(f=e.length);return e.slice(0,
f)}return window.WebSocket&&!w?h(f,x):function(e,f){function h(e){(ca?ca.promise:Promise.resolve(ea)).then(function(f){var h=new XMLHttpRequest,n=ba?aa+"/"+ba+"pf":aa+"/pf";n=Object(da.a)(n)+"&id="+f;f=new FormData;f.append("data",JSON.stringify(e));h.open("POST",n);h.withCredentials=!0;h.send(f)})}function n(){ea=0;ca||(ca=window.createPromiseCapability())}function w(){x=new XMLHttpRequest;var e=aa+"/pf";e+=0!==ea?"?id="+ea+"&uc="+qa:"?uc="+qa;qa++;x.open("GET",e,!0);x.withCredentials=!0;x.setRequestHeader("Cache-Control",
"no-cache");x.setRequestHeader("X-Requested-With","XMLHttpRequest");var f=x,r=!1;x.onreadystatechange=function(){a:if(3<=f.readyState&&!r){try{var e=f.responseText.length}catch(Ea){Object(y.g)("caught exception");break a}if(0<e)try{var x=f.responseText.split("\n");for(x[x.length-1]&&x.pop();0<x.length&&3>x[x.length-1].length;)"]"===x.pop()&&n();0<x.length&&3>x[0].length&&x.shift();for(e=0;e<x.length;++e)x[e].endsWith(",")&&(x[e]=x[e].substr(0,x[e].length-1));0===ea&&0<x.length&&(ea=JSON.parse(x.shift()).id,
e=ca,ca=null,e.resolve(ea));var z;for(e=0;e<x.length;++e)(z=JSON.parse(x[e]))&&z.end?close():z&&z.hb&&z.id===ea?h({hb:!0}):Ca(z)}catch(Ea){}ha||(r=!0,w())}};x.send()}var x,aa=r(e),ba=f,ea=0,ca=window.createPromiseCapability(),ha=!1,ia=null,Ca=null,qa=0;return{send:h,dK:function(e,f,h){Ca=e;ia=h;ha=!1;n();w();f&&f();return Promise.resolve()},KF:function(){n();Ca=null;ha=!0;ia&&ia();x.abort();return Promise.resolve()}}}(f,x)}f.d(ca,"a",function(){return ba});var y=f(2),ha=f(27),ea=f(38),da=f(147)}}]);}).call(this || window)
