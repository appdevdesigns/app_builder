/**
 * ABMobileQRController
 *
 * The AppBuilder uses QR information to coordinate the code and initialization of 
 * a mobile App.  This can happen with or without the Relay service.
 *
 * A QR code contains the following info:
 *      userAuthToken:  enables the Mobile Framework to communicate with 
 *                      AppBuilder services (including the Public Relay Server)
 *                      (found in ABRelayUser.publicAuthToken)
 *      applicationID:  relates what Mobile App the AppBuilder is building that
 *                      should be running on the device.
 *      codePushKeys:   The Microsoft CodePush keys used to update the version
 *                      of code being run on the device. Useful for switching to 
 *                      #develop or #testing versions of the Mobile Device
 * 
 * A QR Code is effective for a User + MobileApp
 *
 *
 */

var path = require('path');
var fs   = require('fs');

var async = require('async');
var _     = require('lodash');

var RP = require('request-promise-native');
var QRCode = require('qrcode');
var mysql = require('mysql');
var moment = require('moment');

var Base64Images = require('../classes/Base64Images.js');

module.exports = {


    // GET: /app_builder/mobile/:mobileID/apk
    // return the current APK for the specified Mobile App
    // @param {string} version    which version of the App ('current' is default)
    sendAPK: function (req, res) {

        var mobileID = req.param('mobileID') || '--';
        var version  = req.param('version')  || 'current';  // default

        var missingParams = [];
        if (mobileID == '--') {
            missingParams.push('mobileID');
        }

        if (missingParams.length > 0) {
            var error = ADCore.error.fromKey('E_MISSINGPARAM');
            error.missingParams = missingParams;
            res.AD.error(error, 422);  // 422 for missing parameters ? (http://stackoverflow.com/questions/3050518/what-http-status-response-code-should-i-use-if-the-request-is-missing-a-required)
            return;
        }

        var MobileApp = null;   // which mobile app are we requesting an APK from
        var fileName  = null;   // the name of the file we are sending
        var destFile  = null;   // the path to the file to send

        async.series([

            (next) => {

                // get MobileApp
                AppBuilder.mobileApps()
                .then((listApps)=>{

                    var App = listApps.filter((a)=>{return a.id == mobileID; })[0];

                    if (!App) {
                        var error = new Error('Unknown Mobile App');
                        error.code = 'E_UNKNOWNMOBILEAPP';
                        error.httpResponseCode = 403;
                        next(error);
                        return;
                    }

                    MobileApp = App;
                    next();

                })
                .catch(next);

            },


            (next) => {

                destFile = MobileApp.pathAPK(version);
                var parts = destFile.split(path.sep);
                fileName = parts.pop();

                fs.access(destFile, fs.constants.R_OK , function(err) {
                    if (err) {

                        var nError = new Error('cannot access file.');
                        nError.code = 'EACCESS';
                        nError.error = err;
                        nError.destFile = destFile;
                        ADCore.error.log('AppBuilder:ABMobileQRController:sendAPK:Unable to access APK file:', {error:nError});

                        var clientError = new Error('Error processing your request');
                        clientError.httpResponseCode = 500;
                        next(clientError);
                    } else {
                        next();
                    }
                });
            }



        ],(err,data)=>{

            if (err) {
                
                ADCore.Comm.error(res, err, err.httpResponseCode || 400);
    
            } else {

                // Adding header so the client knows the file content type and the file name
                res.setHeader('Content-disposition', 'attachment; filename=' + fileName);
                    
                // stream file to response on success
                fs.createReadStream(destFile)
                .on('error', function (err) {
                    ADCore.error.log("ABMobileQRController:sendAPK:Unexpected Error streaming file to client", {error:err});
                    return ADCore.Comm.error(res, err, 500);
                })
                .pipe(res);
            }

        })


    },



    // POST: /app_builder/QR/sendEmail
    // send a QR code to a specified Site User
    // @param {string} user       the SiteUser.guid 
    // @param {string} mobileApp  id of the Mobile App
    // @param {string} email      the email address to send to.
    sendEmail: function (req, res) {

        var user = req.param('user') || '--';
        var appID = req.param('mobileApp') || '--';
        var email = req.param('email') || '--';
        var username = req.param('username') || '--';

        var QRAppUser = null;
        var MobileApp = null;

        var UserPublicToken = null;


        // variables used in Email Sent:
        var triggerID = null;   // EmailNotifications trigger ID for the QR Code Email;
        var deepLink  = null;   // base deeplink url
        var apkURL = null;      // url to access the android version of the mobile app
        var cidQR = 'qr-code-key';  // unique key to point to QR image in attachment
        var attachments = [];
        
        var connextImgID = 'connexted-png';
        var connextedBase64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAIAAADTED8xAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3BpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiY2JjYTM1My1hMWExLTQ3YmItYjA5ZC1jNmIwMzE2MmQ4ZDAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjlBREJCRjBBODREMTFFODk2NURFQzFGMzk0NTU0NTMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MjlBREJCRUZBODREMTFFODk2NURFQzFGMzk0NTU0NTMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpEREY0NDk3REY3NzgxMUU3OTJBNEVCREQwOEU0MzU0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpEREY0NDk3RUY3NzgxMUU3OTJBNEVCREQwOEU0MzU0RSIvPiA8L3Jk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";
        var connextedImgBuffer = Buffer.from(connextedBase64.substring(22), 'base64');

        async.series([

            // verify Email
            // if no email is provided, then lookup SiteUser's email:
            (next) => {
                
                // if they provided an email, move along
                if (email != '--') {
                    next();
                    return;
                } 

                // lookup SiteUser
                SiteUser.findOne({guid:user})
                .then((lookupUser)=>{

                    if (!lookupUser) {
                        var error = new Error('Unknown user');
                        error.httpResponseCode = 404;
                        next(error);
                        return;
                    }

                    email = lookupUser.email;
                    username = lookupUser.username;
                    next();
                })
                .catch(next)
            },

//// NOTE: in usage, we don't use the QRToken in ABQRAppUser
//// we might remove these next 2 steps in the future:

// find entry for ABQRAppUser
(next) => {

    ABQRAppUser.find({
        siteuser:user,
        mobile:appID
    })
    .then((list)=>{

        if (Array.isArray(list)) {
            QRAppUser = list[0];
        }
        next();
    })
    .catch(next);
},

// Create ABQRAppUser if it didn't exist:
(next) => {

    // skip if it is there
    if (QRAppUser) {
        next();
        return;
    } 

    ABQRAppUser.initializeAppUser(user, appID)
    .then((abru)=>{
        QRAppUser = abru;
        next();
    })
    .catch(next);

},


            // Get the MobileApp object
            (next) => {

                ABMobile.app(appID)
                .then((App)=>{

                    if (!App) {
                        var error = new Error('Unknown Mobile App');
                        error.httpResponseCode = 403;
                        next(error);
                        return;
                    }

                    MobileApp = App;
                    next();
                })
                .catch(next);

                // AppBuilder.mobileApps()
                // .then((listApps)=>{

                //     var App = listApps.filter((a)=>{return a.id == appID; })[0];

                //     if (!App) {
                //         var error = new Error('Unknown Mobile App');
                //         error.httpResponseCode = 403;
                //         next(error);
                //         return;
                //     }

                //     MobileApp = App;
                //     next();

                // })
                // .catch(next);
            },


            // Get the User's Public Auth Token:
            (next) => {

                ABMobile.publicAuthTokenForUser(user)
                .then((token)=>{

                    if (token) {
                        UserPublicToken = token;
                        next();
                        return;
                    }

                    // this is an error:
                    var error = new Error('Requested User not setup for Relay.');
                    next(error);
                })
                .catch(next);

                // ABRelayUser.findOne({siteuser_guid: user})
                // .then((ru)=>{
                //     if (ru) {
                //         UserPublicToken = ru.publicAuthToken;
                //         next();
                //         return;
                //     }

                //     // this is an error:
                //     var error = new Error('Requested User not setup for Relay.');
                //     next(error);
                // })
                // .catch(next);

            },


            // package together our Email Data
            (next) => {


                triggerID = MobileApp.emailInviteTrigger();     // EmailNotifications trigger ID for the QR Code Email;
                deepLink  = sails.config.appbuilder.deeplink;   // base deeplink url
                apkURL = MobileApp.urlAPK();                    // url to access the android version of the mobile app
                cidQR = 'qr-code-key';                          // QR image attachment data
                attachments = [];
                

                // package the data for our QR Code 
                var QRData = ABMobile.getQRCodeData({
                    UserPublicToken:UserPublicToken,
                    codePushKeys: MobileApp.codePushKeys()
                })

                // deepLink needs to include this data for the MobileApp 
                deepLink += "?settings=" + encodeURIComponent(QRData);

                // now convert to a Base64 image 
                ABMobile.getQRCodeBase64(QRData)
                .then((qrcodeBuffer)=>{

                    // add attachment
                    attachments.push({
                        filename: 'qrcode.png',
                        content: qrcodeBuffer,
                        contents: qrcodeBuffer, // old version syntax
                        cid: cidQR
                    });

                    next();
                })
                .catch(next);

                // QRCode.toDataURL(QRData, (err, image) => {
                //     if (err) next(err);
                //     else {

                //         base64QR = image.substring(22);
                //         var qrcodeBuffer = Buffer.from(base64QR, 'base64');

                //         // add attachment
                //         attachments.push({
                //             filename: 'qrcode.png',
                //             content: qrcodeBuffer,
                //             contents: qrcodeBuffer, // old version syntax
                //             cid: cidQR
                //         });

                //         next();
                //     }
                // });

            },


            // now build Email info and send to user
            (next) => {
                
                if (email) {
                    
                    // add attachment
                    attachments.push({
                        filename: 'connexted.png',
                        content: connextedImgBuffer,
                        contents: connextedImgBuffer, // old version syntax
                        cid: connextImgID
                    });
                    
                    EmailNotifications.trigger(triggerID, {
                        to: [email],
                        variables: {
                            apkURL: apkURL,       // url to android apk file
                            cidQR: cidQR,       // CID for the QR code attachment
                            connextImgID: connextImgID,
                            deepLink: deepLink,
                            username: username
                        },
                        attachments: attachments
                    })
                    .done((html) => {
                        next(); // res.send(html || 'OK');
                    })
                    .fail((err)=>{

                        // pass a generic error back to the Client:
                        var error = new Error('Error Sending Email.');
                        error.httpResponseCode = 500;
                        next(error);
                        
                    });
                } else {
                    // pass a generic error back to the Client:
                    var error = new Error('User does not have an email address.');
                    error.httpResponseCode = 500;
                    next(error);
                }

            }

        ], (err, data)=>{
            if (err) {
                res.AD.error(err, err.httpResponseCode || 400);
            } else {
                res.AD.success({sent:true});    
            }
        })
    },


    // POST: /app_builder/QR/adminQRCode
    // send a QR code to a specified Site User
    // @param {string} user       the SiteUser.guid 
    // @param {string} mobileApp  id of the Mobile App
    adminQRCode:function(req, res) {

// console.log('!!! adminQRCode:');

        var user = req.param('user') || '--';
        var appID = req.param('mobileApp') || '--';
        var version = req.param('version') || '--';


        var MobileApp = null;
        var UserPublicToken = null;

        var qrcodeBuffer = null;  // final data

        async.series([

            // Get the MobileApp object
            (next) => {

                ABMobile.app(appID)
                .then((App)=>{

                    if (!App) {
                        var error = new Error('Unknown Mobile App');
                        error.httpResponseCode = 403;
                        next(error);
                        return;
                    }

                    MobileApp = App;
                    next();
                })
                .catch(next);
            },


            // Get the User's Public Auth Token:
            (next) => {

                ABMobile.publicAuthTokenForUser(user)
                .then((token)=>{

                    if (token) {
                        UserPublicToken = token;
                        next();
                        return;
                    }

                    // this is an error:
                    var error = new Error('Requested User not setup for Relay.');
                    next(error);
                })
                .catch(next);

            },


            // package together our Email Data
            (next) => {

                // package the data for our QR Code 
                var QRData = ABMobile.getQRCodeData({
                    UserPublicToken:UserPublicToken,
                    codePushKeys: MobileApp.codePushKeys(version)
                })

                // now convert to a Base64 image 
                ABMobile.getQRCodeImage(QRData)
                .then((image)=>{
                    qrcodeBuffer = image;
                    next();
                })
                .catch(next);
            }

        ], (err, data)=>{
            if (err) {
                res.AD.error(err, err.httpResponseCode || 400);
            } else {

// testing: simulate a remote call delay
// setTimeout(()=>{
                res.AD.success({image:qrcodeBuffer});    
// }, 5000);
                
            }
        })
    },


    // POST: /app_builder/Event/sendConfirmationEmail
    // send a confirmation email out to registered users
    // @param {string} user  (optional) the speific user to send to
    // @param {integer} event (optional) the specific Event to process (default: all Events)
    sendRegistrationConfirmation: function(req, res) {

        var connAB = mysql.createConnection({
            host: sails.config.connections.appBuilder.host,
            user: sails.config.connections.appBuilder.user,
            password: sails.config.connections.appBuilder.password,
            database: sails.config.connections.appBuilder.database
        });



        var hashEvents = {};
        var hashPhotos = {};
        var hashHousingRoomFees = {};
        var hashHousingFees = {};   // Crib, Bed, etc... 


        var hashRegistrationPackets = {

            /*
            reg.id : {  
                event:{event},
                registration: {registration},
                registrants: { registrant.id:{registrant}, ... },

                email: '',
                preferredName:''
            }
            */
        }

        var resultErrorPackets = [];
        var resultErrorSending = [];


        sails.log(' ... preparing to send confirmation emails');
        async.series([

            // get events
            (next) => {

                connAB.query(`

                    SELECT * FROM AB_Events_Event

                    `, (err, results, fields) => {
                    if (err) next(err);
                    else {
                        results.forEach((r)=>{
                            hashEvents[r.id] = r;
                        })
                        next();
                    }
                });
            },

            // get housing room fees:
            (next) => {

                connAB.query(`

                    SELECT * FROM AB_Events_Fees
                    WHERE Post_Name IN ( "HTwin", "HDouble", "HStandard Room" )

                    `, (err, results, fields) => {
                    if (err) next(err);
                    else {
                        results.forEach((r)=>{
                            var translations = JSON.parse(r.translations);
                            hashHousingRoomFees[r.id] = translations[0].Fee;
                        })
                        next();
                    }
                });
            },

            // get housing fees:
            (next) => {

                connAB.query(`

                    SELECT * FROM AB_Events_Fees
                    WHERE Post_Name IN ( "HCrib", "HExtra Bed" )

                    `, (err, results, fields) => {
                    if (err) next(err);
                    else {
                        results.forEach((r)=>{
                            hashHousingFees[r.id] = r.Post_Name.replace(' ', '');
                        })
                        next();
                    }
                });
            },



            // get Registrations
            (next)=>{
                var sql = `

                    SELECT * FROM AB_Events_Registration
                    WHERE event IS Not Null AND SumConfirm = 0

                `;
// Testing Locally: 443, 444, 510, 519
// sql = `
// SELECT * FROM AB_Events_Registration
// WHERE event IS Not Null AND id IN ( 575 )
// `
                connAB.query(sql, (err, results, fields) => {
                    if (err) next(err);
                    else {
                        results.forEach((r)=>{
                            var event = hashEvents[r.Event];

                            // some people have null translations so here is a default set:
                            var translations = {
                                "Non-attend reason":"",
                                "Special Requests":""
                            }
                            if (r.translations) {
                                translations  = JSON.parse(r.translations)[0];
                            }
                            

                            hashRegistrationPackets[r.id] = {
                                error:false,
                                errorText:[],
                                event: event,
                                registration: r,
                                registrants:{},
                                HCrib:false,
                                HExtraBed:false,
                                nonAttend:translations['Non-attend reason'],
                                specialRequests:translations['Special Requests']
                            };
                        })
                        next();
                    }
                });

            },


            // get Registrants for each Registration:
            (next)=>{

                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function getRegistrants(list, cb) {
                    if (list.length == 0) {
                        cb();
                    } else {
                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];

                        connAB.query(`

                            SELECT * FROM AB_Events_registrants
                            WHERE Registration434 = ${registrationID}

                            `, (err, results, fields) => {
                            if (err) cb(err);
                            else {
                                var isOneAttending = false;
                                results.forEach((r)=>{
                                    packet.registrants[r.id]=r;
                                    if (r.Attending) {
                                        isOneAttending = true;
                                    }
                                })
                                packet.isOneAttending = isOneAttending;
                                getRegistrants(list, cb);
                            }
                        });


                    }
                }
                getRegistrants(allRegistrationIDs, (err)=>{
                    next(err);
                })
            },


            // // clear out registrations with No one attending
            // (next)=>{
            //     var allRegistrationIDs = Object.keys(hashRegistrationPackets);
            //     var removeCount = 0;

            //     function eachRegistration(list, cb) {
            //         if (list.length == 0) {
            //             cb();
            //         } else {
            //             var registrationID = list.shift();
            //             var packet = hashRegistrationPackets[registrationID];

                        
            //             if (!packet.isOneAttending) {
            //                 removeCount ++;
            //                 delete hashRegistrationPackets[registrationID];
            //             }

            //             eachRegistration(list, cb);
            //         }
            //     }
            //     eachRegistration(allRegistrationIDs, (err)=>{
            //         console.log('... removed '+removeCount+' registrations where no one was attending.');
            //         next(err);
            //     })
            // },


            // fill out Registrant Ren Data in registrant.rendata
            (next)=>{
                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function populateRen(list, hashRegistrants, cb) {
                    if (list.length == 0) {
                        cb();
                    } else {
                        var registrantID = list.shift();
                        var registrant = hashRegistrants[registrantID];

                        connAB.query(`

                            SELECT * FROM AB_Events_hrisrendata
                            WHERE ren_id = ${registrant['Ren Name']}

                            `, (err, results, fields) => {
                            if (err) cb(err);
                            else {
                                results.forEach((r)=>{
                                    registrant.rendata = r;
                                })
                                populateRen(list, hashRegistrants, cb);
                            }
                        });
                    }
                }
                function populateRegistrantRen(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {

                        var registrationID = list.shift();

                        var allRegistrantIDs = Object.keys(hashRegistrationPackets[registrationID].registrants);
                        populateRen(allRegistrantIDs, hashRegistrationPackets[registrationID].registrants, (err)=>{
                            if (err) {
                                cb(err);
                            } else {
                                populateRegistrantRen(list, cb);
                            }
                        })

                    }
                }
                populateRegistrantRen(allRegistrationIDs, (err)=>{
                    next(err);
                })
            },


            // find AccountHolder Details:
            (next) => {
                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function eachRegistration(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {

                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];
                        var registration = packet.registration;

                        packet.userUUID = '-';
                        
                        connAB.query(`

                            SELECT * FROM AB_Events_AccountHolder
                            WHERE id = ${registration['AccountOwner']}

                            `, (err, results, fields) => {
                            if (err) cb(err);
                            else {
                                results.forEach((r)=>{
                                    packet.userUUID = r.id;
                                    packet.email = r.email;
                                    packet.userName = r.User;
                                    var foundRen = Object.keys(packet.registrants).map((rKey)=>{ return packet.registrants[rKey]}).find((reg)=>{ return reg['Ren Name'] == r.Ren; })
                                    if (foundRen) {
                                        packet.preferredName = getFirstName(foundRen.rendata);
                                    } else {
                                        var firstID = Object.keys(packet.registrants)[0];
                                        if (firstID) {
                                            if (packet.registrants[firstID].rendata) {
                                                packet.preferredName = getFirstName(packet.registrants[firstID].rendata);
                                            } else {
                                                packet.preferredName = 'Citizen';
                                                packet.error = true;
                                                packet.errorText.push("No rendata for registrant:"+firstID );
                                            }
                                            
                                        } else {
                                            packet.preferredName = 'Citizen';
                                            packet.error = true;
                                            packet.errorText.push("No Registrants for this Registration");
                                        }
                                        
                                    }
                                    
                                })
                                eachRegistration(list, cb);
                            }
                        });

                    }
                }
                eachRegistration(allRegistrationIDs, (err)=>{
                    next(err);
                })

            },


            // find UserAccount Info:
            (next) => {
                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function eachRegistration(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {

                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];
                        var registration = packet.registration;

                        SiteUser.find({ username: packet.userName })
                        .then((userList)=>{
                            if (userList && userList.length > 0) {
                                packet.languageCode = userList[0].languageCode;
                                packet.email = userList[0].email;
                                packet.siteUser = userList[0];
                            } else {
                                packet.languageCode = 'en';
                                packet.error = true;
                                packet.errorText.push('No user account for userName:'+packet.userName);
                            }
                            eachRegistration(list, cb);
                        })
                        .catch(cb);

                    }
                }
                eachRegistration(allRegistrationIDs, (err)=>{
                    next(err);
                })

            },



            // convert conference name to languageCode:
            (next) => {
                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function eachRegistration(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {

                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];
                        var registration = packet.registration;

                        var json = []
                        try {
                            json = JSON.parse(packet.event.translations)
                        }catch(e) {

                        }

                        var langTrans = json.find((t)=>{ return t.language_code == packet.languageCode; });
                        if (langTrans) {
                            packet.conferenceName = langTrans.Title;
                        } else {
                            if (packet.event) {
                                packet.conferenceName = packet.event.name;
                            } else {
                                packet.error = true;
                                packet.errorText.push('No event for this registration:'+packet.registration.id);
                            }
                            
                        }

                        eachRegistration(list, cb);
                    }
                }
                eachRegistration(allRegistrationIDs, (err)=>{
                    next(err);
                })

            },

            // get all photos in a hash:
            (next)=>{

                connAB.query(`

                    SELECT * FROM AB_Events_regsPhotos

                    `, (err, results, fields) => {
                    if (err) next(err);
                    else {
                        results.forEach((r)=>{
                            hashPhotos[r.Ren] = r.Photo;
                        })
                        next();
                    }
                });

            },

            // compile Attendees  data:
            // attendees:[ { firstname:'name', lastname:'name', photo:true/false }]
            (next) => {
                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function eachRegistration(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {

                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];
                        var registration = packet.registration;

                        var attendees = [];
                        if (!packet.error) {
                            Object.keys(packet.registrants).map((r)=>{ return packet.registrants[r]; }).forEach((person)=>{
                                if (person.Attending == 1) {

                                    if (person.rendata) {

                                        attendees.push({
                                            firstname: person.rendata.ren_givenname,
                                            lastname: person.rendata.ren_surname,
                                            photo: (hashPhotos[person.rendata.ren_id] && hashPhotos[person.rendata.ren_id] != '')
                                        })
                                    } else {

                                        packet.error = true;
                                        packet.errorText.push('registrant.'+person.id+' did not have a ren entry. !!! ');
                                        attendees.push({
                                            firstname: 'registrant.'+person.id+' did not have a ren entry. !!! ',
                                            lastname: '',
                                            photo: false
                                        })

                                    }
                                    
                                    
                                }
                            })
                        }
                        packet.attendees = attendees;
                        eachRegistration(list, cb);
                    }
                }
                eachRegistration(allRegistrationIDs, (err)=>{
                    next(err);
                })

            },



            // compile Housing  data:
            // housing:[ { type:'Description', dates:'from - to' }]
            // 
            (next) => {
                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function eachRegistration(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {

                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];
                        var registration = packet.registration;

                        
                        connAB.query(`

                            SELECT * FROM AB_Events_Charges
                            WHERE Reg = ${registrationID}

                            `, (err, results, fields) => {
                            if (err) cb(err);
                            else {
                                var housing = [];
                                results.forEach((r)=>{

                                    // if a housingRoomFee add it to the housing entries
                                    if (hashHousingRoomFees[r.Fees177]) {
                                        var from = moment(r.Start).format("ddd MMM D");
                                        var to = moment(r.End).format("ddd MMM D");;

                                        var entry = {
                                            type: hashHousingRoomFees[r.Fees177],
                                            dates: `${from} - ${to}`
                                        }
                                        
                                        housing.push(entry);
                                    }

                                    // if one of the other housing fees, mark the Fee
                                    if (hashHousingFees[r.Fees177]) {
                                        packet[hashHousingFees[r.Fees177]] = true;
                                    }
                                    
                                })
                                packet.housing = housing;
                                eachRegistration(list, cb);
                            }
                        });
                    }
                }
                eachRegistration(allRegistrationIDs, (err)=>{
                    next(err);
                })

            },


            // 
            // Compile Schedules
            // 
            (next)=>{
                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function eachRegistrant(list, packet, cb) {
                    if (list.length==0) {
                        cb();
                    } else {
                        var registrantID = list.shift();
                        var registrant = packet.registrants[registrantID];

                        var childRenType = 4;
                        var ren = registrant.rendata;

                        // skip entries without a rendata 
                        if (!ren) {
                            eachRegistrant(list, packet, cb);
                            return;
                        }

                        // skip children
                        if (ren.rentype_id == childRenType) {
                            eachRegistrant(list, packet, cb);
                            return;
                        }

                        var schedule = {
                            name:getFirstName(ren),
                            first:'?',
                            second:'?',
                            third:'?'
                        }

                        var hashPriority = {
                            '1535347981478' : 'first',
                            '1535347981516' : 'second',
                            '1535347981589' : 'third'
                        }

                        connAB.query(`

                            SELECT Rank, translations
                            FROM AB_Events_Schedule as s
                            INNER JOIN AB_Events_SubEvent as se ON s.\`Sub Event\` = se.id
                            WHERE s.Attendee = ${registrantID}

                            `, (err, results, fields) => {
                            if (err) cb(err);
                            else {

                                results.forEach((r)=>{

                                    var json = JSON.parse(r.translations);
                                    schedule[hashPriority[r.Rank]] = json[0]['Title']
                                    
                                })
                                
                                packet.schedules.push(schedule);

                                eachRegistrant(list, packet, cb);
                            }
                        });

                    }
                }

                function eachRegistration(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {
                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];
                        packet.schedules = [];

                        if (packet.event.hasCourses) {

                            var allRegistrantIDs = Object.keys(packet.registrants);
                            eachRegistrant(allRegistrantIDs, packet, (err)=>{
                                if (err) { cb(err); return; }
                                eachRegistration(list, cb);
                            })
      
                        } else {
                            eachRegistration(list, cb);
                        }
                    }
                }
                eachRegistration(allRegistrationIDs, (err)=>{
                    next(err);
                })
            },


            //
            // Compile Childcare services + Translations + Travel
            //
            (next) => {
                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

                function eachRegistration(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {

                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];
                        

                        
                        var allRegistrants = Object.keys(packet.registrants).map((k)=>{ return packet.registrants[k]; });
                        var childRenType = 4;
                        var lang = packet.languageCode || 'en';
                        if (lang == 'ko') lang = 'en';


                        // childcare:
                        var hashChildCare = {
                            "1527238278649" : {
                                    'en' : 'None',
                                    'zh-hans': ''
                                },
                            "1527238278344" : {
                                    'en' : 'Chinese',
                                    'zh-hans': ''
                                },
                            "1527238278417" : {
                                    'en' : 'English',
                                    'zh-hans': ''
                                },
                            "1527238278503" : {
                                    'en' : 'Korean',
                                    'zh-hans': ''
                                },
                        }
                        var childCare = [];
                        allRegistrants.forEach((registrant)=>{
                            if (registrant.Attending) {

                                var ren = registrant.rendata;
                                if (ren && ren.rentype_id == childRenType) {

                                    childCare.push({
                                        name: getFirstName(ren),
                                        option: hashChildCare[registrant.Childcare][lang]
                                    })

                                }
                            }
                        })
                        packet.childCare = childCare;

                        
                        var hashTranslation = {
                            "1533895123776" : {
                                    'en' : 'None',
                                    'zh-hans': ''
                                },
                            "1533895123922" : {
                                    'en' : 'Chinese',
                                    'zh-hans': ''
                                },
                            "1533895123849" : {
                                    'en' : 'English',
                                    'zh-hans': ''
                                },
                            "1533895123960" : {
                                    'en' : 'Korean',
                                    'zh-hans': ''
                                },
                        }
                        var translations = [];
                        allRegistrants.forEach((registrant)=>{

                            if (registrant.Attending) {

                                var ren = registrant.rendata;
                                if (ren && ren.rentype_id != childRenType) {

                                    translations.push({
                                        name: getFirstName(ren),
                                        option: hashTranslation[registrant.translation][lang]
                                    })

                                }
                            }
                        })
                        packet.translations = translations;



                        var travelArrival = [];
                        var travelDeparture = [];
                        allRegistrants.forEach((registrant)=>{

                            if (registrant.Attending) {

                                var ren = registrant.rendata;

                                if (ren) {
                                    travelArrival.push({
                                        name: getFullName(ren),
                                        info: registrant['Arrival Ticket']
                                    })

                                    travelDeparture.push({
                                        name: getFullName(ren),
                                        info: registrant['Departure Ticket']
                                    })
                                }
                                
                            }
                        })
                        packet.travelArrival = travelArrival;
                        packet.travelDeparture = travelDeparture;


                        eachRegistration(list, cb);
                    }

                    var translations = [];

                }
                eachRegistration(allRegistrationIDs, (err)=>{
                    next(err);
                })

            },


            // 
            // Send the emails!
            //
            (next) =>{


                var allRegistrationIDs = Object.keys(hashRegistrationPackets);

// testing:
// var justThese = [ 554, 555 ];
// mccgowans 554, 555
// rpoolman  442, 443, 470
// allRegistrationIDs = [ 442, 443, 470 ];


                function eachRegistration(list,  cb) {
                    if (list.length==0) {
                        cb();
                    } else {

                        var registrationID = list.shift();
                        var packet = hashRegistrationPackets[registrationID];

// testing: maybe i've already confirmed one of my testing ones.
// if (!packet) {
// console.log('!!! desired registration not processed ['+registrationID+']  perhaps you already confirmed it?');
// eachRegistration(list, cb);
// return;
// }
                        if (packet.error) {
                            resultErrorPackets.push(packet);
                            console.log();
                            console.log('-------------------');
                            console.log(packet.errorText.join('\n'));
                            console.log();
                            console.log(packet);
                            console.log('-------------------');
                            console.log();
                            eachRegistration(list, cb);
                            return;
                        }


                        var triggerBase = 'event.registration.summary.';

                        var lang = packet.languageCode || 'en';
                        if (lang == 'ko') {
                            lang = 'en';
                        }

// lang = 'en';
                        var triggerID = triggerBase + lang;
                        var emailTo = [ packet.email ];
                        
// still testing:
// emailTo = [ 'jhausman@zteam.biz', 'jduncandesign@gmail.com', 'rpoolman@zteam.biz' ];
// emailTo = [ 'jhausman@zteam.biz' ];

                        EmailNotifications.trigger(triggerID, {
                            to: emailTo,
                            variables: packet,
                            attachments: [
                                {
                                    filename: 'header.png',
                                    content: Buffer.from(Base64Images.headerPNG, 'base64'),
                                    cid: 'header',
                                },
                                {
                                    filename: 'bg.jpg',
                                    content: Buffer.from(Base64Images.backgroundJPG, 'base64'),
                                    cid: 'bg',
                                }
                            ]
                        })
                        .done((html) => {
                            eachRegistration(list, cb);
                        })
                        .fail((err)=>{
                            resultErrorSending.push({ error:err, packet:packet })
                            eachRegistration(list, cb);
                        });

                    }
                }
                eachRegistration(allRegistrationIDs, (err)=>{
                    next(err);
                })
            },


            // Save Error Packets
            (next) => {
                var logContents = "";
                console.log('... there were '+resultErrorPackets.length+' registrations with errors compiling their data.');
                resultErrorPackets.forEach((packet)=>{

                    var stringifiedPacket = JSON.stringify(packet, null, 4);

                    logContents += `

---------------------------------------------------
${stringifiedPacket}
---------------------------------------------------

`

                });


                console.log('... there were '+resultErrorSending.length+' registrations with errors sending their emails.');
                resultErrorSending.forEach((error)=>{

                    var stringError = error.error.toString();
                    var stringifiedPacket = JSON.stringify(error.packet, null, 4);

                    logContents += `

---------------------------------------------------
${stringError}

${stringifiedPacket}
---------------------------------------------------

`

                });



                fs.writeFile('events_log_confirmationEmailErrors.log', logContents, (err)=>{
                    if (err) {
                        ADCore.error.log('::: ABMobileQRController.sendRegistrationConfirmation(): error writing log file: ', { error: err } )
                    }
                    next();
                })

            }


        ], (err, data)=>{


            connAB.end();

            if (err) {
                res.AD.error(err, err.httpResponseCode || 400);
            } else {
                res.AD.success({sent:true});    
            }
        })

    },





    // get: /event/confirm/:regID/:isConfirmed
    // receive the incoming response to the email confirmation we sent out.
    receiveRegistrationConfirmationResponse: function(req, res) {
        var regID = req.param('regID') || '--';
        var isConfirmed = req.param('isConfirmed') || '--';
        
        console.log('::: Event Registration Confirmed: '+regID+' '+isConfirmed);

        var connAB = mysql.createConnection({
            host: sails.config.connections.appBuilder.host,
            user: sails.config.connections.appBuilder.user,
            password: sails.config.connections.appBuilder.password,
            database: sails.config.connections.appBuilder.database
        });


        connAB.query(`

            UPDATE AB_Events_Registration
            SET SumConfirm=1, isAccurate=${isConfirmed}
            WHERE uuid = "${regID}"

            `, (err, results, fields) => {
            if (err) {
console.error(err);
res.error(err);
            }
            else {

                var responsePath = 'app_builder/registration_confirmed';
                if (isConfirmed == "0") {
                    responsePath = 'app_builder/needs_adjustments'
                }

                res.view(responsePath, {});

                connAB.end();
                
            }
        });

    }

};



function getFirstName(ren) {
    return ren.ren_preferredname || ren.ren_givenname
}

function getFullName(ren) {
    var first = getFirstName(ren);
    var last  = ren.ren_surname;
    return `${first} ${last}`;
}